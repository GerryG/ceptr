\hypertarget{receptor_8h}{\section{src/receptor.h File Reference}
\label{receptor_8h}\index{src/receptor.\+h@{src/receptor.\+h}}
}


Receptors provide the fundamental coherence contexts for ceptr.  


{\ttfamily \#include \char`\"{}tree.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}label.\+h\char`\"{}}\\*
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structReceptor}{Receptor}
\item 
struct \hyperlink{structInstance}{Instance}
\item 
struct \hyperlink{structXaddr}{Xaddr}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\hypertarget{receptor_8h_aa7a993bb2e321fff32e1bc0741dddde0}{\#define {\bfseries spec\+\_\+is\+\_\+symbol\+\_\+equal}(r, got, expected)~spec\+\_\+total++; if (expected==got)\{putchar('.');\} else \{putchar('F');sprintf(failures\mbox{[}spec\+\_\+failures++\mbox{]},\char`\"{}\%s\+:\%d expected \%s to be \%s but was \%s\char`\"{},\+\_\+\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+\_\+,\+\_\+\+\_\+\+L\+I\+N\+E\+\_\+\+\_\+,\#got,\+\_\+s\+\_\+get\+\_\+symbol\+\_\+name(r,expected),\+\_\+s\+\_\+get\+\_\+symbol\+\_\+name(r,got));\}}\label{receptor_8h_aa7a993bb2e321fff32e1bc0741dddde0}

\item 
\hypertarget{receptor_8h_aa5f33711ac4da299b54ccfa583d9378c}{\#define {\bfseries spec\+\_\+is\+\_\+structure\+\_\+equal}(r, got, expected)~spec\+\_\+total++; if (expected==got)\{putchar('.');\} else \{putchar('F');sprintf(failures\mbox{[}spec\+\_\+failures++\mbox{]},\char`\"{}\%s\+:\%d expected \%s to be \%s but was \%s\char`\"{},\+\_\+\+\_\+\+F\+U\+N\+C\+T\+I\+O\+N\+\_\+\+\_\+,\+\_\+\+\_\+\+L\+I\+N\+E\+\_\+\+\_\+,\#got,\+\_\+s\+\_\+get\+\_\+symbol\+\_\+name(r,expected),\+\_\+s\+\_\+get\+\_\+structure\+\_\+name(r,got));\}}\label{receptor_8h_aa5f33711ac4da299b54ccfa583d9378c}

\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\hypertarget{receptor_8h_a9c3dbc0500f38f3df66af1010f368911}{typedef struct \hyperlink{structReceptor}{Receptor} {\bfseries Receptor}}\label{receptor_8h_a9c3dbc0500f38f3df66af1010f368911}

\item 
\hypertarget{receptor_8h_a8675b50a924c478ce5f25009d0d24e2e}{typedef int {\bfseries Aspect}}\label{receptor_8h_a8675b50a924c478ce5f25009d0d24e2e}

\item 
\hypertarget{receptor_8h_aeadfce98b8e2394257cf05f6eb6ef949}{typedef struct \hyperlink{structInstance}{Instance} {\bfseries Instance}}\label{receptor_8h_aeadfce98b8e2394257cf05f6eb6ef949}

\item 
\hypertarget{receptor_8h_a2dcfd79034d088d9f69f647dbebd526c}{typedef struct \hyperlink{structXaddr}{Xaddr} {\bfseries Xaddr}}\label{receptor_8h_a2dcfd79034d088d9f69f647dbebd526c}

\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
\hypertarget{receptor_8h_a06fc87d81c62e9abb8790b6e5713c55b}{enum \{ {\bfseries D\+E\+F\+A\+U\+L\+T\+\_\+\+A\+S\+P\+E\+C\+T} =1
 \}}\label{receptor_8h_a06fc87d81c62e9abb8790b6e5713c55b}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structReceptor}{Receptor} $\ast$ \hyperlink{receptor_8h_aad12918fb4144e557b2ee5e169648c7b}{\+\_\+r\+\_\+new} ()
\item 
void \hyperlink{receptor_8h_ace908c1f9cf6df32014310dca991785b}{\+\_\+r\+\_\+add\+\_\+listener} (\hyperlink{structReceptor}{Receptor} $\ast$r, Aspect aspect, Symbol carrier, \hyperlink{structTnode}{Tnode} $\ast$semtrex, \hyperlink{structTnode}{Tnode} $\ast$action)
\item 
void \hyperlink{receptor_8h_a6f650808029d4c598ebe6515d9900ef8}{\+\_\+r\+\_\+free} (\hyperlink{structReceptor}{Receptor} $\ast$r)
\item 
\hypertarget{receptor_8h_ade6112556e16fb8a0512268f19f77233}{Symbol {\bfseries \+\_\+r\+\_\+def\+\_\+symbol} (\hyperlink{structReceptor}{Receptor} $\ast$r, Structure s, char $\ast$label)}\label{receptor_8h_ade6112556e16fb8a0512268f19f77233}

\item 
\hypertarget{receptor_8h_acce906c9de30765f458599777b72be90}{Symbol {\bfseries \+\_\+r\+\_\+get\+\_\+symbol\+\_\+by\+\_\+label} (\hyperlink{structReceptor}{Receptor} $\ast$r, char $\ast$label)}\label{receptor_8h_acce906c9de30765f458599777b72be90}

\item 
\hypertarget{receptor_8h_a0621fed839c7b2589ae87aedae9a6a7c}{Structure {\bfseries \+\_\+r\+\_\+def\+\_\+structure} (\hyperlink{structReceptor}{Receptor} $\ast$r, char $\ast$label, int num\+\_\+params,...)}\label{receptor_8h_a0621fed839c7b2589ae87aedae9a6a7c}

\item 
\hypertarget{receptor_8h_aba7efd4ebd9a5e6b737355fbc45d9a50}{Structure {\bfseries \+\_\+r\+\_\+get\+\_\+structure\+\_\+by\+\_\+label} (\hyperlink{structReceptor}{Receptor} $\ast$r, char $\ast$label)}\label{receptor_8h_aba7efd4ebd9a5e6b737355fbc45d9a50}

\item 
\hypertarget{receptor_8h_a120e66982d483fbe004fd969cf1c353f}{Structure {\bfseries \+\_\+\+\_\+r\+\_\+get\+\_\+symbol\+\_\+structure} (\hyperlink{structReceptor}{Receptor} $\ast$r, Symbol s)}\label{receptor_8h_a120e66982d483fbe004fd969cf1c353f}

\item 
\hypertarget{receptor_8h_ad886d976f8621ebb22d02c61f454265c}{size\+\_\+t {\bfseries \+\_\+\+\_\+r\+\_\+get\+\_\+symbol\+\_\+size} (\hyperlink{structReceptor}{Receptor} $\ast$r, Symbol s, void $\ast$surface)}\label{receptor_8h_ad886d976f8621ebb22d02c61f454265c}

\item 
\hyperlink{structXaddr}{Xaddr} \hyperlink{receptor_8h_a7518a44dda01af81556bb6657f18ead4}{\+\_\+r\+\_\+new\+\_\+instance} (\hyperlink{structReceptor}{Receptor} $\ast$r, Symbol s, void $\ast$surface)
\item 
\hypertarget{receptor_8h_ae5861d52f36fafa1f5d5a4ba1268ce1b}{\hyperlink{structInstance}{Instance} {\bfseries \+\_\+r\+\_\+get\+\_\+instance} (\hyperlink{structReceptor}{Receptor} $\ast$r, \hyperlink{structXaddr}{Xaddr} x)}\label{receptor_8h_ae5861d52f36fafa1f5d5a4ba1268ce1b}

\item 
size\+\_\+t \hyperlink{receptor_8h_aaea031f81a78e2c4f6d33821af1d7c21}{\+\_\+\+\_\+t\+\_\+serialize} (\hyperlink{structReceptor}{Receptor} $\ast$r, \hyperlink{structTnode}{Tnode} $\ast$t, void $\ast$$\ast$buffer\+P, size\+\_\+t offset, size\+\_\+t current\+\_\+size)
\item 
void \hyperlink{receptor_8h_a3e737841784555574a0d90ad2eff4cc4}{\+\_\+r\+\_\+serialize} (\hyperlink{structReceptor}{Receptor} $\ast$r, void $\ast$$\ast$surface\+P, size\+\_\+t $\ast$length\+P)
\item 
\hypertarget{receptor_8h_ac9db495a601c4775b2f1c53a6d8b3faf}{\hyperlink{structReceptor}{Receptor} $\ast$ {\bfseries \+\_\+r\+\_\+unserialize} (void $\ast$surface, size\+\_\+t length)}\label{receptor_8h_ac9db495a601c4775b2f1c53a6d8b3faf}

\item 
\hyperlink{structTnode}{Tnode} $\ast$ \hyperlink{receptor_8h_ae251d0cfa84e1edbbe12d3489aa29d1e}{\+\_\+r\+\_\+send} (\hyperlink{structReceptor}{Receptor} $\ast$r, \hyperlink{structReceptor}{Receptor} $\ast$from, Aspect aspect, \hyperlink{structTnode}{Tnode} $\ast$signal)
\item 
\hypertarget{receptor_8h_a21d4509b97577b9e8e71e4e03873bd02}{\hyperlink{structTnode}{Tnode} $\ast$ {\bfseries \+\_\+\+\_\+r\+\_\+get\+\_\+aspect} (\hyperlink{structReceptor}{Receptor} $\ast$r, Aspect aspect)}\label{receptor_8h_a21d4509b97577b9e8e71e4e03873bd02}

\item 
\hypertarget{receptor_8h_ab66e760e7143a7b04a49dfe71e104518}{\hyperlink{structTnode}{Tnode} $\ast$ {\bfseries \+\_\+\+\_\+r\+\_\+get\+\_\+listeners} (\hyperlink{structReceptor}{Receptor} $\ast$r, Aspect aspect)}\label{receptor_8h_ab66e760e7143a7b04a49dfe71e104518}

\item 
\hypertarget{receptor_8h_acc7dcde2338776c7af71c885671e3087}{\hyperlink{structTnode}{Tnode} $\ast$ {\bfseries \+\_\+\+\_\+r\+\_\+get\+\_\+signals} (\hyperlink{structReceptor}{Receptor} $\ast$r, Aspect aspect)}\label{receptor_8h_acc7dcde2338776c7af71c885671e3087}

\item 
\hypertarget{receptor_8h_a5cafc7054a5a1fc7af911904d01d45a5}{char $\ast$ {\bfseries \+\_\+td} (\hyperlink{structReceptor}{Receptor} $\ast$r, \hyperlink{structTnode}{Tnode} $\ast$t)}\label{receptor_8h_a5cafc7054a5a1fc7af911904d01d45a5}

\item 
\hypertarget{receptor_8h_a0dd4502c465541939aa3aea2d8daea56}{char $\ast$ {\bfseries \+\_\+s\+\_\+get\+\_\+symbol\+\_\+name} (\hyperlink{structReceptor}{Receptor} $\ast$r, Symbol s)}\label{receptor_8h_a0dd4502c465541939aa3aea2d8daea56}

\item 
\hypertarget{receptor_8h_aecf1cc813af035586953c73a06d5285c}{char $\ast$ {\bfseries \+\_\+s\+\_\+get\+\_\+structure\+\_\+name} (\hyperlink{structReceptor}{Receptor} $\ast$r, Structure s)}\label{receptor_8h_aecf1cc813af035586953c73a06d5285c}

\item 
\hypertarget{receptor_8h_aad1696e79c7630020a718c2a3f3d5a37}{char $\ast$ {\bfseries \+\_\+dump\+\_\+semtrex} (\hyperlink{structTnode}{Tnode} $\ast$s, char $\ast$buf)}\label{receptor_8h_aad1696e79c7630020a718c2a3f3d5a37}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
Receptors provide the fundamental coherence contexts for ceptr. 



\subsection{Function Documentation}
\hypertarget{receptor_8h_aaea031f81a78e2c4f6d33821af1d7c21}{\index{receptor.\+h@{receptor.\+h}!\+\_\+\+\_\+t\+\_\+serialize@{\+\_\+\+\_\+t\+\_\+serialize}}
\index{\+\_\+\+\_\+t\+\_\+serialize@{\+\_\+\+\_\+t\+\_\+serialize}!receptor.\+h@{receptor.\+h}}
\subsubsection[{\+\_\+\+\_\+t\+\_\+serialize}]{\setlength{\rightskip}{0pt plus 5cm}size\+\_\+t \+\_\+\+\_\+t\+\_\+serialize (
\begin{DoxyParamCaption}
\item[{{\bf Receptor} $\ast$}]{r, }
\item[{{\bf Tnode} $\ast$}]{t, }
\item[{void $\ast$$\ast$}]{buffer\+P, }
\item[{size\+\_\+t}]{offset, }
\item[{size\+\_\+t}]{current\+\_\+size}
\end{DoxyParamCaption}
)}}\label{receptor_8h_aaea031f81a78e2c4f6d33821af1d7c21}
Serialize a tree by recursive descent.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em t} & tree to be serialized \\
\hline
\mbox{\tt in}  & {\em r} & receptor to provide a context for resolving symbols and structures \\
\hline
\mbox{\tt in}  & {\em buffer\+P} & a pointer to a malloced ptr of \char`\"{}current\+\_\+size\char`\"{} which will be realloced if serialized tree is bigger than initial buffer allocation. \\
\hline
\mbox{\tt in}  & {\em offset} & current offset into buffer at which to put serialized data \\
\hline
\mbox{\tt in}  & {\em current\+\_\+size} & size of buffer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the length that was added to the buffer 
\end{DoxyReturn}
\hypertarget{receptor_8h_ace908c1f9cf6df32014310dca991785b}{\index{receptor.\+h@{receptor.\+h}!\+\_\+r\+\_\+add\+\_\+listener@{\+\_\+r\+\_\+add\+\_\+listener}}
\index{\+\_\+r\+\_\+add\+\_\+listener@{\+\_\+r\+\_\+add\+\_\+listener}!receptor.\+h@{receptor.\+h}}
\subsubsection[{\+\_\+r\+\_\+add\+\_\+listener}]{\setlength{\rightskip}{0pt plus 5cm}void \+\_\+r\+\_\+add\+\_\+listener (
\begin{DoxyParamCaption}
\item[{{\bf Receptor} $\ast$}]{r, }
\item[{Aspect}]{aspect, }
\item[{Symbol}]{carrier, }
\item[{{\bf Tnode} $\ast$}]{expectation, }
\item[{{\bf Tnode} $\ast$}]{action}
\end{DoxyParamCaption}
)}}\label{receptor_8h_ace908c1f9cf6df32014310dca991785b}
Adds an expectation/action pair to a receptor's aspect. \hypertarget{receptor_8h_a6f650808029d4c598ebe6515d9900ef8}{\index{receptor.\+h@{receptor.\+h}!\+\_\+r\+\_\+free@{\+\_\+r\+\_\+free}}
\index{\+\_\+r\+\_\+free@{\+\_\+r\+\_\+free}!receptor.\+h@{receptor.\+h}}
\subsubsection[{\+\_\+r\+\_\+free}]{\setlength{\rightskip}{0pt plus 5cm}void \+\_\+r\+\_\+free (
\begin{DoxyParamCaption}
\item[{{\bf Receptor} $\ast$}]{r}
\end{DoxyParamCaption}
)}}\label{receptor_8h_a6f650808029d4c598ebe6515d9900ef8}
Destroys a receptor freeing all memory it uses. \hypertarget{receptor_8h_aad12918fb4144e557b2ee5e169648c7b}{\index{receptor.\+h@{receptor.\+h}!\+\_\+r\+\_\+new@{\+\_\+r\+\_\+new}}
\index{\+\_\+r\+\_\+new@{\+\_\+r\+\_\+new}!receptor.\+h@{receptor.\+h}}
\subsubsection[{\+\_\+r\+\_\+new}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Receptor}$\ast$ \+\_\+r\+\_\+new (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{receptor_8h_aad12918fb4144e557b2ee5e169648c7b}
Creates a new receptor allocating all memory needed. \hypertarget{receptor_8h_a7518a44dda01af81556bb6657f18ead4}{\index{receptor.\+h@{receptor.\+h}!\+\_\+r\+\_\+new\+\_\+instance@{\+\_\+r\+\_\+new\+\_\+instance}}
\index{\+\_\+r\+\_\+new\+\_\+instance@{\+\_\+r\+\_\+new\+\_\+instance}!receptor.\+h@{receptor.\+h}}
\subsubsection[{\+\_\+r\+\_\+new\+\_\+instance}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Xaddr} \+\_\+r\+\_\+new\+\_\+instance (
\begin{DoxyParamCaption}
\item[{{\bf Receptor} $\ast$}]{r, }
\item[{Symbol}]{s, }
\item[{void $\ast$}]{surface}
\end{DoxyParamCaption}
)}}\label{receptor_8h_a7518a44dda01af81556bb6657f18ead4}
Create a new instance of a symbol.

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000002}{Todo}]currently this implementation of instances, just stores each instance as tree node of type I\+N\+S\+T\+A\+N\+C\+E as a child of the symbol. This is way inefficient and needs to be replaced. But this is just here to create the A\+P\+I... \end{DoxyRefDesc}
\hypertarget{receptor_8h_ae251d0cfa84e1edbbe12d3489aa29d1e}{\index{receptor.\+h@{receptor.\+h}!\+\_\+r\+\_\+send@{\+\_\+r\+\_\+send}}
\index{\+\_\+r\+\_\+send@{\+\_\+r\+\_\+send}!receptor.\+h@{receptor.\+h}}
\subsubsection[{\+\_\+r\+\_\+send}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Tnode}$\ast$ \+\_\+r\+\_\+send (
\begin{DoxyParamCaption}
\item[{{\bf Receptor} $\ast$}]{r, }
\item[{{\bf Receptor} $\ast$}]{from, }
\item[{Aspect}]{aspect, }
\item[{{\bf Tnode} $\ast$}]{signal\+\_\+contents}
\end{DoxyParamCaption}
)}}\label{receptor_8h_ae251d0cfa84e1edbbe12d3489aa29d1e}
Send a signal to a receptor on a given aspect \hypertarget{receptor_8h_a3e737841784555574a0d90ad2eff4cc4}{\index{receptor.\+h@{receptor.\+h}!\+\_\+r\+\_\+serialize@{\+\_\+r\+\_\+serialize}}
\index{\+\_\+r\+\_\+serialize@{\+\_\+r\+\_\+serialize}!receptor.\+h@{receptor.\+h}}
\subsubsection[{\+\_\+r\+\_\+serialize}]{\setlength{\rightskip}{0pt plus 5cm}void \+\_\+r\+\_\+serialize (
\begin{DoxyParamCaption}
\item[{{\bf Receptor} $\ast$}]{r, }
\item[{void $\ast$$\ast$}]{surface\+P, }
\item[{size\+\_\+t $\ast$}]{length\+P}
\end{DoxyParamCaption}
)}}\label{receptor_8h_a3e737841784555574a0d90ad2eff4cc4}
Serialize a receptor

Allocates a buffer for and serializes a receptor into the buffer


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em r} & \hyperlink{structReceptor}{Receptor} to serialize \\
\hline
\mbox{\tt in,out}  & {\em surface\+P} & pointer to a void $\ast$ to hold the resulting serialized data \\
\hline
\mbox{\tt in,out}  & {\em length\+P} & pointer to a size\+\_\+t to hold the resulting serialized data length \\
\hline
\end{DoxyParams}
