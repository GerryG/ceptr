<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>ceptr: spec/receptor_spec.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ceptr
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('receptor__spec_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">receptor_spec.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="receptor__spec_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;../src/ceptr.h&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;../src/receptor.h&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;../src/def.h&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;../src/accumulator.h&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;../src/vmhost.h&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;../src/protocol.h&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="http__example_8h.html">http_example.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="spec__utils_8h.html">spec_utils.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="receptor__spec_8h.html#a3a764534a7cc2c00a1e15642d0554b7c">   17</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="receptor__spec_8h.html#a3a764534a7cc2c00a1e15642d0554b7c">testReceptorCreate</a>() {</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    r = <a class="code" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a>(G_sem,TEST_RECEPTOR);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    spec_is_symbol_equal(r,<a class="code" href="group__tree.html#ga946600fb570f0cc913450905f6189d49">_t_symbol</a>(r-&gt;<a class="code" href="structReceptor.html#aec6f1eee133a993b59baf50e75620fb6">root</a>),RECEPTOR_INSTANCE);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <a class="code" href="structT.html">T</a> *t;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="comment">// test that expectations and signals are set up correctly on the default aspect</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    t = __r_get_expectations(r,DEFAULT_ASPECT);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    spec_is_symbol_equal(r,<a class="code" href="group__tree.html#ga946600fb570f0cc913450905f6189d49">_t_symbol</a>(t),EXPECTATIONS);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    t = __r_get_signals(r,DEFAULT_ASPECT);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    spec_is_symbol_equal(r,<a class="code" href="group__tree.html#ga946600fb570f0cc913450905f6189d49">_t_symbol</a>(t),SIGNALS);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">// test that the flux is set up correctly</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordtype">int</span> p[] = {ReceptorInstanceStateIdx,ReceptorFluxIdx,TREE_PATH_TERMINATOR};</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    t = <a class="code" href="group__tree.html#gaf019d190c9623de809d006e309a441af">_t_get</a>(r-&gt;<a class="code" href="structReceptor.html#aec6f1eee133a993b59baf50e75620fb6">root</a>,p);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    spec_is_symbol_equal(r,<a class="code" href="group__tree.html#ga946600fb570f0cc913450905f6189d49">_t_symbol</a>(r-&gt;<a class="code" href="structReceptor.html#af8aee3ef6d1d93b80427faa57e6f1468">flux</a>),FLUX);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    spec_is_ptr_equal(t,r-&gt;<a class="code" href="structReceptor.html#af8aee3ef6d1d93b80427faa57e6f1468">flux</a>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    t = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(r-&gt;<a class="code" href="structReceptor.html#af8aee3ef6d1d93b80427faa57e6f1468">flux</a>,1);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    spec_is_symbol_equal(r,<a class="code" href="group__tree.html#ga946600fb570f0cc913450905f6189d49">_t_symbol</a>(t),DEFAULT_ASPECT);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    spec_is_str_equal(t2s(r-&gt;<a class="code" href="structReceptor.html#aec6f1eee133a993b59baf50e75620fb6">root</a>),<span class="stringliteral">&quot;(RECEPTOR_INSTANCE (INSTANCE_OF:TEST_RECEPTOR) (CONTEXT_NUM:3) (PARENT_CONTEXT_NUM:0) (RECEPTOR_STATE (FLUX (DEFAULT_ASPECT (EXPECTATIONS) (SIGNALS))) (PENDING_SIGNALS) (PENDING_RESPONSES) (CONVERSATIONS) (RECEPTOR_ELAPSED_TIME:0)))&quot;</span>);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;}</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keywordtype">void</span> testReceptorAddRemoveExpectation() {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    r = <a class="code" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a>(G_sem,TEST_RECEPTOR);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="structSemanticID.html">Symbol</a> dummy = {r-&gt;<a class="code" href="structReceptor.html#ae57114199054b577820844eaff7593dd">context</a>,SEM_TYPE_SYMBOL,1};</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// test that you can add a expectation to a receptor&#39;s aspect</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="structT.html">T</a> *s = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(PATTERN);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="group__semtrex.html#ga12e70dc3d5fde33655e8731ad3bdd935">_sl</a>(s,dummy);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="structT.html">T</a> *a = _t_news(0,ACTION,NULL_PROCESS);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="group__receptor.html#gab8d3726ccb2be829a2b8e7c9d84b0cb9">_r_add_expectation</a>(r,DEFAULT_ASPECT,TEST_INT_SYMBOL,s,a,0,0,NULL,NULL);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="structT.html">T</a> *es = __r_get_expectations(r,DEFAULT_ASPECT);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="structT.html">T</a> *e = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(es,1);      <span class="comment">// expectation should have been added as first child of expectations</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    spec_is_str_equal(_td(r,e),<span class="stringliteral">&quot;(EXPECTATION (CARRIER:TEST_INT_SYMBOL) (PATTERN (SEMTREX_SYMBOL_LITERAL (SEMTREX_SYMBOL:TEST_INT_SYMBOL))) (ACTION:NULL_PROCESS) (PARAMS) (END_CONDITIONS (UNLIMITED)))&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    _r_remove_expectation(r,e);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    spec_is_str_equal(_td(r,es),<span class="stringliteral">&quot;(EXPECTATIONS)&quot;</span>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;}</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keywordtype">void</span> testReceptorSignal() {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a>(G_sem,TEST_RECEPTOR);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="structT.html">T</a> *sc,*signal_contents = _t_newi(0,TEST_INT_SYMBOL,314);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="structReceptorAddress.html">ReceptorAddress</a> f = {3}; <span class="comment">// DUMMY ADDR</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="structReceptorAddress.html">ReceptorAddress</a> t = {4}; <span class="comment">// DUMMY ADDR</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="structT.html">T</a> *s = <a class="code" href="group__receptor.html#ga9bf86b246fd28187cf7d434dc2de9a81">__r_make_signal</a>(f,t,DEFAULT_ASPECT,TESTING,sc=<a class="code" href="group__tree.html#ga7535eb2963c6cf5fc78cb14287581f92">_t_clone</a>(signal_contents),0,0,0);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    spec_is_symbol_equal(r,<a class="code" href="group__tree.html#ga946600fb570f0cc913450905f6189d49">_t_symbol</a>(s),SIGNAL);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="structT.html">T</a> *envelope = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(s,SignalEnvelopeIdx);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    spec_is_str_equal(t2s(envelope),<span class="stringliteral">&quot;(ENVELOPE (SIGNAL_UUID))&quot;</span>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="structT.html">T</a> *message = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(s,SignalMessageIdx);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="structT.html">T</a> *head = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(message,MessageHeadIdx);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    spec_is_str_equal(t2s(head),<span class="stringliteral">&quot;(HEAD (FROM_ADDRESS (RECEPTOR_ADDR:3)) (TO_ADDRESS (RECEPTOR_ADDR:4)) (ASPECT_IDENT:DEFAULT_ASPECT) (CARRIER:TESTING))&quot;</span>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="structT.html">T</a> *body = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(message,MessageBodyIdx);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    spec_is_str_equal(t2s(body),<span class="stringliteral">&quot;(BODY:{(TEST_INT_SYMBOL:314)})&quot;</span>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="structT.html">T</a> *contents = (<a class="code" href="structT.html">T</a>*)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(body);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    spec_is_ptr_equal(sc,contents);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(s);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="structUUIDt.html">UUIDt</a> u = __uuid_gen();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    s = <a class="code" href="group__receptor.html#ga9bf86b246fd28187cf7d434dc2de9a81">__r_make_signal</a>(f,t,DEFAULT_ASPECT,TESTING,<a class="code" href="group__tree.html#ga7535eb2963c6cf5fc78cb14287581f92">_t_clone</a>(signal_contents),&amp;u,0,0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    spec_is_str_equal(t2s(s),<span class="stringliteral">&quot;(SIGNAL (ENVELOPE (SIGNAL_UUID)) (MESSAGE (HEAD (FROM_ADDRESS (RECEPTOR_ADDR:3)) (TO_ADDRESS (RECEPTOR_ADDR:4)) (ASPECT_IDENT:DEFAULT_ASPECT) (CARRIER:TESTING) (IN_RESPONSE_TO_UUID)) (BODY:{(TEST_INT_SYMBOL:314)})))&quot;</span>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">int</span> p[] = {SignalMessageIdx,MessageHeadIdx,HeadOptionalsIdx,TREE_PATH_TERMINATOR};</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="structT.html">T</a> *ru = <a class="code" href="group__tree.html#gaf019d190c9623de809d006e309a441af">_t_get</a>(s,p);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    spec_is_true(__uuid_equal(&amp;u,<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(ru)));</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(s);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="structT.html">T</a> *ec = defaultRequestUntil();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    s = <a class="code" href="group__receptor.html#ga9bf86b246fd28187cf7d434dc2de9a81">__r_make_signal</a>(f,t,DEFAULT_ASPECT,TESTING,signal_contents,0,ec,0);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    spec_is_ptr_equal(ec,<a class="code" href="group__tree.html#gaf019d190c9623de809d006e309a441af">_t_get</a>(s,p));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(s);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keywordtype">void</span> testReceptorSignalDeliver() {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a>(G_sem,TEST_RECEPTOR);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="structT.html">T</a> *signal_contents = _t_newi(0,TEST_INT_SYMBOL,314);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="structReceptorAddress.html">ReceptorAddress</a> f = {3}; <span class="comment">// DUMMY ADDR</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="structReceptorAddress.html">ReceptorAddress</a> t = {4}; <span class="comment">// DUMMY ADDR</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// a new signal should simply be placed on the flux when delivered</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="structT.html">T</a> *s = <a class="code" href="group__receptor.html#ga9bf86b246fd28187cf7d434dc2de9a81">__r_make_signal</a>(f,t,DEFAULT_ASPECT,TESTING,signal_contents,0,0,0);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    spec_is_equal(<a class="code" href="group__receptor.html#ga7d40f33135ee51640d0d24b8c9e3e046">_r_deliver</a>(r,s),noDeliveryErr);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="structT.html">T</a> *signals = __r_get_signals(r,DEFAULT_ASPECT);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    spec_is_str_equal(_td(r,signals),<span class="stringliteral">&quot;(SIGNALS (SIGNAL (ENVELOPE (SIGNAL_UUID)) (MESSAGE (HEAD (FROM_ADDRESS (RECEPTOR_ADDR:3)) (TO_ADDRESS (RECEPTOR_ADDR:4)) (ASPECT_IDENT:DEFAULT_ASPECT) (CARRIER:TESTING)) (BODY:{(TEST_INT_SYMBOL:314)}))))&quot;</span>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="keywordtype">void</span> testReceptorDeliverConversation() {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a>(G_sem,TEST_RECEPTOR);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="structT.html">T</a> *signal_contents = _t_newi(0,TEST_INT_SYMBOL,314);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="structReceptorAddress.html">ReceptorAddress</a> f = {3}; <span class="comment">// DUMMY ADDR</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="structReceptorAddress.html">ReceptorAddress</a> t = {4}; <span class="comment">// DUMMY ADDR</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// the first signal in a conversation should create a conversation record</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="structUUIDt.html">UUIDt</a> cuuid = __uuid_gen();</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="structT.html">T</a> *cu = __cid_new(0,&amp;cuuid,0);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="structT.html">T</a> *s = <a class="code" href="group__receptor.html#ga9bf86b246fd28187cf7d434dc2de9a81">__r_make_signal</a>(f,t,DEFAULT_ASPECT,TESTING,signal_contents,0,0,cu);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    spec_is_str_equal(_td(r,r-&gt;conversations),<span class="stringliteral">&quot;(CONVERSATIONS)&quot;</span>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    spec_is_equal(<a class="code" href="group__receptor.html#ga7d40f33135ee51640d0d24b8c9e3e046">_r_deliver</a>(r,s),noDeliveryErr);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// when the signal arrives a new conversation should be in place</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    spec_is_str_equal(_td(r,r-&gt;conversations),<span class="stringliteral">&quot;(CONVERSATIONS (CONVERSATION (CONVERSATION_IDENT (CONVERSATION_UUID)) (END_CONDITIONS (UNLIMITED)) (CONVERSATIONS)))&quot;</span>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(cu);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keywordtype">void</span> testReceptorConversations() {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a>(G_sem,TEST_RECEPTOR);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    spec_is_str_equal(_td(r,r-&gt;conversations),<span class="stringliteral">&quot;(CONVERSATIONS)&quot;</span>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="structUUIDt.html">UUIDt</a> u = __uuid_gen();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="structT.html">T</a> *c = _r_add_conversation(r,0,&amp;u,0,0);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    spec_is_str_equal(_td(r,c),<span class="stringliteral">&quot;(CONVERSATION (CONVERSATION_IDENT (CONVERSATION_UUID)) (END_CONDITIONS (UNLIMITED)) (CONVERSATIONS))&quot;</span>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    spec_is_str_equal(_td(r,r-&gt;conversations),<span class="stringliteral">&quot;(CONVERSATIONS (CONVERSATION (CONVERSATION_IDENT (CONVERSATION_UUID)) (END_CONDITIONS (UNLIMITED)) (CONVERSATIONS)))&quot;</span>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    spec_is_ptr_equal(_r_find_conversation(r,&amp;u),c);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">// add a child conversation</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="structUUIDt.html">UUIDt</a> u2 = __uuid_gen();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="structT.html">T</a> *c2 = _r_add_conversation(r,&amp;u,&amp;u2,0,0);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    spec_is_str_equal(_td(r,r-&gt;conversations),<span class="stringliteral">&quot;(CONVERSATIONS (CONVERSATION (CONVERSATION_IDENT (CONVERSATION_UUID)) (END_CONDITIONS (UNLIMITED)) (CONVERSATIONS (CONVERSATION (CONVERSATION_IDENT (CONVERSATION_UUID)) (END_CONDITIONS (UNLIMITED)) (CONVERSATIONS)))))&quot;</span>);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    spec_is_ptr_equal(_r_find_conversation(r,&amp;u2),c2);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// add a sibling conversation</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="structUUIDt.html">UUIDt</a> u3 = __uuid_gen();</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="structT.html">T</a> *c3 = _r_add_conversation(r,0,&amp;u3,0,0);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    spec_is_str_equal(_td(r,r-&gt;conversations),<span class="stringliteral">&quot;(CONVERSATIONS (CONVERSATION (CONVERSATION_IDENT (CONVERSATION_UUID)) (END_CONDITIONS (UNLIMITED)) (CONVERSATIONS (CONVERSATION (CONVERSATION_IDENT (CONVERSATION_UUID)) (END_CONDITIONS (UNLIMITED)) (CONVERSATIONS)))) (CONVERSATION (CONVERSATION_IDENT (CONVERSATION_UUID)) (END_CONDITIONS (UNLIMITED)) (CONVERSATIONS)))&quot;</span>);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    spec_is_ptr_equal(_r_find_conversation(r,&amp;u3),c3);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;}</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> G_next_process_id;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="keywordtype">void</span> testReceptorResponseDeliver() {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a>(G_sem,TEST_RECEPTOR);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    G_next_process_id = 0; <span class="comment">// reset the process ids so the test will always work</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="structReceptorAddress.html">ReceptorAddress</a> tt = {4}; <span class="comment">// DUMMY ADDR</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">// set up receptor to have sent a signal and blocked waiting for the response</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="structT.html">T</a> *t = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(RUN_TREE);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="structT.html">T</a> *p = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(NOOP);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="structT.html">T</a> *req = _t_newr(p,REQUEST);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    __r_make_addr(req,TO_ADDRESS,tt);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    _t_news(req,ASPECT_IDENT,DEFAULT_ASPECT);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    _t_news(req,CARRIER,TESTING);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    _t_newi(req,TEST_INT_SYMBOL,98789);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    _t_news(req,RESPONSE_CARRIER,TESTING);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="structT.html">T</a> *c = _t_rclone(p);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(p);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a>(t,c);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    _p_addrt2q(r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>,t);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="process_8c.html#a64e8965291c67057b06f273db19a465d">_p_reduceq</a>(r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">// the run tree should now be blocked with the sending signal uuid in the place</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// where the response value should be filled and the pending responses list should</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// have the UUID and the code path in it</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="structT.html">T</a> *rt = r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>-&gt;<a class="code" href="structQ.html#ab8eb183576f2b1753d80bfcfdd0cd22b">blocked</a>-&gt;context-&gt;<a class="code" href="structR.html#aab5d23021e9afe31b32544e515f18c1f">run_tree</a>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    spec_is_str_equal(_td(r,rt),<span class="stringliteral">&quot;(RUN_TREE (process:NOOP (SIGNAL_UUID)))&quot;</span>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="structT.html">T</a> *pr = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(r-&gt;pending_responses,1);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    spec_is_str_equal(_td(r,<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(pr,1)),<span class="stringliteral">&quot;(SIGNAL_UUID)&quot;</span>);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    spec_is_str_equal(_td(r,<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(pr,2)),<span class="stringliteral">&quot;(CARRIER:TESTING)&quot;</span>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    spec_is_str_equal(_td(r,<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(pr,3)),<span class="stringliteral">&quot;(WAKEUP_REFERENCE (PROCESS_IDENT:1) (CODE_PATH:/1/1))&quot;</span>);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="structT.html">T</a> *ec = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(pr,4);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    spec_is_sem_equal(<a class="code" href="group__tree.html#ga946600fb570f0cc913450905f6189d49">_t_symbol</a>(ec),END_CONDITIONS);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// create a response signals</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="structReceptorAddress.html">ReceptorAddress</a> from = {4}; <span class="comment">// DUMMY ADDR</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="structReceptorAddress.html">ReceptorAddress</a> to = {0}; <span class="comment">// DUMMY ADDR</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">// get the original signal uuid from the run tree</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="structUUIDt.html">UUIDt</a> response_id = *(<a class="code" href="structUUIDt.html">UUIDt</a> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(rt,1),1));</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="structT.html">T</a> *s = <a class="code" href="group__receptor.html#ga9bf86b246fd28187cf7d434dc2de9a81">__r_make_signal</a>(from,to,DEFAULT_ASPECT,TESTING,_t_new_str(0,TEST_STR_SYMBOL,<span class="stringliteral">&quot;foo&quot;</span>),&amp;response_id,0,0);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">//    debug_enable(D_SIGNALS);</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    spec_is_equal(<a class="code" href="group__receptor.html#ga7d40f33135ee51640d0d24b8c9e3e046">_r_deliver</a>(r,s),noDeliveryErr);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">//    debug_disable(D_SIGNALS);</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">// block list should now be empty</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    spec_is_ptr_equal(r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>-&gt;<a class="code" href="structQ.html#ab8eb183576f2b1753d80bfcfdd0cd22b">blocked</a>,NULL);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">// and the run tree should now be active and have the response contents value</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">// in place for reduction.</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    rt = r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>-&gt;<a class="code" href="structQ.html#a986c007532c25e847896a206182ed6e9">active</a>-&gt;context-&gt;<a class="code" href="structR.html#aab5d23021e9afe31b32544e515f18c1f">run_tree</a>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    spec_is_str_equal(_td(r,rt),<span class="stringliteral">&quot;(RUN_TREE (process:NOOP (TEST_STR_SYMBOL:foo)))&quot;</span>);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// and the pending_responses list should be cleared too because we only asked for one response.</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    spec_is_str_equal(_td(r,r-&gt;pending_responses),<span class="stringliteral">&quot;(PENDING_RESPONSES)&quot;</span>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;}</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="keywordtype">void</span> testReceptorEndCondition() {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="structT.html">T</a> *until = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(END_CONDITIONS);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    _t_newr(until,UNLIMITED);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">bool</span> cleanup,allow;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    evaluateEndCondition(until,&amp;cleanup,&amp;allow);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    spec_is_false(cleanup);spec_is_true(allow);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(until);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    until = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(END_CONDITIONS);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    _t_newi(until,COUNT,2);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    evaluateEndCondition(until,&amp;cleanup,&amp;allow);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    spec_is_false(cleanup);spec_is_true(allow);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    spec_is_str_equal(t2s(until),<span class="stringliteral">&quot;(END_CONDITIONS (COUNT:1))&quot;</span>);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    evaluateEndCondition(until,&amp;cleanup,&amp;allow);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    spec_is_true(cleanup);spec_is_true(allow);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    spec_is_str_equal(t2s(until),<span class="stringliteral">&quot;(END_CONDITIONS (COUNT:0))&quot;</span>);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(until);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">//    debug_enable(D_SIGNALS);</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    until = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(END_CONDITIONS);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="structT.html">T</a> *ts = __r_make_timestamp(TIMEOUT_AT,-2);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a>(until,ts);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    evaluateEndCondition(until,&amp;cleanup,&amp;allow);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    spec_is_true(cleanup);spec_is_false(allow);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(until);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    until = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(END_CONDITIONS);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    ts = __r_make_timestamp(TIMEOUT_AT,+2);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a>(until,ts);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    evaluateEndCondition(until,&amp;cleanup,&amp;allow);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    spec_is_false(cleanup);spec_is_true(allow);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(until);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    debug_disable(D_SIGNALS);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;}</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="receptor__spec_8h.html#a1cff5f815970b5209885f117bc705fd0">  268</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="receptor__spec_8h.html#a1cff5f815970b5209885f117bc705fd0">testReceptorExpectation</a>() {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a>(G_sem,TEST_RECEPTOR);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// The signal is an HTTP request</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="structT.html">T</a> *signal_contents = <a class="code" href="http__example_8h.html#a1c182b5a6e82ef49c6967183a15c3e8b">_makeTestHTTPRequestTree</a>(); <span class="comment">// GET /groups/5/users.json?sort_by=last_name?page=2 HTTP/1.0</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="structReceptorAddress.html">ReceptorAddress</a> f = {3}; <span class="comment">// DUMMY ADDR</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="structReceptorAddress.html">ReceptorAddress</a> t = {4}; <span class="comment">// DUMMY ADDR</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="structT.html">T</a> *signal = <a class="code" href="group__receptor.html#ga9bf86b246fd28187cf7d434dc2de9a81">__r_make_signal</a>(f,t,DEFAULT_ASPECT,HTTP_REQUEST,signal_contents,0,0,0);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">// our expectation pattern should match on the first path segment</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">// /HTTP_REQUEST/.,.,HTTP_REQUEST_PATH/HTTP_REQUEST_PATH_SEGMENTS/&lt;HTTP_REQUEST_PATH_SEGMENT:HTTP_REQUEST_PATH_SEGMENT&gt;</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="structT.html">T</a> *pattern = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(PATTERN);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">char</span> *stx = <span class="stringliteral">&quot;/HTTP_REQUEST_LINE/(.,.,HTTP_REQUEST_PATH/HTTP_REQUEST_PATH_SEGMENTS/&lt;HTTP_REQUEST_PATH_SEGMENT:HTTP_REQUEST_PATH_SEGMENT&gt;)&quot;</span>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="structT.html">T</a> *req = <a class="code" href="group__semtrex.html#gabe49b12bfb8785a10bf088c4ebe60db4">parseSemtrex</a>(G_sem,stx);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a>(pattern,req);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">/*    T *req = _t_news(pattern,SEMTREX_SYMBOL_LITERAL,HTTP_REQUEST);</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">    T *seq = _t_newr(req,SEMTREX_SEQUENCE);</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">    _t_newr(seq,SEMTREX_SYMBOL_ANY);  // skips the Version</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">    _t_newr(seq,SEMTREX_SYMBOL_ANY);  // skips over the Method</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">    T *path = _t_news(seq,SEMTREX_SYMBOL_LITERAL,HTTP_REQUEST_PATH);</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">    T *segs = _t_news(path,SEMTREX_SYMBOL_LITERAL,HTTP_REQUEST_PATH_SEGMENTS);</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">    T *g = _t_news(segs,SEMTREX_GROUP,HTTP_REQUEST_PATH_SEGMENT);</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">    _t_news(g,SEMTREX_SYMBOL_LITERAL,HTTP_REQUEST_PATH_SEGMENT);</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">// gotta load the defs into the receptor for printing things out to work right.</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">//    r-&gt;defs.symbols = _t_clone(test_HTTP_defs.symbols);</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">// r-&gt;defs.structures = _t_clone(test_HTTP_defs.structures);</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="structT.html">T</a> *result;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordtype">int</span> matched;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">// make sure our expectation semtrex actually matches the signal</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    spec_is_true(<a class="code" href="group__semtrex.html#ga27540c8e1822da3160a0cc4717df410f">_t_matchr</a>(req,signal_contents,&amp;result));</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="structT.html">T</a> *m = <a class="code" href="group__semtrex.html#gada90f89374f4577e3ac8819e500a97a7">_t_get_match</a>(result,HTTP_REQUEST_PATH_SEGMENT);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    spec_is_str_equal(_td(r,m),<span class="stringliteral">&quot;(SEMTREX_MATCH:1 (SEMTREX_MATCH_SYMBOL:HTTP_REQUEST_PATH_SEGMENT) (SEMTREX_MATCH_PATH:/3/1/1) (SEMTREX_MATCH_SIBLINGS_COUNT:1))&quot;</span>);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">if</span> (result) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(result);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="structT.html">T</a> *params;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="structSemanticID.html">Process</a> p;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="http__example_8h.html#a5476caaca538a030a6770bc99a42f372">_makeTestHTTPResponseProcess</a>(r,&amp;params,&amp;p);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="structT.html">T</a> *act = <a class="code" href="group__tree.html#ga48ffc2a6e4aa4856b76fb53b97db87f3">_t_newp</a>(0,ACTION,p);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">// have this expectation clean itself up after one match</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="structT.html">T</a> *until = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(END_CONDITIONS);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    _t_newi(until,COUNT,1);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="structT.html">T</a> *<span class="keyword">using</span> = NULL;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="group__receptor.html#gab8d3726ccb2be829a2b8e7c9d84b0cb9">_r_add_expectation</a>(r,DEFAULT_ASPECT,HTTP_REQUEST,pattern,act,params,until,<span class="keyword">using</span>,NULL);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    Error err = <a class="code" href="group__receptor.html#ga7d40f33135ee51640d0d24b8c9e3e046">_r_deliver</a>(r,signal);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    spec_is_equal(err,noDeliveryErr);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// signal and run_tree should be added and ready on the process queue</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    spec_is_equal(r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>-&gt;<a class="code" href="structQ.html#a6708b052b51ce11613e298bf11a26328">contexts_count</a>,1);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    spec_is_str_equal(_td(r,__r_get_signals(r,DEFAULT_ASPECT)),</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                      <span class="stringliteral">&quot;(SIGNALS (SIGNAL (ENVELOPE (SIGNAL_UUID)) (MESSAGE (HEAD (FROM_ADDRESS (RECEPTOR_ADDR:3)) (TO_ADDRESS (RECEPTOR_ADDR:4)) (ASPECT_IDENT:DEFAULT_ASPECT) (CARRIER:HTTP_REQUEST)) (BODY:{(HTTP_REQUEST_LINE (HTTP_REQUEST_VERSION (VERSION_MAJOR:1) (VERSION_MINOR:1)) (HTTP_REQUEST_METHOD:GET) (HTTP_REQUEST_PATH (HTTP_REQUEST_PATH_SEGMENTS (HTTP_REQUEST_PATH_SEGMENT:groups) (HTTP_REQUEST_PATH_SEGMENT:5)) (HTTP_REQUEST_PATH_FILE (FILE_NAME:users) (FILE_EXTENSION:json)) (HTTP_REQUEST_PATH_QUERY (HTTP_REQUEST_PATH_QUERY_PARAMS (HTTP_REQUEST_PATH_QUERY_PARAM (PARAM_KEY:sort_by) (PARAM_VALUE:last_name)) (HTTP_REQUEST_PATH_QUERY_PARAM (PARAM_KEY:page) (PARAM_VALUE:2))))))})) (RUN_TREE (process:RESPOND (CARRIER:HTTP_RESPONSE) (PARAM_REF:/2/1)) (PARAMS (HTTP_RESPONSE (HTTP_RESPONSE_STATUS (STATUS_VALUE:200) (STATUS_TEXT:OK)) (HTTP_HEADERS (CONTENT_TYPE (MEDIA_TYPE_IDENT:TEXT_MEDIA_TYPE) (MEDIA_SUBTYPE_IDENT:CEPTR_TEXT_MEDIA_SUBTYPE))) (HTTP_RESPONSE_BODY (HTTP_REQUEST_PATH_SEGMENT:groups)))))))&quot;</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                      );</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">// manually run the process queue</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="process_8c.html#a64e8965291c67057b06f273db19a465d">_p_reduceq</a>(r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">// should add a pending signal to be sent with the matched PATH_SEGMENT returned as the response signal body</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    spec_is_str_equal(_td(r,r-&gt;pending_signals),<span class="stringliteral">&quot;(PENDING_SIGNALS (SIGNAL (ENVELOPE (SIGNAL_UUID)) (MESSAGE (HEAD (FROM_ADDRESS (RECEPTOR_ADDR:4)) (TO_ADDRESS (RECEPTOR_ADDR:3)) (ASPECT_IDENT:DEFAULT_ASPECT) (CARRIER:HTTP_RESPONSE) (IN_RESPONSE_TO_UUID)) (BODY:{(HTTP_RESPONSE (HTTP_RESPONSE_STATUS (STATUS_VALUE:200) (STATUS_TEXT:OK)) (HTTP_HEADERS (CONTENT_TYPE (MEDIA_TYPE_IDENT:TEXT_MEDIA_TYPE) (MEDIA_SUBTYPE_IDENT:CEPTR_TEXT_MEDIA_SUBTYPE))) (HTTP_RESPONSE_BODY (HTTP_REQUEST_PATH_SEGMENT:groups)))}))))&quot;</span>);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">if</span> (r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>-&gt;<a class="code" href="structQ.html#a7ee8f0b2d1cfefac4a7e3e8704bf6069">completed</a>) {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        result = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>-&gt;<a class="code" href="structQ.html#a7ee8f0b2d1cfefac4a7e3e8704bf6069">completed</a>-&gt;context-&gt;<a class="code" href="structR.html#aab5d23021e9afe31b32544e515f18c1f">run_tree</a>,1);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        spec_is_str_equal(_td(r,result),<span class="stringliteral">&quot;(SIGNAL_UUID)&quot;</span>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        spec_is_true(!r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>-&gt;<a class="code" href="structQ.html#a7ee8f0b2d1cfefac4a7e3e8704bf6069">completed</a>);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="structT.html">T</a> *es = __r_get_expectations(r,DEFAULT_ASPECT);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    spec_is_str_equal(_td(r,es),<span class="stringliteral">&quot;(EXPECTATIONS)&quot;</span>);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;}</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="keywordtype">void</span> testReceptorDef() {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a>(G_sem,TEST_RECEPTOR);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="structSemanticID.html">Symbol</a> lat = <a class="code" href="group__receptor.html#ga29fd5ebc5d1c142a7da96bd0dd36292c">_r_define_symbol</a>(r,FLOAT,<span class="stringliteral">&quot;Latitude&quot;</span>);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="structSemanticID.html">Symbol</a> lon = <a class="code" href="group__receptor.html#ga29fd5ebc5d1c142a7da96bd0dd36292c">_r_define_symbol</a>(r,FLOAT,<span class="stringliteral">&quot;Longitude&quot;</span>);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    spec_is_structure_equal(r,<a class="code" href="group__receptor.html#ga120e66982d483fbe004fd969cf1c353f">__r_get_symbol_structure</a>(r,lat),FLOAT);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <a class="code" href="structT.html">T</a> *def = _sem_get_def(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,lat);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    spec_is_str_equal(t2s(def),<span class="stringliteral">&quot;(SYMBOL_DEFINITION (SYMBOL_LABEL (ENGLISH_LABEL:Latitude)) (SYMBOL_STRUCTURE:FLOAT))&quot;</span>);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    def = _sem_get_def(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,lon);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    spec_is_str_equal(t2s(def),<span class="stringliteral">&quot;(SYMBOL_DEFINITION (SYMBOL_LABEL (ENGLISH_LABEL:Longitude)) (SYMBOL_STRUCTURE:FLOAT))&quot;</span>);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    spec_is_sem_equal(<a class="code" href="group__receptor.html#ga2b16e941a406a95aba1c8db047d00041">_r_get_sem_by_label</a>(r,<span class="stringliteral">&quot;Latitude&quot;</span>),lat);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="structSemanticID.html">SemanticID</a> sid;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    __sem_get_by_label(G_sem,<span class="stringliteral">&quot;Latitude&quot;</span>,&amp;sid,r-&gt;<a class="code" href="structReceptor.html#ae57114199054b577820844eaff7593dd">context</a>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    spec_is_sem_equal(sid,lat);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="structSemanticID.html">Structure</a> latlong = <a class="code" href="group__receptor.html#gae291bec8771c13074164984b08db4874">_r_define_structure</a>(r,<span class="stringliteral">&quot;Latlong&quot;</span>,2,lat,lon);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    def = _sem_get_def(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,latlong);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    spec_is_str_equal(t2s(def),<span class="stringliteral">&quot;(STRUCTURE_DEFINITION (STRUCTURE_LABEL (ENGLISH_LABEL:Latlong)) (STRUCTURE_SEQUENCE (STRUCTURE_SYMBOL:Latitude) (STRUCTURE_SYMBOL:Longitude)))&quot;</span>);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    spec_is_structure_equal(r,<a class="code" href="group__receptor.html#ga2b16e941a406a95aba1c8db047d00041">_r_get_sem_by_label</a>(r,<span class="stringliteral">&quot;Latlong&quot;</span>),latlong);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    spec_is_long_equal(<a class="code" href="group__receptor.html#gad886d976f8621ebb22d02c61f454265c">__r_get_symbol_size</a>(r,lat,0),<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="structSemanticID.html">Symbol</a> house_loc = <a class="code" href="group__receptor.html#ga29fd5ebc5d1c142a7da96bd0dd36292c">_r_define_symbol</a>(r,latlong,<span class="stringliteral">&quot;house location&quot;</span>);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    spec_is_sem_equal(<a class="code" href="group__receptor.html#ga120e66982d483fbe004fd969cf1c353f">__r_get_symbol_structure</a>(r,house_loc),latlong);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    spec_is_long_equal(<a class="code" href="group__receptor.html#gad886d976f8621ebb22d02c61f454265c">__r_get_symbol_size</a>(r,house_loc,0),<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*2);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="structSemanticID.html">Symbol</a> name = <a class="code" href="group__receptor.html#ga29fd5ebc5d1c142a7da96bd0dd36292c">_r_define_symbol</a>(r,CSTRING,<span class="stringliteral">&quot;name&quot;</span>);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    spec_is_long_equal(<a class="code" href="group__receptor.html#gad886d976f8621ebb22d02c61f454265c">__r_get_symbol_size</a>(r,name,<span class="stringliteral">&quot;zippy&quot;</span>),(<span class="keywordtype">long</span>)6);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <a class="code" href="structSemanticID.html">Structure</a> namedhouse = <a class="code" href="group__receptor.html#gae291bec8771c13074164984b08db4874">_r_define_structure</a>(r,<span class="stringliteral">&quot;namedhouse&quot;</span>,2,house_loc,name);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <a class="code" href="structSemanticID.html">Symbol</a> home = <a class="code" href="group__receptor.html#ga29fd5ebc5d1c142a7da96bd0dd36292c">_r_define_symbol</a>(r,namedhouse,<span class="stringliteral">&quot;home&quot;</span>);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordtype">char</span> surface[] ={1,2,3,4,5,6,7,8,<span class="charliteral">&#39;b&#39;</span>,<span class="charliteral">&#39;o&#39;</span>,<span class="charliteral">&#39;b&#39;</span>,<span class="charliteral">&#39;b&#39;</span>,<span class="charliteral">&#39;y&#39;</span>,0};</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    spec_is_long_equal(<a class="code" href="group__receptor.html#gad886d976f8621ebb22d02c61f454265c">__r_get_symbol_size</a>(r,home,surface),<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*2+6);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <a class="code" href="structT.html">T</a> *code = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(NOOP);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <a class="code" href="structSemanticID.html">Process</a> p = <a class="code" href="group__receptor.html#ga6bb73d41388d17428e5735ad9cbe5917">_r_define_process</a>(r,code,<span class="stringliteral">&quot;do nothing&quot;</span>,<span class="stringliteral">&quot;long version of doing nothing&quot;</span>,NULL,NULL);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    def = _sem_get_def(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,p);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    spec_is_str_equal(_td(r,def),<span class="stringliteral">&quot;(PROCESS_DEFINITION (PROCESS_NAME (ENGLISH_LABEL:do nothing)) (PROCESS_INTENTION:long version of doing nothing) (process:NOOP) (PROCESS_SIGNATURE))&quot;</span>);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;}</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="keywordtype">void</span> <a class="code" href="receptor__spec_8h.html#a98dc4c2784ade9388f0b5aad95d78aae">defineHouseLocation</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structSemanticID.html">Symbol</a> *lat,<a class="code" href="structSemanticID.html">Symbol</a> *lon, <a class="code" href="structSemanticID.html">Structure</a> *latlong, <a class="code" href="structSemanticID.html">Symbol</a> *house_loc) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    *lat = <a class="code" href="group__receptor.html#ga29fd5ebc5d1c142a7da96bd0dd36292c">_r_define_symbol</a>(r,FLOAT,<span class="stringliteral">&quot;latitude&quot;</span>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    *lon = <a class="code" href="group__receptor.html#ga29fd5ebc5d1c142a7da96bd0dd36292c">_r_define_symbol</a>(r,FLOAT,<span class="stringliteral">&quot;longitude&quot;</span>);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    *latlong = <a class="code" href="group__receptor.html#gae291bec8771c13074164984b08db4874">_r_define_structure</a>(r,<span class="stringliteral">&quot;latlong&quot;</span>,2,*lat,*lon);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    *house_loc = <a class="code" href="group__receptor.html#ga29fd5ebc5d1c142a7da96bd0dd36292c">_r_define_symbol</a>(r,*latlong,<span class="stringliteral">&quot;house location&quot;</span>);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;}</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno"><a class="line" href="receptor__spec_8h.html#a0f0176e080e437a43dfcc761f00ca284">  416</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="receptor__spec_8h.html#a0f0176e080e437a43dfcc761f00ca284">testReceptorDefMatch</a>() {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a>(G_sem,TEST_RECEPTOR);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="structSemanticID.html">Symbol</a> lat,lon,house_loc;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="structSemanticID.html">Structure</a> latlong;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <a class="code" href="receptor__spec_8h.html#a98dc4c2784ade9388f0b5aad95d78aae">defineHouseLocation</a>(r,&amp;lat,&amp;lon,&amp;latlong,&amp;house_loc);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <a class="code" href="structT.html">T</a> *t = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(house_loc);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordtype">float</span> x = 99.0;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="structT.html">T</a> *t_lat = _t_new(t,lat,&amp;x,<span class="keyword">sizeof</span>(x));</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="structT.html">T</a> *t_lon = _t_new(t,lon,&amp;x,<span class="keyword">sizeof</span>(x));</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <a class="code" href="structT.html">T</a> *stx = <a class="code" href="group__receptor.html#ga63078117d8c6850455a4419fd9b6b784">_r_build_def_semtrex</a>(r,house_loc);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordtype">char</span> buf[2000];</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    spec_is_str_equal(<a class="code" href="group__semtrex.html#ga0b627873ef75a23e1c24074e9893ee6e">_dump_semtrex</a>(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,stx,buf),<span class="stringliteral">&quot;/house location/(latitude,longitude)&quot;</span>);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    __t_dump(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,stx,0,buf);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    spec_is_str_equal(buf,<span class="stringliteral">&quot;(SEMTREX_SYMBOL_LITERAL (SEMTREX_SYMBOL:house location) (SEMTREX_SEQUENCE (SEMTREX_SYMBOL_LITERAL (SEMTREX_SYMBOL:latitude)) (SEMTREX_SYMBOL_LITERAL (SEMTREX_SYMBOL:longitude))))&quot;</span>);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">// a correctly structured tree should match its definition</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    spec_is_true(<a class="code" href="group__receptor.html#gaa8c97a2acf18af02e4e582d15932640c">_r_def_match</a>(r,house_loc,t));</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">// a correctly structured tree with different semantics shouldn&#39;t match its definition</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    t_lon-&gt;contents.symbol = lat;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    spec_is_true(!<a class="code" href="group__receptor.html#gaa8c97a2acf18af02e4e582d15932640c">_r_def_match</a>(r,house_loc,t));</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="comment">// an incorrectly structured tree (i.e. missing a child) shouldn&#39;t match its definition</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="group__tree.html#ga403644d86c835ceae71dc7af0356900f">_t_detach_by_idx</a>(t,2);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    spec_is_true(!<a class="code" href="group__receptor.html#gaa8c97a2acf18af02e4e582d15932640c">_r_def_match</a>(r,house_loc,t));</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(stx);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(t);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(t_lon);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div>
<div class="line"><a name="l00452"></a><span class="lineno"><a class="line" href="receptor__spec_8h.html#a741a85af68569521b05909746e0f3e72">  452</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="receptor__spec_8h.html#a741a85af68569521b05909746e0f3e72">testReceptorInstances</a>() {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a>(G_sem,TEST_RECEPTOR);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="structSemanticID.html">Symbol</a> lat,lon,house_loc;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <a class="code" href="structSemanticID.html">Structure</a> latlong;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="receptor__spec_8h.html#a98dc4c2784ade9388f0b5aad95d78aae">defineHouseLocation</a>(r,&amp;lat,&amp;lon,&amp;latlong,&amp;house_loc);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">// create a house location tree</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="structT.html">T</a> *t = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(house_loc);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordtype">float</span> ll[] = {132.5,92.3};</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="structT.html">T</a> *t_lat = _t_new(t,lat,&amp;ll[0],<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="structT.html">T</a> *t_lon = _t_new(t,lon,&amp;ll[1],<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <a class="code" href="structXaddr.html">Xaddr</a> x = <a class="code" href="group__receptor.html#gadd08a3c284251a2ec7e03b8f91eddc5c">_r_new_instance</a>(r,t);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    spec_is_equal(x.addr,1);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    spec_is_sem_equal(x.symbol,house_loc);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordtype">float</span> *ill;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <a class="code" href="structT.html">T</a> *i = <a class="code" href="group__receptor.html#gadc618904f81240b244e816234d1c906e">_r_get_instance</a>(r,x);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    wjson(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,i,<span class="stringliteral">&quot;houseloc&quot;</span>,-1);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    spec_is_ptr_equal(i,t);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <a class="code" href="group__receptor.html#ga2d10d474fac25653e38738ba8ac027e7">_r_delete_instance</a>(r,x);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    i = <a class="code" href="group__receptor.html#gadc618904f81240b244e816234d1c906e">_r_get_instance</a>(r,x);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    spec_is_ptr_equal(i,NULL);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;}</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="receptor__spec_8h.html#a0c65a8eec063de14d49ae6c3fadcf0d8">  483</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="receptor__spec_8h.html#a0c65a8eec063de14d49ae6c3fadcf0d8">testReceptorSerialize</a>() {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a>(G_sem,TEST_RECEPTOR);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <a class="code" href="structSemanticID.html">Symbol</a> lat,lon,house_loc;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <a class="code" href="structSemanticID.html">Structure</a> latlong;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    lat = <a class="code" href="group__receptor.html#ga2b16e941a406a95aba1c8db047d00041">_r_get_sem_by_label</a>(r,<span class="stringliteral">&quot;latitude&quot;</span>);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    lon = <a class="code" href="group__receptor.html#ga2b16e941a406a95aba1c8db047d00041">_r_get_sem_by_label</a>(r,<span class="stringliteral">&quot;longitude&quot;</span>);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    house_loc = <a class="code" href="group__receptor.html#ga2b16e941a406a95aba1c8db047d00041">_r_get_sem_by_label</a>(r,<span class="stringliteral">&quot;house location&quot;</span>);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    latlong = <a class="code" href="group__receptor.html#ga2b16e941a406a95aba1c8db047d00041">_r_get_sem_by_label</a>(r,<span class="stringliteral">&quot;latlong&quot;</span>);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">// create a house location tree</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <a class="code" href="structT.html">T</a> *t = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(house_loc);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordtype">float</span> ll[] = {132.5,92.3};</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <a class="code" href="structT.html">T</a> *t_lat = _t_new(t,lat,&amp;ll[0],<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <a class="code" href="structT.html">T</a> *t_lon = _t_new(t,lon,&amp;ll[1],<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <a class="code" href="structXaddr.html">Xaddr</a> x = <a class="code" href="group__receptor.html#gadd08a3c284251a2ec7e03b8f91eddc5c">_r_new_instance</a>(r,t);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="comment">// also add a sub-receptor as an instance so we can test proper</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="comment">// serialization of nested receptors</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r2 = <a class="code" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a>(G_sem,TEST_RECEPTOR);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <a class="code" href="structT.html">T</a> *ir = <a class="code" href="group__tree.html#ga7fd137a24b6795e1fc25c50ba91a767f">_t_new_receptor</a>(0,TEST_RECEPTOR,r2);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <a class="code" href="structXaddr.html">Xaddr</a> xr = <a class="code" href="group__receptor.html#gadd08a3c284251a2ec7e03b8f91eddc5c">_r_new_instance</a>(r,ir);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="structT.html">T</a> *t2 = _t_newi(0,TEST_INT_SYMBOL,314);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <a class="code" href="structXaddr.html">Xaddr</a> x2 = <a class="code" href="group__receptor.html#gadd08a3c284251a2ec7e03b8f91eddc5c">_r_new_instance</a>(r2,t2);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordtype">void</span> *surface;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordtype">size_t</span> length;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordtype">char</span> buf[2000];</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordtype">char</span> buf1[2000];</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <a class="code" href="structT.html">T</a> *signal_contents = _t_newi(0,TEST_INT_SYMBOL,314);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <a class="code" href="structReceptorAddress.html">ReceptorAddress</a> from = {3}; <span class="comment">// DUMMY ADDR</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <a class="code" href="structReceptorAddress.html">ReceptorAddress</a> to = {4}; <span class="comment">// DUMMY ADDR</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="comment">// add a signal too</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <a class="code" href="structT.html">T</a> *s = <a class="code" href="group__receptor.html#ga9bf86b246fd28187cf7d434dc2de9a81">__r_make_signal</a>(from,to,DEFAULT_ASPECT,TESTING,signal_contents,0,0,0);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <a class="code" href="group__receptor.html#ga7d40f33135ee51640d0d24b8c9e3e046">_r_deliver</a>(r,s);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <a class="code" href="group__receptor.html#ga3e737841784555574a0d90ad2eff4cc4">_r_serialize</a>(r,&amp;surface,&amp;length);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">// serialized receptor is two stacked serialized mtrees, first one for the state tree</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">// and then the second for the receptor&#39;s instances</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <a class="code" href="structS.html">S</a> *s1 = (<a class="code" href="structS.html">S</a> *)surface;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <a class="code" href="structS.html">S</a> *s2 = (<a class="code" href="structS.html">S</a> *)(surface + s1-&gt;total_size);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    spec_is_long_equal(length,s1-&gt;total_size+s2-&gt;total_size);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">//    spec_is_long_equal(length,250);</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">//    spec_is_long_equal(*(size_t *)surface,250);</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *ru = <a class="code" href="group__receptor.html#ga63e9fb219f66164df22ffb5356b218b2">_r_unserialize</a>(G_sem,surface);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">//    __r_dump_instances(r);</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">//    __r_dump_instances(ru);</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="comment">// check that the structures look the same by comparing a string dump of the two</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="comment">// receptors</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    __t_dump(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,r-&gt;<a class="code" href="structReceptor.html#aec6f1eee133a993b59baf50e75620fb6">root</a>,0,buf);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    __t_dump(ru-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,ru-&gt;<a class="code" href="structReceptor.html#aec6f1eee133a993b59baf50e75620fb6">root</a>,0,buf1);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    spec_is_str_equal(buf1,buf);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">// check flux</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    spec_is_sem_equal(<a class="code" href="group__tree.html#ga946600fb570f0cc913450905f6189d49">_t_symbol</a>(ru-&gt;<a class="code" href="structReceptor.html#af8aee3ef6d1d93b80427faa57e6f1468">flux</a>),FLUX);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    spec_is_sem_equal(<a class="code" href="group__tree.html#ga946600fb570f0cc913450905f6189d49">_t_symbol</a>(ru-&gt;pending_signals),PENDING_SIGNALS);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    spec_is_sem_equal(<a class="code" href="group__tree.html#ga946600fb570f0cc913450905f6189d49">_t_symbol</a>(ru-&gt;pending_responses),PENDING_RESPONSES);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">// check that the unserialized receptor is matched up to the correct definitions in the semtable</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    spec_is_sem_equal(<a class="code" href="group__receptor.html#ga2b16e941a406a95aba1c8db047d00041">_r_get_sem_by_label</a>(ru,<span class="stringliteral">&quot;latitude&quot;</span>),lat);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    spec_is_sem_equal(<a class="code" href="group__receptor.html#ga2b16e941a406a95aba1c8db047d00041">_r_get_sem_by_label</a>(ru,<span class="stringliteral">&quot;latlong&quot;</span>),latlong);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">// check that the unserialized receptor has all the instances loaded into the instance store too</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <a class="code" href="structT.html">T</a> *t1 = <a class="code" href="group__receptor.html#gadc618904f81240b244e816234d1c906e">_r_get_instance</a>(ru,x);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    buf[0] = buf1[0] = 0;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    __t_dump(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,t,0,buf);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    __t_dump(ru-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,t1,0,buf1);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    spec_is_str_equal(buf1,buf);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    t1 = <a class="code" href="group__receptor.html#gadc618904f81240b244e816234d1c906e">_r_get_instance</a>(ru,xr);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    spec_is_true(t1 != NULL);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">if</span> (t1) {</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        buf[0] = buf1[0] = 0;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        __t_dump(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,ir,0,buf);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        __t_dump(ru-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,t1,0,buf1);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        spec_is_str_equal(buf1,buf);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <a class="code" href="structReceptor.html">Receptor</a> *r3 = <a class="code" href="group__receptor.html#gac438809f0d3f3add97efd49729c9027f">__r_get_receptor</a>(t1);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        t1 = <a class="code" href="group__receptor.html#gadc618904f81240b244e816234d1c906e">_r_get_instance</a>(r3,x2);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        spec_is_equal(*(<span class="keywordtype">int</span>*)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(t1),314);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(ru);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="comment">//__r_dump_instances(r3); // show the 314 int</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    free(surface);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;}</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<a class="code" href="structSemanticID.html">Symbol</a> mantissa;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<a class="code" href="structSemanticID.html">Symbol</a> exponent;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<a class="code" href="structSemanticID.html">Symbol</a> exps[16];</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<a class="code" href="structSemanticID.html">Structure</a> flt;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<a class="code" href="structSemanticID.html">Structure</a> integer;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<a class="code" href="structSemanticID.html">Symbol</a> latitude;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<a class="code" href="structSemanticID.html">Symbol</a> longitude;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<a class="code" href="structSemanticID.html">Structure</a> lat_long;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<a class="code" href="structSemanticID.html">Symbol</a> home_location;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="keywordtype">void</span> defineNums(<a class="code" href="structReceptor.html">Receptor</a> *r) {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordtype">char</span> buf[10];</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt;16;i++){</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    sprintf(buf,<span class="stringliteral">&quot;exp%d&quot;</span>,i);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    exps[i] = <a class="code" href="group__receptor.html#ga29fd5ebc5d1c142a7da96bd0dd36292c">_r_define_symbol</a>(r,BIT,buf);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    integer = <a class="code" href="group__receptor.html#gae291bec8771c13074164984b08db4874">_r_define_structure</a>(r,<span class="stringliteral">&quot;integer&quot;</span>,16,exps[0],exps[1],exps[2],exps[3],exps[4],exps[5],exps[6],exps[7],exps[8],exps[9],exps[10],exps[11],exps[12],exps[13],exps[14],exps[15]);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    mantissa = <a class="code" href="group__receptor.html#ga29fd5ebc5d1c142a7da96bd0dd36292c">_r_define_symbol</a>(r,integer,<span class="stringliteral">&quot;mantissa&quot;</span>);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    exponent = <a class="code" href="group__receptor.html#ga29fd5ebc5d1c142a7da96bd0dd36292c">_r_define_symbol</a>(r,integer,<span class="stringliteral">&quot;exponent&quot;</span>);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    flt = <a class="code" href="group__receptor.html#gae291bec8771c13074164984b08db4874">_r_define_structure</a>(r,<span class="stringliteral">&quot;float&quot;</span>,2,mantissa,exponent);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    latitude = <a class="code" href="group__receptor.html#ga29fd5ebc5d1c142a7da96bd0dd36292c">_r_define_symbol</a>(r,flt,<span class="stringliteral">&quot;latitude&quot;</span>);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    longitude = <a class="code" href="group__receptor.html#ga29fd5ebc5d1c142a7da96bd0dd36292c">_r_define_symbol</a>(r,flt,<span class="stringliteral">&quot;longitude&quot;</span>);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    lat_long = <a class="code" href="group__receptor.html#gae291bec8771c13074164984b08db4874">_r_define_structure</a>(r,<span class="stringliteral">&quot;latlong&quot;</span>,2,latitude,longitude);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    home_location = <a class="code" href="group__receptor.html#ga29fd5ebc5d1c142a7da96bd0dd36292c">_r_define_symbol</a>(r,lat_long,<span class="stringliteral">&quot;home_location&quot;</span>);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;}</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="keywordtype">void</span> makeInt(<a class="code" href="structT.html">T</a> *t,<span class="keywordtype">int</span> v) {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt;16;i++){</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    _t_newi(t,exps[i],(v&gt;&gt;i)&amp;1);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;}</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="keywordtype">void</span> testReceptorNums() {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a>(G_sem,TEST_RECEPTOR);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    defineNums(r);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">// create a home location tree</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <a class="code" href="structT.html">T</a> *t = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(home_location);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <a class="code" href="structT.html">T</a> *lat = _t_newr(t,latitude);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <a class="code" href="structT.html">T</a> *lon = _t_newr(t,longitude);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <a class="code" href="structT.html">T</a> *m = _t_newr(lat,mantissa);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <a class="code" href="structT.html">T</a> *e = _t_newr(lat,exponent);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    makeInt(m,22);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    makeInt(e,1);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    m = _t_newr(lon,mantissa);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    e = _t_newr(lon,exponent);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    makeInt(m,1);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    makeInt(e,2);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    spec_is_str_equal(_td(r,t),<span class="stringliteral">&quot;(home_location (latitude (mantissa (exp0:0) (exp1:1) (exp2:1) (exp3:0) (exp4:1) (exp5:0) (exp6:0) (exp7:0) (exp8:0) (exp9:0) (exp10:0) (exp11:0) (exp12:0) (exp13:0) (exp14:0) (exp15:0)) (exponent (exp0:1) (exp1:0) (exp2:0) (exp3:0) (exp4:0) (exp5:0) (exp6:0) (exp7:0) (exp8:0) (exp9:0) (exp10:0) (exp11:0) (exp12:0) (exp13:0) (exp14:0) (exp15:0))) (longitude (mantissa (exp0:1) (exp1:0) (exp2:0) (exp3:0) (exp4:0) (exp5:0) (exp6:0) (exp7:0) (exp8:0) (exp9:0) (exp10:0) (exp11:0) (exp12:0) (exp13:0) (exp14:0) (exp15:0)) (exponent (exp0:0) (exp1:1) (exp2:0) (exp3:0) (exp4:0) (exp5:0) (exp6:0) (exp7:0) (exp8:0) (exp9:0) (exp10:0) (exp11:0) (exp12:0) (exp13:0) (exp14:0) (exp15:0))))&quot;</span>);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    wjson(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,t,<span class="stringliteral">&quot;homeloc&quot;</span>,-1);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(t);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;}</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="keywordtype">void</span> testReceptorEdgeStream() {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    FILE *rs,*ws;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordtype">char</span> buffer[] = <span class="stringliteral">&quot;line1\nline2\n&quot;</span>;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    rs = fmemopen(buffer, strlen (buffer), <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <a class="code" href="structStream.html">Stream</a> *reader_stream = _st_new_unix_stream(rs,1);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <a class="code" href="structVMHost.html">VMHost</a> *v = <a class="code" href="group__vmhost.html#gab6fbe5683628fb0d62a966316ced938d">_v_new</a>();</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordtype">char</span> *output_data;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordtype">size_t</span> size;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    ws = open_memstream(&amp;output_data,&amp;size);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <a class="code" href="structStream.html">Stream</a> *writer_stream = _st_new_unix_stream(ws,0);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = _r_makeStreamEdgeReceptor(v-&gt;<a class="code" href="structVMHost.html#a0718944e7f9d848d3b96f704ea0f0252">sem</a>);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <a class="code" href="structXaddr.html">Xaddr</a> edge = _v_new_receptor(v,v-&gt;<a class="code" href="structVMHost.html#a218d2e91e129dee7c71e1b06ff533a6e">r</a>,STREAM_EDGE,r);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    _r_addWriter(r,writer_stream,DEFAULT_ASPECT);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    _r_addReader(r,reader_stream,r-&gt;<a class="code" href="structReceptor.html#afeea3c89b6853516cd4c4d8e9d885174">addr</a>,DEFAULT_ASPECT,LINE,LINE,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    spec_is_str_equal(_td(r,__r_get_expectations(r,DEFAULT_ASPECT)),<span class="stringliteral">&quot;(EXPECTATIONS (EXPECTATION (CARRIER:NULL_SYMBOL) (PATTERN (SEMTREX_SYMBOL_ANY)) (ACTION:echo2stream) (PARAMS (EDGE_STREAM) (SLOT (USAGE:NULL_SYMBOL))) (END_CONDITIONS (UNLIMITED))))&quot;</span>);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment">// manually run the reader&#39;s process queue</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="comment">//debug_enable(D_STREAM);</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <a class="code" href="structQ.html">Q</a> *q = r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <a class="code" href="structStream.html">Stream</a> *st = reader_stream;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    spec_is_equal(<a class="code" href="process_8c.html#a64e8965291c67057b06f273db19a465d">_p_reduceq</a>(q),noReductionErr);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">while</span>(!(st-&gt;flags&amp;StreamHasData) &amp;&amp; st-&gt;flags&amp;StreamAlive ) {sleepms(1);};</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    spec_is_equal(<a class="code" href="process_8c.html#a64e8965291c67057b06f273db19a465d">_p_reduceq</a>(q),noReductionErr);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordflow">while</span>(!(st-&gt;flags&amp;StreamHasData) &amp;&amp; st-&gt;flags&amp;StreamAlive ) {sleepms(1);};</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    spec_is_equal(<a class="code" href="process_8c.html#a64e8965291c67057b06f273db19a465d">_p_reduceq</a>(q),noReductionErr);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordflow">while</span>(!(st-&gt;flags&amp;StreamHasData) &amp;&amp; st-&gt;flags&amp;StreamAlive ) {sleepms(1);};</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    spec_is_equal(<a class="code" href="process_8c.html#a64e8965291c67057b06f273db19a465d">_p_reduceq</a>(q),noReductionErr);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="comment">//debug_disable(D_STREAM);</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    spec_is_false(_st_is_alive(st));</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    spec_is_false(r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>-&gt;<a class="code" href="structQ.html#a7ee8f0b2d1cfefac4a7e3e8704bf6069">completed</a> == NULL);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">if</span> (r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>-&gt;<a class="code" href="structQ.html#a7ee8f0b2d1cfefac4a7e3e8704bf6069">completed</a>) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        spec_is_equal(r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>-&gt;<a class="code" href="structQ.html#a7ee8f0b2d1cfefac4a7e3e8704bf6069">completed</a>-&gt;context-&gt;<a class="code" href="structR.html#a162dc9bc3600d14082290d73d6e86ccc">err</a>,deadStreamReadReductionErr);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="comment">/* T *result = r-&gt;q-&gt;blocked-&gt;context-&gt;run_tree; */</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="comment">/* /// @todo BOOLEAN is what&#39;s left from the replicate.  Should it be something else? */</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="comment">/* spec_is_str_equal(_td(r,result),&quot;(RUN_TREE (BOOLEAN:0))&quot;); */</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    spec_is_str_equal(_td(r,r-&gt;pending_signals),<span class="stringliteral">&quot;(PENDING_SIGNALS (SIGNAL (ENVELOPE (SIGNAL_UUID)) (MESSAGE (HEAD (FROM_ADDRESS (RECEPTOR_ADDR:3)) (TO_ADDRESS (RECEPTOR_ADDR:3)) (ASPECT_IDENT:DEFAULT_ASPECT) (CARRIER:LINE)) (BODY:{(LINE:line1)}))) (SIGNAL (ENVELOPE (SIGNAL_UUID)) (MESSAGE (HEAD (FROM_ADDRESS (RECEPTOR_ADDR:3)) (TO_ADDRESS (RECEPTOR_ADDR:3)) (ASPECT_IDENT:DEFAULT_ASPECT) (CARRIER:LINE)) (BODY:{(LINE:line2)}))))&quot;</span>);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="comment">// manually run the signal sending code</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <a class="code" href="group__vmhost.html#ga7c2d4696c7ed325684c45f113ce0c2b2">_v_deliver_signals</a>(v,r);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="comment">// and see that they&#39;ve shown up in the edge receptor&#39;s flux signals list</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    spec_is_str_equal(_td(r,__r_get_signals(r,DEFAULT_ASPECT)),<span class="stringliteral">&quot;(SIGNALS (SIGNAL (ENVELOPE (SIGNAL_UUID)) (MESSAGE (HEAD (FROM_ADDRESS (RECEPTOR_ADDR:3)) (TO_ADDRESS (RECEPTOR_ADDR:3)) (ASPECT_IDENT:DEFAULT_ASPECT) (CARRIER:LINE)) (BODY:{(LINE:line1)})) (RUN_TREE (process:STREAM_WRITE (PARAM_REF:/2/1) (process:TRANSCODE (TRANSCODE_PARAMS (TRANSCODE_TO:LINES)) (TRANSCODE_ITEMS (PARAM_REF:/2/2)))) (PARAMS (EDGE_STREAM) (LINE:line1)))) (SIGNAL (ENVELOPE (SIGNAL_UUID)) (MESSAGE (HEAD (FROM_ADDRESS (RECEPTOR_ADDR:3)) (TO_ADDRESS (RECEPTOR_ADDR:3)) (ASPECT_IDENT:DEFAULT_ASPECT) (CARRIER:LINE)) (BODY:{(LINE:line2)})) (RUN_TREE (process:STREAM_WRITE (PARAM_REF:/2/1) (process:TRANSCODE (TRANSCODE_PARAMS (TRANSCODE_TO:LINES)) (TRANSCODE_ITEMS (PARAM_REF:/2/2)))) (PARAMS (EDGE_STREAM) (LINE:line2)))))&quot;</span>);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">// and that they&#39;ve been removed from process queue pending signals list</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    spec_is_str_equal(_td(r,r-&gt;pending_signals),<span class="stringliteral">&quot;(PENDING_SIGNALS)&quot;</span>);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    spec_is_str_equal(_td(r,r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>-&gt;<a class="code" href="structQ.html#a986c007532c25e847896a206182ed6e9">active</a>-&gt;context-&gt;<a class="code" href="structR.html#aab5d23021e9afe31b32544e515f18c1f">run_tree</a>),<span class="stringliteral">&quot;(RUN_TREE (process:STREAM_WRITE (PARAM_REF:/2/1) (process:TRANSCODE (TRANSCODE_PARAMS (TRANSCODE_TO:LINES)) (TRANSCODE_ITEMS (PARAM_REF:/2/2)))) (PARAMS (EDGE_STREAM) (LINE:line1)))&quot;</span>);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment">// manually run the process queue</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="comment">//debug_enable(D_REDUCE+D_STEP);</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <a class="code" href="process_8c.html#a64e8965291c67057b06f273db19a465d">_p_reduceq</a>(r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    debug_disable(D_REDUCE+D_STEP);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    spec_is_str_equal(_td(r,r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>-&gt;<a class="code" href="structQ.html#a7ee8f0b2d1cfefac4a7e3e8704bf6069">completed</a>-&gt;context-&gt;<a class="code" href="structR.html#aab5d23021e9afe31b32544e515f18c1f">run_tree</a>),<span class="stringliteral">&quot;(RUN_TREE (REDUCTION_ERROR_SYMBOL:NULL_SYMBOL) (PARAMS (EDGE_STREAM) (LINE:line2)))&quot;</span>);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    spec_is_str_equal(output_data,<span class="stringliteral">&quot;line1\nline2\n&quot;</span>);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <a class="code" href="stream_8c.html#abe8d8f68050d4ac4122baf7976a9e609">_st_free</a>(reader_stream);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <a class="code" href="stream_8c.html#abe8d8f68050d4ac4122baf7976a9e609">_st_free</a>(writer_stream);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    free(output_data);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <a class="code" href="group__vmhost.html#ga44e0f6d62e38448bfa058f287cc463eb">_v_free</a>(v);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;}</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="keywordtype">void</span> *_ltester(<span class="keywordtype">void</span> *arg) {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordtype">char</span> *result = doSys(<span class="stringliteral">&quot;echo &#39;testing!\nfish\n&#39; | nc localhost 8888&quot;</span>);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    spec_is_str_equal(result,<span class="stringliteral">&quot;testing!\nfish\n\n&quot;</span>);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    free(result);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    G_done = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    pthread_exit(NULL);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;}</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="keywordtype">void</span> testReceptorEdgeListener() {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <a class="code" href="structVMHost.html">VMHost</a> *v = <a class="code" href="group__vmhost.html#gab6fbe5683628fb0d62a966316ced938d">_v_new</a>();</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = _r_makeStreamEdgeReceptor(v-&gt;<a class="code" href="structVMHost.html#a0718944e7f9d848d3b96f704ea0f0252">sem</a>);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <a class="code" href="structXaddr.html">Xaddr</a> edge = _v_new_receptor(v,v-&gt;<a class="code" href="structVMHost.html#a218d2e91e129dee7c71e1b06ff533a6e">r</a>,STREAM_EDGE,r);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">      (RUN_TREE</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">         (INITIATE (PNAME:HTTP)</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">               (WHICH_INTERACTION:backnforth)</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">           (BINDINGS)</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">     )</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">      )</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">      (RUN_TREE</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">        (CONVERSE</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">      (SCOPE</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">        (LISTEN &lt;aspect&gt; &lt;carrier&gt; &lt;match&gt; (ACTION:echo2stream) (PARAMS (EDGE_STREAM) (SLOT (NULL_SYMBOL))))</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">        (LISTEN CONTROL &lt;carrier&gt; (PATTERN (CLOSE)) (STREAM_CLOSE (EDGE_STREAM)))</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">        (ITERATE (PARAMS) (STREAM_ALIVE (EDGE_STREAM))</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">        (SAY &lt;to&gt; &lt;aspect&gt; &lt;carrier&gt; (STREAM_READ (EDGE_STREAM) (RESULT_SYMBOL:&lt;result&gt;)))))</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">        (END_CONDITIONS (TIMEOUT_VALUE_HERE))</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">        (BOOLEAN:1) )</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">    (PARAMS)</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">        (COND (CONDITIONS</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">            (COND_PAIR (EQ_SYM (SYMBOL_OF (PARAM_REF:/4/1)) (RESULT_SYMBOL:READ_ON_DEAD_STREAM_ERROR))</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">           (CONTINUE (POP_PATH (PARAM_REF:/4/1/1) (RESULT_SYMBOL:CONTINUE_LOCATION) (POP_COUNT:2))</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">           (CONTINUE_VALUE (BOOLEAN:0))))</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">        (COND_ELSE (RAISE (PARAM_REF:/4/1)))</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">        ))</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">       (PARAMS  (READ_ON_DEAD_STREAM_ERROR (ERROR_LOCATION:/1/1/3/3/4))))</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <a class="code" href="structT.html">T</a> *code = <a class="code" href="group__tree.html#ga749a1b6c40a2fd3d36dc0f3e7f6bb6af">_t_parse</a>(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,0,<span class="stringliteral">&quot;(CONVERSE (SCOPE (LISTEN (ASPECT_IDENT:DEFAULT_ASPECT) (CARRIER:LINE) (PATTERN (SEMTREX_SYMBOL_ANY)) (ACTION:echo2stream) (PARAMS (PARAM_REF:/2/1) (SLOT (USAGE:NULL_SYMBOL)))) (ITERATE (PARAMS) (STREAM_ALIVE (PARAM_REF:/2/1)) (SAY % (ASPECT_IDENT:DEFAULT_ASPECT) (CARRIER:LINE) (STREAM_READ (PARAM_REF:/2/1) (RESULT_SYMBOL:LINE)))) (STREAM_CLOSE (PARAM_REF:/2/1))) (BOOLEAN:1))&quot;</span>,__r_make_addr(0,TO_ADDRESS,r-&gt;<a class="code" href="structReceptor.html#afeea3c89b6853516cd4c4d8e9d885174">addr</a>));</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <a class="code" href="structT.html">T</a> *err_handler = <a class="code" href="group__tree.html#ga749a1b6c40a2fd3d36dc0f3e7f6bb6af">_t_parse</a>(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,0,<span class="stringliteral">&quot;(CONTINUE (POP_PATH (PARAM_REF:/4/1/1) (RESULT_SYMBOL:CONTINUE_LOCATION) (POP_COUNT:2)) (CONTINUE_VALUE (BOOLEAN:0)))&quot;</span>);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="comment">// listen and then send the received LINE directly back to your self.  Acts like &quot;echo.&quot;</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <a class="code" href="structSocketListener.html">SocketListener</a> *l = _r_addListener(r,8888,code,0,err_handler,DELIM_LF);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <a class="code" href="group__vmhost.html#ga53694170e5452b8062ec405e6a9a3f60">_v_activate</a>(v,edge);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="comment">//@todo currently we don&#39;t actually have a real symbol for the EDGE_SPEC and we&#39;re just using PARAMS.  FIXME!</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    spec_is_str_equal(_t2s(v-&gt;<a class="code" href="structVMHost.html#a0718944e7f9d848d3b96f704ea0f0252">sem</a>,r-&gt;<a class="code" href="structReceptor.html#afd45d33d3b6b5fdb8039b58e95587742">edge</a>),<span class="stringliteral">&quot;(PARAMS (EDGE_LISTENER) (process:CONVERSE (SCOPE (process:LISTEN (ASPECT_IDENT:DEFAULT_ASPECT) (CARRIER:LINE) (PATTERN (SEMTREX_SYMBOL_ANY)) (ACTION:echo2stream) (PARAMS (PARAM_REF:/2/1) (SLOT (USAGE:NULL_SYMBOL)))) (process:ITERATE (PARAMS) (process:STREAM_ALIVE (PARAM_REF:/2/1)) (process:SAY (TO_ADDRESS (RECEPTOR_ADDR:3)) (ASPECT_IDENT:DEFAULT_ASPECT) (CARRIER:LINE) (process:STREAM_READ (PARAM_REF:/2/1) (RESULT_SYMBOL:LINE)))) (process:STREAM_CLOSE (PARAM_REF:/2/1))) (BOOLEAN:1)) (PARAMS) (process:CONTINUE (process:POP_PATH (PARAM_REF:/4/1/1) (RESULT_SYMBOL:CONTINUE_LOCATION) (POP_COUNT:2)) (CONTINUE_VALUE (BOOLEAN:0))))&quot;</span>);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    _v_start_vmhost(v);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="comment">//debug_enable(D_STREAM+D_SOCKET+D_SIGNALS+D_STEP);//+D_REDUCE+D_REDUCEV</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    G_done = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    pthread_t <a class="code" href="structthread.html">thread</a>;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordtype">int</span> rc;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    rc = pthread_create(&amp;thread,0,_ltester,NULL);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">if</span> (rc){</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        raise_error(<span class="stringliteral">&quot;ERROR; return code from pthread_create() is %d\n&quot;</span>, rc);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    pthread_detach(thread);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="keywordflow">if</span> (rc){</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        raise_error(<span class="stringliteral">&quot;Error detaching tester thread; return code from pthread_detach() is %d\n&quot;</span>, rc);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keywordflow">while</span>(!G_done) sleepms(1);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    __r_kill(v-&gt;<a class="code" href="structVMHost.html#a218d2e91e129dee7c71e1b06ff533a6e">r</a>);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    _v_join_thread(&amp;v-&gt;vm_thread);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    debug_disable(D_STREAM+D_SOCKET+D_SIGNALS+D_STEP+D_REDUCE+D_REDUCEV);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    spec_is_str_equal(t2s(r-&gt;<a class="code" href="structReceptor.html#af8aee3ef6d1d93b80427faa57e6f1468">flux</a>),<span class="stringliteral">&quot;(FLUX (DEFAULT_ASPECT (EXPECTATIONS (EXPECTATION (CARRIER:LINE) (PATTERN (SEMTREX_SYMBOL_ANY)) (ACTION:echo2stream) (PARAMS (EDGE_STREAM) (SLOT (USAGE:NULL_SYMBOL))) (END_CONDITIONS (UNLIMITED)) (CONVERSATION_IDENT (CONVERSATION_UUID)))) (SIGNALS (SIGNAL (ENVELOPE (SIGNAL_UUID)) (MESSAGE (HEAD (FROM_ADDRESS (RECEPTOR_ADDR:3)) (TO_ADDRESS (RECEPTOR_ADDR:3)) (ASPECT_IDENT:DEFAULT_ASPECT) (CARRIER:LINE) (CONVERSATION_IDENT (CONVERSATION_UUID))) (BODY:{(LINE:testing!)})) (RUN_TREE (REDUCTION_ERROR_SYMBOL:NULL_SYMBOL) (PARAMS (EDGE_STREAM) (LINE:testing!)))) (SIGNAL (ENVELOPE (SIGNAL_UUID)) (MESSAGE (HEAD (FROM_ADDRESS (RECEPTOR_ADDR:3)) (TO_ADDRESS (RECEPTOR_ADDR:3)) (ASPECT_IDENT:DEFAULT_ASPECT) (CARRIER:LINE) (CONVERSATION_IDENT (CONVERSATION_UUID))) (BODY:{(LINE:fish)})) (RUN_TREE (REDUCTION_ERROR_SYMBOL:NULL_SYMBOL) (PARAMS (EDGE_STREAM) (LINE:fish)))) (SIGNAL (ENVELOPE (SIGNAL_UUID)) (MESSAGE (HEAD (FROM_ADDRESS (RECEPTOR_ADDR:3)) (TO_ADDRESS (RECEPTOR_ADDR:3)) (ASPECT_IDENT:DEFAULT_ASPECT) (CARRIER:LINE) (CONVERSATION_IDENT (CONVERSATION_UUID))) (BODY:{(LINE:)})) (RUN_TREE (REDUCTION_ERROR_SYMBOL:NULL_SYMBOL) (PARAMS (EDGE_STREAM) (LINE:)))))))&quot;</span>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <a class="code" href="group__vmhost.html#ga44e0f6d62e38448bfa058f287cc463eb">_v_free</a>(v);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;}</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="keywordtype">void</span> testReceptorClock() {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = _r_makeClockReceptor(G_sem);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    spec_is_str_equal(_td(r,r-&gt;<a class="code" href="structReceptor.html#aec6f1eee133a993b59baf50e75620fb6">root</a>),<span class="stringliteral">&quot;(RECEPTOR_INSTANCE (INSTANCE_OF:CLOCK_RECEPTOR) (CONTEXT_NUM:4) (PARENT_CONTEXT_NUM:0) (RECEPTOR_STATE (FLUX (DEFAULT_ASPECT (EXPECTATIONS (EXPECTATION (CARRIER:tell_time) (PATTERN (SEMTREX_SYMBOL_LITERAL (SEMTREX_SYMBOL:CLOCK_TELL_TIME))) (ACTION:respond with current time) (PARAMS) (END_CONDITIONS (UNLIMITED)))) (SIGNALS))) (PENDING_SIGNALS) (PENDING_RESPONSES) (CONVERSATIONS) (RECEPTOR_ELAPSED_TIME:0)))&quot;</span>);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;   <span class="comment">/*</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">      The clock receptor should do two things: respond to CLOCK_TELL_TIME signals with the current time, and also allow you to plant a listener based on a semtrex for any kind of time you want.  If you want the current time just plant a listener for TICK.  If you want to listen for every second plant a listener on the Symbol literal SECOND, and the clock receptor will trigger the listener every time the SECOND changes.  You can also listen for particular intervals and times by adding specificity to the semtrex, so to trigger a 3:30am action a-la-cron listen for: &quot;/&lt;TICK:(%HOUR=3,MINUTE=30)&gt;&quot;</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">       @todo we should also make the clock receptor also respond to other semantic formats, i.e. so it&#39;s easy to listen for things like &quot;on Wednesdays&quot;, or other semantic date/time identifiers.</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <a class="code" href="structSemanticID.html">Protocol</a> time;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    __sem_get_by_label(G_sem,<span class="stringliteral">&quot;time&quot;</span>,&amp;time,r-&gt;<a class="code" href="structReceptor.html#ae57114199054b577820844eaff7593dd">context</a>);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <a class="code" href="structT.html">T</a> *def = _sem_get_def(G_sem,time);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    spec_is_str_equal(_td(r,def),<span class="stringliteral">&quot;(PROTOCOL_DEFINITION (PROTOCOL_LABEL (ENGLISH_LABEL:time)) (PROTOCOL_SEMANTICS (ROLE:TIME_TELLER) (ROLE:TIME_HEARER) (GOAL:RESPONSE_HANDLER)) (tell_time (INITIATE (ROLE:TIME_HEARER) (DESTINATION (ROLE:TIME_TELLER)) (ACTION:time_request)) (EXPECT (ROLE:TIME_TELLER) (SOURCE (ROLE:TIME_HEARER)) (PATTERN (SEMTREX_SYMBOL_LITERAL (SEMTREX_SYMBOL:CLOCK_TELL_TIME))) (ACTION:respond with current time))))&quot;</span>);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="comment">//    debug_enable(D_SIGNALS);</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="comment">// send the clock receptor a &quot;tell me the time&quot; request by initiating the tell_time interaction in the protocol</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <a class="code" href="structT.html">T</a> *bindings = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(PROTOCOL_BINDINGS);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <a class="code" href="structT.html">T</a> *res = _t_newr(bindings,RESOLUTION);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <a class="code" href="structT.html">T</a> *w = _t_newr(res,WHICH_RECEPTOR);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    _t_news(w,ROLE,TIME_TELLER);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    __r_make_addr(w,ACTUAL_RECEPTOR,r-&gt;<a class="code" href="structReceptor.html#afeea3c89b6853516cd4c4d8e9d885174">addr</a>);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    res = _t_newr(bindings,RESOLUTION);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    w = _t_newr(res,WHICH_RECEPTOR);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    _t_news(w,ROLE,TIME_HEARER);</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    __r_make_addr(w,ACTUAL_RECEPTOR,r-&gt;<a class="code" href="structReceptor.html#afeea3c89b6853516cd4c4d8e9d885174">addr</a>);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    res = _t_newr(bindings,RESOLUTION);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    w = _t_newr(res,WHICH_PROCESS);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    _t_news(w,GOAL,RESPONSE_HANDLER);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="comment">// @todo bleah, this should be a better proc, at least with a SIGNAL_REF</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="comment">// or something.</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <a class="code" href="structT.html">T</a> *noop = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(NOOP);</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    _t_newi(noop,TEST_INT_SYMBOL,314);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <a class="code" href="structSemanticID.html">Process</a> proc = <a class="code" href="group__receptor.html#ga6bb73d41388d17428e5735ad9cbe5917">_r_define_process</a>(r,noop,<span class="stringliteral">&quot;do nothing&quot;</span>,<span class="stringliteral">&quot;long desc...&quot;</span>,NULL,NULL);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    _t_news(w,ACTUAL_PROCESS,proc);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <a class="code" href="group__accumulator.html#ga042c7032a9797ed0208f77b9c71c107b">_o_initiate</a>(r,time,tell_time,bindings);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    spec_is_str_equal(_td(r,r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>-&gt;<a class="code" href="structQ.html#a986c007532c25e847896a206182ed6e9">active</a>-&gt;context-&gt;<a class="code" href="structR.html#aab5d23021e9afe31b32544e515f18c1f">run_tree</a>),<span class="stringliteral">&quot;(RUN_TREE (process:do nothing (process:REQUEST (TO_ADDRESS (RECEPTOR_ADDR:4)) (ASPECT_IDENT:DEFAULT_ASPECT) (CARRIER:tell_time) (CLOCK_TELL_TIME) (RESPONSE_CARRIER:tell_time))) (PARAMS))&quot;</span>);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    _test_reduce_signals(r);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="comment">// we need a better indicator of success, but this at least shows that pending signals and</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="comment">// pending responses created should have been cleaned up.</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    spec_is_str_equal(_td(r,r-&gt;pending_signals),<span class="stringliteral">&quot;(PENDING_SIGNALS)&quot;</span>);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    spec_is_str_equal(_td(r,r-&gt;pending_responses),<span class="stringliteral">&quot;(PENDING_RESPONSES)&quot;</span>);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    debug_disable(D_SIGNALS);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <a class="code" href="structXaddr.html">Xaddr</a> x = {TICK,1};</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <a class="code" href="structT.html">T</a>* tick = <a class="code" href="group__receptor.html#gadc618904f81240b244e816234d1c906e">_r_get_instance</a>(r,x);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="comment">// clone the initial tick for later comparison</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    tick = <a class="code" href="group__tree.html#ga7535eb2963c6cf5fc78cb14287581f92">_t_clone</a>(tick);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="comment">// &quot;run&quot; the receptor and verify that the tick instance keeps getting updated</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="comment">// we wait a second first so that the first update will be a second later</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    sleepms(1005);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    pthread_t thread;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordtype">int</span> rc = 0;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    rc = pthread_create(&amp;thread,0,<a class="code" href="group__receptor.html#ga4cb85b79ae4207e4595d003d11beb226">___clock_thread</a>,r);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordflow">if</span> (rc){</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        raise_error(<span class="stringliteral">&quot;ERROR; return code from pthread_create() is %d\n&quot;</span>, rc);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    sleepms(1);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <a class="code" href="structT.html">T</a>* ntick = <a class="code" href="group__receptor.html#gadc618904f81240b244e816234d1c906e">_r_get_instance</a>(r,x);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keywordtype">int</span> p[] = {2,3,TREE_PATH_TERMINATOR};</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    spec_is_equal(*(<span class="keywordtype">int</span> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#gaf019d190c9623de809d006e309a441af">_t_get</a>(ntick,p)),</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                  1+*(<span class="keywordtype">int</span> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#gaf019d190c9623de809d006e309a441af">_t_get</a>(tick,p))  <span class="comment">// should be 1 second later!</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                  );</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    __r_kill(r);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keywordtype">void</span> *status;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    rc = pthread_join(thread, &amp;status);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">if</span> (rc) {</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        raise_error(<span class="stringliteral">&quot;ERROR; return code from pthread_join() is %d\n&quot;</span>, rc);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    }</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    debug_disable(D_SIGNALS);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(tick);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;}</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="keywordtype">void</span> testReceptor() {</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <a class="code" href="receptor__spec_8h.html#a3a764534a7cc2c00a1e15642d0554b7c">testReceptorCreate</a>();</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    testReceptorAddRemoveExpectation();</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    testReceptorSignal();</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    testReceptorSignalDeliver();</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    testReceptorResponseDeliver();</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    testReceptorDeliverConversation();</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    testReceptorConversations();</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    testReceptorEndCondition();</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <a class="code" href="receptor__spec_8h.html#a1cff5f815970b5209885f117bc705fd0">testReceptorExpectation</a>();</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    testReceptorDef();</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <a class="code" href="receptor__spec_8h.html#a0f0176e080e437a43dfcc761f00ca284">testReceptorDefMatch</a>();</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <a class="code" href="receptor__spec_8h.html#a741a85af68569521b05909746e0f3e72">testReceptorInstances</a>();</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <a class="code" href="receptor__spec_8h.html#a0c65a8eec063de14d49ae6c3fadcf0d8">testReceptorSerialize</a>();</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    testReceptorNums();</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    testReceptorEdgeStream();</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    testReceptorEdgeListener();</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    testReceptorClock();</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;}</div>
<div class="ttc" id="group__tree_html_ga25dd0f385044ffbcc7c215ea80fa00b4"><div class="ttname"><a href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a></div><div class="ttdeci">T * _t_new_root(Symbol symbol)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00160">tree.c:160</a></div></div>
<div class="ttc" id="structReceptor_html_afd45d33d3b6b5fdb8039b58e95587742"><div class="ttname"><a href="structReceptor.html#afd45d33d3b6b5fdb8039b58e95587742">Receptor::edge</a></div><div class="ttdeci">T * edge</div><div class="ttdoc">data store for edge receptors </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00252">ceptr_types.h:252</a></div></div>
<div class="ttc" id="structT_html"><div class="ttname"><a href="structT.html">T</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00114">ceptr_types.h:114</a></div></div>
<div class="ttc" id="group__receptor_html_ga120e66982d483fbe004fd969cf1c353f"><div class="ttname"><a href="group__receptor.html#ga120e66982d483fbe004fd969cf1c353f">__r_get_symbol_structure</a></div><div class="ttdeci">Structure __r_get_symbol_structure(Receptor *r, Symbol s)</div><div class="ttdoc">find a symbol&#39;s structure </div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00299">receptor.c:299</a></div></div>
<div class="ttc" id="group__receptor_html_ga3e737841784555574a0d90ad2eff4cc4"><div class="ttname"><a href="group__receptor.html#ga3e737841784555574a0d90ad2eff4cc4">_r_serialize</a></div><div class="ttdeci">void _r_serialize(Receptor *r, void **surfaceP, size_t *lengthP)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00432">receptor.c:432</a></div></div>
<div class="ttc" id="structStream_html"><div class="ttname"><a href="structStream.html">Stream</a></div><div class="ttdef"><b>Definition:</b> <a href="stream_8h_source.html#l00030">stream.h:30</a></div></div>
<div class="ttc" id="receptor__spec_8h_html_a3a764534a7cc2c00a1e15642d0554b7c"><div class="ttname"><a href="receptor__spec_8h.html#a3a764534a7cc2c00a1e15642d0554b7c">testReceptorCreate</a></div><div class="ttdeci">void testReceptorCreate()</div><div class="ttdef"><b>Definition:</b> <a href="receptor__spec_8h_source.html#l00017">receptor_spec.h:17</a></div></div>
<div class="ttc" id="structQ_html"><div class="ttname"><a href="structQ.html">Q</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00206">ceptr_types.h:206</a></div></div>
<div class="ttc" id="group__tree_html_gaf019d190c9623de809d006e309a441af"><div class="ttname"><a href="group__tree.html#gaf019d190c9623de809d006e309a441af">_t_get</a></div><div class="ttdeci">T * _t_get(T *t, int *p)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l01441">tree.c:1441</a></div></div>
<div class="ttc" id="spec__utils_8h_html"><div class="ttname"><a href="spec__utils_8h.html">spec_utils.h</a></div></div>
<div class="ttc" id="group__tree_html_ga403644d86c835ceae71dc7af0356900f"><div class="ttname"><a href="group__tree.html#ga403644d86c835ceae71dc7af0356900f">_t_detach_by_idx</a></div><div class="ttdeci">T * _t_detach_by_idx(T *t, int i)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00278">tree.c:278</a></div></div>
<div class="ttc" id="receptor__spec_8h_html_a0f0176e080e437a43dfcc761f00ca284"><div class="ttname"><a href="receptor__spec_8h.html#a0f0176e080e437a43dfcc761f00ca284">testReceptorDefMatch</a></div><div class="ttdeci">void testReceptorDefMatch()</div><div class="ttdoc">[defineHouseLocation] </div><div class="ttdef"><b>Definition:</b> <a href="receptor__spec_8h_source.html#l00416">receptor_spec.h:416</a></div></div>
<div class="ttc" id="receptor__spec_8h_html_a741a85af68569521b05909746e0f3e72"><div class="ttname"><a href="receptor__spec_8h.html#a741a85af68569521b05909746e0f3e72">testReceptorInstances</a></div><div class="ttdeci">void testReceptorInstances()</div><div class="ttdef"><b>Definition:</b> <a href="receptor__spec_8h_source.html#l00452">receptor_spec.h:452</a></div></div>
<div class="ttc" id="group__tree_html_ga7fd137a24b6795e1fc25c50ba91a767f"><div class="ttname"><a href="group__tree.html#ga7fd137a24b6795e1fc25c50ba91a767f">_t_new_receptor</a></div><div class="ttdeci">T * _t_new_receptor(T *parent, Symbol symbol, Receptor *r)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00204">tree.c:204</a></div></div>
<div class="ttc" id="receptor__spec_8h_html_a0c65a8eec063de14d49ae6c3fadcf0d8"><div class="ttname"><a href="receptor__spec_8h.html#a0c65a8eec063de14d49ae6c3fadcf0d8">testReceptorSerialize</a></div><div class="ttdeci">void testReceptorSerialize()</div><div class="ttdef"><b>Definition:</b> <a href="receptor__spec_8h_source.html#l00483">receptor_spec.h:483</a></div></div>
<div class="ttc" id="structS_html"><div class="ttname"><a href="structS.html">S</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00068">ceptr_types.h:68</a></div></div>
<div class="ttc" id="group__tree_html_ga7535eb2963c6cf5fc78cb14287581f92"><div class="ttname"><a href="group__tree.html#ga7535eb2963c6cf5fc78cb14287581f92">_t_clone</a></div><div class="ttdeci">T * _t_clone(T *t)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00589">tree.c:589</a></div></div>
<div class="ttc" id="group__receptor_html_ga6f650808029d4c598ebe6515d9900ef8"><div class="ttname"><a href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a></div><div class="ttdeci">void _r_free(Receptor *r)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00186">receptor.c:186</a></div></div>
<div class="ttc" id="process_8c_html_a64e8965291c67057b06f273db19a465d"><div class="ttname"><a href="process_8c.html#a64e8965291c67057b06f273db19a465d">_p_reduceq</a></div><div class="ttdeci">Error _p_reduceq(Q *q)</div><div class="ttdef"><b>Definition:</b> <a href="process_8c_source.html#l02126">process.c:2126</a></div></div>
<div class="ttc" id="group__tree_html_ga946600fb570f0cc913450905f6189d49"><div class="ttname"><a href="group__tree.html#ga946600fb570f0cc913450905f6189d49">_t_symbol</a></div><div class="ttdeci">Symbol _t_symbol(T *t)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l01228">tree.c:1228</a></div></div>
<div class="ttc" id="group__tree_html_ga07dd808fabd8a722b417f2f5e5ca132b"><div class="ttname"><a href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a></div><div class="ttdeci">T * _t_child(T *t, int i)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l01251">tree.c:1251</a></div></div>
<div class="ttc" id="group__receptor_html_gac438809f0d3f3add97efd49729c9027f"><div class="ttname"><a href="group__receptor.html#gac438809f0d3f3add97efd49729c9027f">__r_get_receptor</a></div><div class="ttdeci">Receptor * __r_get_receptor(T *installed_receptor)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l01039">receptor.c:1039</a></div></div>
<div class="ttc" id="group__tree_html_ga48ffc2a6e4aa4856b76fb53b97db87f3"><div class="ttname"><a href="group__tree.html#ga48ffc2a6e4aa4856b76fb53b97db87f3">_t_newp</a></div><div class="ttdeci">T * _t_newp(T *parent, Symbol symbol, Process surface)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00251">tree.c:251</a></div></div>
<div class="ttc" id="structR_html_a162dc9bc3600d14082290d73d6e86ccc"><div class="ttname"><a href="structR.html#a162dc9bc3600d14082290d73d6e86ccc">R::err</a></div><div class="ttdeci">int err</div><div class="ttdoc">process error value </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00170">ceptr_types.h:170</a></div></div>
<div class="ttc" id="group__vmhost_html_ga44e0f6d62e38448bfa058f287cc463eb"><div class="ttname"><a href="group__vmhost.html#ga44e0f6d62e38448bfa058f287cc463eb">_v_free</a></div><div class="ttdeci">void _v_free(VMHost *v)</div><div class="ttdef"><b>Definition:</b> <a href="vmhost_8c_source.html#l00071">vmhost.c:71</a></div></div>
<div class="ttc" id="structReceptor_html_ae57114199054b577820844eaff7593dd"><div class="ttname"><a href="structReceptor.html#ae57114199054b577820844eaff7593dd">Receptor::context</a></div><div class="ttdeci">Context context</div><div class="ttdoc">the context this receptor&#39;s definition creates </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00240">ceptr_types.h:240</a></div></div>
<div class="ttc" id="structReceptor_html_afeea3c89b6853516cd4c4d8e9d885174"><div class="ttname"><a href="structReceptor.html#afeea3c89b6853516cd4c4d8e9d885174">Receptor::addr</a></div><div class="ttdeci">ReceptorAddress addr</div><div class="ttdoc">the address by which to get messages to this receptor instance </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00241">ceptr_types.h:241</a></div></div>
<div class="ttc" id="structthread_html"><div class="ttname"><a href="structthread.html">thread</a></div><div class="ttdef"><b>Definition:</b> <a href="vmhost_8h_source.html#l00020">vmhost.h:20</a></div></div>
<div class="ttc" id="group__receptor_html_gae291bec8771c13074164984b08db4874"><div class="ttname"><a href="group__receptor.html#gae291bec8771c13074164984b08db4874">_r_define_structure</a></div><div class="ttdeci">Structure _r_define_structure(Receptor *r, char *label, int num_params,...)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00236">receptor.c:236</a></div></div>
<div class="ttc" id="group__receptor_html_gab8d3726ccb2be829a2b8e7c9d84b0cb9"><div class="ttname"><a href="group__receptor.html#gab8d3726ccb2be829a2b8e7c9d84b0cb9">_r_add_expectation</a></div><div class="ttdeci">void _r_add_expectation(Receptor *r, Aspect aspect, Symbol carrier, T *pattern, T *action, T *with, T *until, T *using, T *cid)</div><div class="ttdoc">Adds an expectation to a receptor&#39;s aspect. </div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00164">receptor.c:164</a></div></div>
<div class="ttc" id="group__vmhost_html_gab6fbe5683628fb0d62a966316ced938d"><div class="ttname"><a href="group__vmhost.html#gab6fbe5683628fb0d62a966316ced938d">_v_new</a></div><div class="ttdeci">VMHost * _v_new()</div><div class="ttdoc">Creates a new virtual machine host. </div><div class="ttdef"><b>Definition:</b> <a href="vmhost_8c_source.html#l00041">vmhost.c:41</a></div></div>
<div class="ttc" id="structReceptor_html_ab1e1dd776afee48ee71297a3e39756f8"><div class="ttname"><a href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">Receptor::q</a></div><div class="ttdeci">Q * q</div><div class="ttdoc">process queue </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00250">ceptr_types.h:250</a></div></div>
<div class="ttc" id="structReceptorAddress_html"><div class="ttname"><a href="structReceptorAddress.html">ReceptorAddress</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00198">ceptr_types.h:198</a></div></div>
<div class="ttc" id="group__tree_html_gac9278e540a0d63526b60cc0591283a62"><div class="ttname"><a href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a></div><div class="ttdeci">void * _t_surface(T *t)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l01215">tree.c:1215</a></div></div>
<div class="ttc" id="group__semtrex_html_gada90f89374f4577e3ac8819e500a97a7"><div class="ttname"><a href="group__semtrex.html#gada90f89374f4577e3ac8819e500a97a7">_t_get_match</a></div><div class="ttdeci">T * _t_get_match(T *match, Symbol group)</div><div class="ttdef"><b>Definition:</b> <a href="semtrex_8c_source.html#l00848">semtrex.c:848</a></div></div>
<div class="ttc" id="structReceptor_html_af8aee3ef6d1d93b80427faa57e6f1468"><div class="ttname"><a href="structReceptor.html#af8aee3ef6d1d93b80427faa57e6f1468">Receptor::flux</a></div><div class="ttdeci">T * flux</div><div class="ttdoc">pointer for quick access to the flux </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00243">ceptr_types.h:243</a></div></div>
<div class="ttc" id="group__vmhost_html_ga53694170e5452b8062ec405e6a9a3f60"><div class="ttname"><a href="group__vmhost.html#ga53694170e5452b8062ec405e6a9a3f60">_v_activate</a></div><div class="ttdeci">void _v_activate(VMHost *v, Xaddr x)</div><div class="ttdef"><b>Definition:</b> <a href="vmhost_8c_source.html#l00172">vmhost.c:172</a></div></div>
<div class="ttc" id="group__receptor_html_ga9f66f2aaba88463a6e1f238a367a33f9"><div class="ttname"><a href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a></div><div class="ttdeci">Receptor * _r_new(SemTable *sem, SemanticID r)</div><div class="ttdoc">Creates a new receptor. </div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00088">receptor.c:88</a></div></div>
<div class="ttc" id="receptor__spec_8h_html_a1cff5f815970b5209885f117bc705fd0"><div class="ttname"><a href="receptor__spec_8h.html#a1cff5f815970b5209885f117bc705fd0">testReceptorExpectation</a></div><div class="ttdeci">void testReceptorExpectation()</div><div class="ttdef"><b>Definition:</b> <a href="receptor__spec_8h_source.html#l00268">receptor_spec.h:268</a></div></div>
<div class="ttc" id="structVMHost_html_a0718944e7f9d848d3b96f704ea0f0252"><div class="ttname"><a href="structVMHost.html#a0718944e7f9d848d3b96f704ea0f0252">VMHost::sem</a></div><div class="ttdeci">SemTable * sem</div><div class="ttdoc">Semantic Table for definitions on this host. </div><div class="ttdef"><b>Definition:</b> <a href="vmhost_8h_source.html#l00044">vmhost.h:44</a></div></div>
<div class="ttc" id="http__example_8h_html"><div class="ttname"><a href="http__example_8h.html">http_example.h</a></div></div>
<div class="ttc" id="http__example_8h_html_a5476caaca538a030a6770bc99a42f372"><div class="ttname"><a href="http__example_8h.html#a5476caaca538a030a6770bc99a42f372">_makeTestHTTPResponseProcess</a></div><div class="ttdeci">void _makeTestHTTPResponseProcess(Receptor *r, T **paramsP, Process *pP)</div><div class="ttdoc">[makeTestHTTPRequestTree] </div><div class="ttdef"><b>Definition:</b> <a href="http__example_8h_source.html#l00051">http_example.h:51</a></div></div>
<div class="ttc" id="group__receptor_html_ga63e9fb219f66164df22ffb5356b218b2"><div class="ttname"><a href="group__receptor.html#ga63e9fb219f66164df22ffb5356b218b2">_r_unserialize</a></div><div class="ttdeci">Receptor * _r_unserialize(SemTable *sem, void *surface)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00459">receptor.c:459</a></div></div>
<div class="ttc" id="structQ_html_a986c007532c25e847896a206182ed6e9"><div class="ttname"><a href="structQ.html#a986c007532c25e847896a206182ed6e9">Q::active</a></div><div class="ttdeci">Qe * active</div><div class="ttdoc">active processes </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00209">ceptr_types.h:209</a></div></div>
<div class="ttc" id="structUUIDt_html"><div class="ttname"><a href="structUUIDt.html">UUIDt</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00255">ceptr_types.h:255</a></div></div>
<div class="ttc" id="group__receptor_html_ga2b16e941a406a95aba1c8db047d00041"><div class="ttname"><a href="group__receptor.html#ga2b16e941a406a95aba1c8db047d00041">_r_get_sem_by_label</a></div><div class="ttdeci">Symbol _r_get_sem_by_label(Receptor *r, char *label)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00288">receptor.c:288</a></div></div>
<div class="ttc" id="structQ_html_a6708b052b51ce11613e298bf11a26328"><div class="ttname"><a href="structQ.html#a6708b052b51ce11613e298bf11a26328">Q::contexts_count</a></div><div class="ttdeci">int contexts_count</div><div class="ttdoc">number of active processes </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00208">ceptr_types.h:208</a></div></div>
<div class="ttc" id="stream_8c_html_abe8d8f68050d4ac4122baf7976a9e609"><div class="ttname"><a href="stream_8c.html#abe8d8f68050d4ac4122baf7976a9e609">_st_free</a></div><div class="ttdeci">void _st_free(Stream *st)</div><div class="ttdef"><b>Definition:</b> <a href="stream_8c_source.html#l00507">stream.c:507</a></div></div>
<div class="ttc" id="group__accumulator_html_ga042c7032a9797ed0208f77b9c71c107b"><div class="ttname"><a href="group__accumulator.html#ga042c7032a9797ed0208f77b9c71c107b">_o_initiate</a></div><div class="ttdeci">void _o_initiate(Receptor *r, SemanticID protocol, SemanticID interaction, T *bindings)</div><div class="ttdef"><b>Definition:</b> <a href="protocol_8c_source.html#l00506">protocol.c:506</a></div></div>
<div class="ttc" id="group__semtrex_html_ga27540c8e1822da3160a0cc4717df410f"><div class="ttname"><a href="group__semtrex.html#ga27540c8e1822da3160a0cc4717df410f">_t_matchr</a></div><div class="ttdeci">int _t_matchr(T *semtrex, T *t, T **rP)</div><div class="ttdef"><b>Definition:</b> <a href="semtrex_8c_source.html#l00798">semtrex.c:798</a></div></div>
<div class="ttc" id="structVMHost_html"><div class="ttname"><a href="structVMHost.html">VMHost</a></div><div class="ttdef"><b>Definition:</b> <a href="vmhost_8h_source.html#l00040">vmhost.h:40</a></div></div>
<div class="ttc" id="group__receptor_html_ga9bf86b246fd28187cf7d434dc2de9a81"><div class="ttname"><a href="group__receptor.html#ga9bf86b246fd28187cf7d434dc2de9a81">__r_make_signal</a></div><div class="ttdeci">T * __r_make_signal(ReceptorAddress from, ReceptorAddress to, Aspect aspect, Symbol carrier, T *signal_contents, UUIDt *in_response_to, T *until, T *cid)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00515">receptor.c:515</a></div></div>
<div class="ttc" id="group__receptor_html_ga63078117d8c6850455a4419fd9b6b784"><div class="ttname"><a href="group__receptor.html#ga63078117d8c6850455a4419fd9b6b784">_r_build_def_semtrex</a></div><div class="ttdeci">T * _r_build_def_semtrex(Receptor *r, Symbol s)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00325">receptor.c:325</a></div></div>
<div class="ttc" id="receptor__spec_8h_html_a98dc4c2784ade9388f0b5aad95d78aae"><div class="ttname"><a href="receptor__spec_8h.html#a98dc4c2784ade9388f0b5aad95d78aae">defineHouseLocation</a></div><div class="ttdeci">void defineHouseLocation(Receptor *r, Symbol *lat, Symbol *lon, Structure *latlong, Symbol *house_loc)</div><div class="ttdoc">[defineHouseLocation] </div><div class="ttdef"><b>Definition:</b> <a href="receptor__spec_8h_source.html#l00408">receptor_spec.h:408</a></div></div>
<div class="ttc" id="structReceptor_html_aec6f1eee133a993b59baf50e75620fb6"><div class="ttname"><a href="structReceptor.html#aec6f1eee133a993b59baf50e75620fb6">Receptor::root</a></div><div class="ttdeci">T * root</div><div class="ttdoc">RECEPTOR_INSTANCE semantic tree. </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00238">ceptr_types.h:238</a></div></div>
<div class="ttc" id="structQ_html_ab8eb183576f2b1753d80bfcfdd0cd22b"><div class="ttname"><a href="structQ.html#ab8eb183576f2b1753d80bfcfdd0cd22b">Q::blocked</a></div><div class="ttdeci">Qe * blocked</div><div class="ttdoc">blocked processes </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00211">ceptr_types.h:211</a></div></div>
<div class="ttc" id="structReceptor_html_a4bb9ce729b6b85fb99326e9df7b23cbd"><div class="ttname"><a href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">Receptor::sem</a></div><div class="ttdeci">SemTable * sem</div><div class="ttdoc">pointer back to the genotype table for this receptor&#39;s vmhost instance </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00242">ceptr_types.h:242</a></div></div>
<div class="ttc" id="group__receptor_html_gad886d976f8621ebb22d02c61f454265c"><div class="ttname"><a href="group__receptor.html#gad886d976f8621ebb22d02c61f454265c">__r_get_symbol_size</a></div><div class="ttdeci">size_t __r_get_symbol_size(Receptor *r, Symbol s, void *surface)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00314">receptor.c:314</a></div></div>
<div class="ttc" id="http__example_8h_html_a1c182b5a6e82ef49c6967183a15c3e8b"><div class="ttname"><a href="http__example_8h.html#a1c182b5a6e82ef49c6967183a15c3e8b">_makeTestHTTPRequestTree</a></div><div class="ttdeci">T * _makeTestHTTPRequestTree()</div><div class="ttdoc">[makeTestHTTPRequestTree] </div><div class="ttdef"><b>Definition:</b> <a href="http__example_8h_source.html#l00026">http_example.h:26</a></div></div>
<div class="ttc" id="group__receptor_html_gadc618904f81240b244e816234d1c906e"><div class="ttname"><a href="group__receptor.html#gadc618904f81240b244e816234d1c906e">_r_get_instance</a></div><div class="ttdeci">T * _r_get_instance(Receptor *r, Xaddr x)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00379">receptor.c:379</a></div></div>
<div class="ttc" id="structReceptor_html"><div class="ttname"><a href="structReceptor.html">Receptor</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00237">ceptr_types.h:237</a></div></div>
<div class="ttc" id="structXaddr_html"><div class="ttname"><a href="structXaddr.html">Xaddr</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00267">ceptr_types.h:267</a></div></div>
<div class="ttc" id="group__receptor_html_ga4cb85b79ae4207e4595d003d11beb226"><div class="ttname"><a href="group__receptor.html#ga4cb85b79ae4207e4595d003d11beb226">___clock_thread</a></div><div class="ttdeci">void * ___clock_thread(void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l01250">receptor.c:1250</a></div></div>
<div class="ttc" id="structVMHost_html_a218d2e91e129dee7c71e1b06ff533a6e"><div class="ttname"><a href="structVMHost.html#a218d2e91e129dee7c71e1b06ff533a6e">VMHost::r</a></div><div class="ttdeci">Receptor * r</div><div class="ttdoc">Receptor data for this vm host. </div><div class="ttdef"><b>Definition:</b> <a href="vmhost_8h_source.html#l00043">vmhost.h:43</a></div></div>
<div class="ttc" id="group__semtrex_html_ga12e70dc3d5fde33655e8731ad3bdd935"><div class="ttname"><a href="group__semtrex.html#ga12e70dc3d5fde33655e8731ad3bdd935">_sl</a></div><div class="ttdeci">#define _sl(t, s)</div><div class="ttdoc">macro to add a single symbol literal to semtrex tree </div><div class="ttdef"><b>Definition:</b> <a href="semtrex_8h_source.html#l00122">semtrex.h:122</a></div></div>
<div class="ttc" id="group__semtrex_html_gabe49b12bfb8785a10bf088c4ebe60db4"><div class="ttname"><a href="group__semtrex.html#gabe49b12bfb8785a10bf088c4ebe60db4">parseSemtrex</a></div><div class="ttdeci">T * parseSemtrex(SemTable *sem, char *stx)</div><div class="ttdef"><b>Definition:</b> <a href="semtrex_8c_source.html#l01298">semtrex.c:1298</a></div></div>
<div class="ttc" id="structQ_html_a7ee8f0b2d1cfefac4a7e3e8704bf6069"><div class="ttname"><a href="structQ.html#a7ee8f0b2d1cfefac4a7e3e8704bf6069">Q::completed</a></div><div class="ttdeci">Qe * completed</div><div class="ttdoc">completed processes (pending cleanup) </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00210">ceptr_types.h:210</a></div></div>
<div class="ttc" id="group__tree_html_ga749a1b6c40a2fd3d36dc0f3e7f6bb6af"><div class="ttname"><a href="group__tree.html#ga749a1b6c40a2fd3d36dc0f3e7f6bb6af">_t_parse</a></div><div class="ttdeci">T * _t_parse(SemTable *sem, T *parent, char *s,...)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00919">tree.c:919</a></div></div>
<div class="ttc" id="structR_html_aab5d23021e9afe31b32544e515f18c1f"><div class="ttname"><a href="structR.html#aab5d23021e9afe31b32544e515f18c1f">R::run_tree</a></div><div class="ttdeci">T * run_tree</div><div class="ttdoc">pointer to the root of the run_tree </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00172">ceptr_types.h:172</a></div></div>
<div class="ttc" id="structSocketListener_html"><div class="ttname"><a href="structSocketListener.html">SocketListener</a></div><div class="ttdef"><b>Definition:</b> <a href="stream_8h_source.html#l00060">stream.h:60</a></div></div>
<div class="ttc" id="group__tree_html_ga3b7a6499fe49f8e6a54166d583b08d5c"><div class="ttname"><a href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a></div><div class="ttdeci">void _t_add(T *t, T *c)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00261">tree.c:261</a></div></div>
<div class="ttc" id="group__receptor_html_ga29fd5ebc5d1c142a7da96bd0dd36292c"><div class="ttname"><a href="group__receptor.html#ga29fd5ebc5d1c142a7da96bd0dd36292c">_r_define_symbol</a></div><div class="ttdeci">Symbol _r_define_symbol(Receptor *r, Structure s, char *label)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00218">receptor.c:218</a></div></div>
<div class="ttc" id="group__vmhost_html_ga7c2d4696c7ed325684c45f113ce0c2b2"><div class="ttname"><a href="group__vmhost.html#ga7c2d4696c7ed325684c45f113ce0c2b2">_v_deliver_signals</a></div><div class="ttdeci">void _v_deliver_signals(VMHost *v, Receptor *sender)</div><div class="ttdef"><b>Definition:</b> <a href="vmhost_8c_source.html#l00235">vmhost.c:235</a></div></div>
<div class="ttc" id="group__receptor_html_ga7d40f33135ee51640d0d24b8c9e3e046"><div class="ttname"><a href="group__receptor.html#ga7d40f33135ee51640d0d24b8c9e3e046">_r_deliver</a></div><div class="ttdeci">Error _r_deliver(Receptor *r, T *signal)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00954">receptor.c:954</a></div></div>
<div class="ttc" id="group__semtrex_html_ga0b627873ef75a23e1c24074e9893ee6e"><div class="ttname"><a href="group__semtrex.html#ga0b627873ef75a23e1c24074e9893ee6e">_dump_semtrex</a></div><div class="ttdeci">char * _dump_semtrex(SemTable *sem, T *s, char *buf)</div><div class="ttdef"><b>Definition:</b> <a href="semtrex_8c_source.html#l01096">semtrex.c:1096</a></div></div>
<div class="ttc" id="group__receptor_html_ga6bb73d41388d17428e5735ad9cbe5917"><div class="ttname"><a href="group__receptor.html#ga6bb73d41388d17428e5735ad9cbe5917">_r_define_process</a></div><div class="ttdeci">Process _r_define_process(Receptor *r, T *code, char *name, char *intention, T *signature, T *link)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00275">receptor.c:275</a></div></div>
<div class="ttc" id="group__tree_html_ga31e55cdc031e5f12523b998e89080db6"><div class="ttname"><a href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a></div><div class="ttdeci">void _t_free(T *t)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00526">tree.c:526</a></div></div>
<div class="ttc" id="group__receptor_html_ga2d10d474fac25653e38738ba8ac027e7"><div class="ttname"><a href="group__receptor.html#ga2d10d474fac25653e38738ba8ac027e7">_r_delete_instance</a></div><div class="ttdeci">T * _r_delete_instance(Receptor *r, Xaddr x)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00407">receptor.c:407</a></div></div>
<div class="ttc" id="structSemanticID_html"><div class="ttname"><a href="structSemanticID.html">SemanticID</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00022">ceptr_types.h:22</a></div></div>
<div class="ttc" id="group__receptor_html_gaa8c97a2acf18af02e4e582d15932640c"><div class="ttname"><a href="group__receptor.html#gaa8c97a2acf18af02e4e582d15932640c">_r_def_match</a></div><div class="ttdeci">int _r_def_match(Receptor *r, Symbol s, T *t)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00343">receptor.c:343</a></div></div>
<div class="ttc" id="group__receptor_html_gadd08a3c284251a2ec7e03b8f91eddc5c"><div class="ttname"><a href="group__receptor.html#gadd08a3c284251a2ec7e03b8f91eddc5c">_r_new_instance</a></div><div class="ttdeci">Xaddr _r_new_instance(Receptor *r, T *t)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00365">receptor.c:365</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_937849c47cd127d593123ed6329d29aa.html">spec</a></li><li class="navelem"><a class="el" href="receptor__spec_8h.html">receptor_spec.h</a></li>
    <li class="footer">Generated on Thu Jul 21 2016 10:13:07 for ceptr by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
