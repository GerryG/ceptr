<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>ceptr: spec/receptor_spec.h</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ceptr
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('spec_2receptor_spec_8h-example.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">spec/receptor_spec.h</div>  </div>
</div><!--header-->
<div class="contents">
<p>Here are some examples of how to use receptors``</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;../src/ceptr.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;../src/receptor.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> testReceptorCreate() {</div>
<div class="line">    <a name="_a0"></a><a class="code" href="structReceptor.html">Receptor</a> *r;</div>
<div class="line">    r = <a name="a1"></a><a class="code" href="group__receptor.html#gaad12918fb4144e557b2ee5e169648c7b">_r_new</a>();</div>
<div class="line"></div>
<div class="line">    spec_is_symbol_equal(r,_t_symbol(r-&gt;<a name="a2"></a><a class="code" href="structReceptor.html#a7a280e923e97768c67f90303bcf8c152">root</a>),RECEPTOR);</div>
<div class="line"></div>
<div class="line">    <a name="_a3"></a><a class="code" href="structTnode.html">Tnode</a> *t;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// test that the symbols and structures tress are set up correctly</span></div>
<div class="line">    t = _t_child(r-&gt;<a class="code" href="structReceptor.html#a7a280e923e97768c67f90303bcf8c152">root</a>,1);</div>
<div class="line">    spec_is_symbol_equal(r,_t_symbol(r-&gt;<a name="a4"></a><a class="code" href="structReceptor.html#a81c4e6049350d0577334fdda48f4260a">structures</a>),STRUCTURES);</div>
<div class="line">    spec_is_ptr_equal(t,r-&gt;<a class="code" href="structReceptor.html#a81c4e6049350d0577334fdda48f4260a">structures</a>);</div>
<div class="line">    t = _t_child(r-&gt;<a class="code" href="structReceptor.html#a7a280e923e97768c67f90303bcf8c152">root</a>,2);</div>
<div class="line">    spec_is_symbol_equal(r,_t_symbol(r-&gt;<a name="a5"></a><a class="code" href="structReceptor.html#aeb5c0f81a92048d264308e7610ac39a3">symbols</a>),SYMBOLS);</div>
<div class="line">    spec_is_ptr_equal(t,r-&gt;<a class="code" href="structReceptor.html#aeb5c0f81a92048d264308e7610ac39a3">symbols</a>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// test that listeners and signals are set up correctly on the default aspect</span></div>
<div class="line">    t = __r_get_listeners(r,DEFAULT_ASPECT);</div>
<div class="line">    spec_is_symbol_equal(r,_t_symbol(t),<a name="a6"></a><a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a897aa439587c20afc15c9cf8a12b0611">LISTENERS</a>);</div>
<div class="line">    t = __r_get_signals(r,DEFAULT_ASPECT);</div>
<div class="line">    spec_is_symbol_equal(r,_t_symbol(t),<a name="a7"></a><a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a1cad60194b57d18e09fff2a1b6c3b192">SIGNALS</a>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// test that the flux is set up correctly</span></div>
<div class="line">    t = _t_child(r-&gt;<a class="code" href="structReceptor.html#a7a280e923e97768c67f90303bcf8c152">root</a>,3);</div>
<div class="line">    spec_is_symbol_equal(r,_t_symbol(r-&gt;<a name="a8"></a><a class="code" href="structReceptor.html#a622c4885a917e9249fa213ccf47b04ff">flux</a>),<a name="a9"></a><a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3aa76c44edb76686fa1bbda9ebe69c7857">FLUX</a>);</div>
<div class="line">    spec_is_ptr_equal(t,r-&gt;<a class="code" href="structReceptor.html#a622c4885a917e9249fa213ccf47b04ff">flux</a>);</div>
<div class="line">    t = _t_child(r-&gt;<a class="code" href="structReceptor.html#a622c4885a917e9249fa213ccf47b04ff">flux</a>,1);</div>
<div class="line">    spec_is_symbol_equal(r,_t_symbol(t),ASPECT);</div>
<div class="line">    spec_is_equal(*(<span class="keywordtype">int</span> *)_t_surface(t),DEFAULT_ASPECT);</div>
<div class="line"></div>
<div class="line">    <a name="a10"></a><a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> testReceptorAddListener() {</div>
<div class="line">    <a class="code" href="structReceptor.html">Receptor</a> *r;</div>
<div class="line">    r = <a class="code" href="group__receptor.html#gaad12918fb4144e557b2ee5e169648c7b">_r_new</a>();</div>
<div class="line"></div>
<div class="line">    <span class="comment">// test that you can add a listener to a receptor&#39;s aspect</span></div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *s = _t_new_root(<a name="a11"></a><a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3af6d94b1598900ddce4908373a5f528e8">EXPECTATION</a>);</div>
<div class="line">    _t_newi(s,<a name="a12"></a><a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a24fed94b1bdcacc4989e256136ad750c">SEMTREX_SYMBOL_LITERAL</a>,0);</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *a = _t_new_root(<a name="a13"></a><a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3ae1bb1460cb779888412e634e983be161">ACTION</a>);</div>
<div class="line">    <a name="a14"></a><a class="code" href="group__receptor.html#gace908c1f9cf6df32014310dca991785b">_r_add_listener</a>(r,DEFAULT_ASPECT,TEST_SYMBOL,s,a);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *l = _t_child(__r_get_listeners(r,DEFAULT_ASPECT),1);      <span class="comment">// listener should have been added as first child of listeners</span></div>
<div class="line">    spec_is_symbol_equal(r,_t_symbol(l),<a name="a15"></a><a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a3bc9f514d1055fbd078bdd7380d3fd90">LISTENER</a>);</div>
<div class="line">    spec_is_equal(*(<span class="keywordtype">int</span> *)_t_surface(l),TEST_SYMBOL); <span class="comment">// carrier should be TEST_SYMBOL</span></div>
<div class="line">    spec_is_ptr_equal(_t_child(l,1),s);       <span class="comment">// our expectation semtrex should be first child of the listener</span></div>
<div class="line">    spec_is_ptr_equal(_t_child(l,2),a);       <span class="comment">// our action code tree should be the second child of the listener</span></div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> testReceptorSignal() {</div>
<div class="line">    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#gaad12918fb4144e557b2ee5e169648c7b">_r_new</a>();</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *signal = _t_newi(0,TEST_SYMBOL,314);</div>
<div class="line">    <a name="a16"></a><a class="code" href="group__receptor.html#gae251d0cfa84e1edbbe12d3489aa29d1e">_r_send</a>(r,r,DEFAULT_ASPECT,signal);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// the first node on the default aspect signals should be the signal</span></div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *s = _t_child(__r_get_signals(r,DEFAULT_ASPECT),1);</div>
<div class="line">    spec_is_symbol_equal(r,_t_symbol(s),<a name="a17"></a><a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a480882f626731b7fa7fc7caf12d8cb66">SIGNAL</a>);</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *t = (<a class="code" href="structTnode.html">Tnode</a> *)_t_surface(s);  <span class="comment">// whose surface should be the contents</span></div>
<div class="line">    spec_is_equal(*(<span class="keywordtype">int</span> *)_t_surface(t),314);</div>
<div class="line">    spec_is_ptr_equal(signal,t);  <span class="comment">// at some point this should probably fail, because we should have cloned the signal, not added it directly</span></div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> testReceptorAction() {</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#gaad12918fb4144e557b2ee5e169648c7b">_r_new</a>();</div>
<div class="line"></div>
<div class="line">    <span class="comment">// The signal is a name with a child that is the first name</span></div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *signal = _t_new_root(TEST_NAME_SYMBOL);</div>
<div class="line">    _t_new(signal,TEST_FIRST_NAME_SYMBOL,<span class="stringliteral">&quot;eric&quot;</span>,5);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// The listener just matches on signal TEST_NAME_TYPE type and responds with</span></div>
<div class="line">    <span class="comment">// converted tree to: /TEST_SYMBOL2/TEST_FIRST_NAME</span></div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *expect = _t_new_root(<a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3af6d94b1598900ddce4908373a5f528e8">EXPECTATION</a>);</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *sa = _t_newi(expect,<a name="a18"></a><a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a9a67b424e6a6adfe23cd3432642109f5">SEMTREX_SYMBOL_ANY</a>,0);</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *sg = _t_newi(sa,<a name="a19"></a><a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a5b54d3166ed65522d1b0b557a91b5316">SEMTREX_GROUP</a>,TEST_FIRST_NAME_SYMBOL);</div>
<div class="line">    _t_newi(sg,<a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a24fed94b1bdcacc4989e256136ad750c">SEMTREX_SYMBOL_LITERAL</a>,TEST_FIRST_NAME_SYMBOL);</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *act = _t_new_root(<a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3ae1bb1460cb779888412e634e983be161">ACTION</a>);</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *resp = _t_newi(act,<a name="a20"></a><a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a64c5ec914c978938d6ed4d420c099c8a">RESPOND</a>,0);</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *n = _t_newi(resp,<a name="a21"></a><a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a32422b0c037a5e196f197711c8d49589">INTERPOLATE_FROM_MATCH</a>,0);</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *t = _t_newi(n,TEST_SYMBOL2,0);</div>
<div class="line">    _t_newi(t,<a name="a22"></a><a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3ae0e51bb381564e3d460f0352172e0c40">INTERPOLATE_SYMBOL</a>,TEST_FIRST_NAME_SYMBOL);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// confirm that the signal will match on our expectation</span></div>
<div class="line">    spec_is_true(<a name="a23"></a><a class="code" href="group__semtrex.html#ga56c55fe5d429521c827cc67000898d0e">_t_match</a>(sa,signal));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__receptor.html#gace908c1f9cf6df32014310dca991785b">_r_add_listener</a>(r,DEFAULT_ASPECT,TEST_NAME_SYMBOL,expect,act);</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *s = <a class="code" href="group__receptor.html#gae251d0cfa84e1edbbe12d3489aa29d1e">_r_send</a>(r,r,DEFAULT_ASPECT,signal);</div>
<div class="line"></div>
<div class="line">    spec_is_symbol_equal(r,_t_symbol(s),<a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a480882f626731b7fa7fc7caf12d8cb66">SIGNAL</a>);</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *result = _t_child(_t_child(s,1),1);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// the result should be signal tree with  the matched TEST_SYMBOL value interpolated</span></div>
<div class="line">    <span class="comment">// in the right place</span></div>
<div class="line">    spec_is_symbol_equal(r,_t_symbol(result),TEST_SYMBOL2);</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *r1 = _t_child(result,1);</div>
<div class="line">    spec_is_symbol_equal(r,_t_symbol(r1),TEST_FIRST_NAME_SYMBOL);</div>
<div class="line">    spec_is_str_equal((<span class="keywordtype">char</span> *)_t_surface(r1),<span class="stringliteral">&quot;eric&quot;</span>);</div>
<div class="line"></div>
<div class="line">    signal = _t_newi(0,TEST_SYMBOL2,3141);</div>
<div class="line">    result = <a class="code" href="group__receptor.html#gae251d0cfa84e1edbbe12d3489aa29d1e">_r_send</a>(r,r,DEFAULT_ASPECT,signal);</div>
<div class="line">    spec_is_ptr_equal(result,NULL);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> testReceptorDef() {</div>
<div class="line">    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#gaad12918fb4144e557b2ee5e169648c7b">_r_new</a>();</div>
<div class="line"></div>
<div class="line">    Symbol lat = _r_def_symbol(r,FLOAT,<span class="stringliteral">&quot;latitude&quot;</span>);</div>
<div class="line">    Symbol lon = _r_def_symbol(r,FLOAT,<span class="stringliteral">&quot;longitude&quot;</span>);</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *def;</div>
<div class="line"></div>
<div class="line">    spec_is_structure_equal(r,__r_get_symbol_structure(r,lat),FLOAT);</div>
<div class="line"></div>
<div class="line">    spec_is_str_equal((<span class="keywordtype">char</span> *)_t_surface(_t_child(def = _t_child(r-&gt;<a class="code" href="structReceptor.html#aeb5c0f81a92048d264308e7610ac39a3">symbols</a>,lat),2)),<span class="stringliteral">&quot;latitude&quot;</span>);</div>
<div class="line">    spec_is_str_equal((<span class="keywordtype">char</span> *)_t_surface(_t_child(_t_child(r-&gt;<a class="code" href="structReceptor.html#aeb5c0f81a92048d264308e7610ac39a3">symbols</a>,lon),2)),<span class="stringliteral">&quot;longitude&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">int</span> *path = labelGet(&amp;r-&gt;<a name="a24"></a><a class="code" href="structReceptor.html#a2f7dc587ff971db209316cde561d0cd0">table</a>,<span class="stringliteral">&quot;latitude&quot;</span>);</div>
<div class="line">    spec_is_ptr_equal(<a name="a25"></a><a class="code" href="group__tree.html#gad25dfd19f7a8ca955f32850fa867be0d">_t_get</a>(r-&gt;<a class="code" href="structReceptor.html#a7a280e923e97768c67f90303bcf8c152">root</a>,path),def);</div>
<div class="line">    spec_is_equal(_r_get_symbol_by_label(r,<span class="stringliteral">&quot;latitude&quot;</span>),lat);</div>
<div class="line"></div>
<div class="line">    Structure latlong = _r_def_structure(r,<span class="stringliteral">&quot;latlong&quot;</span>,2,lat,lon);</div>
<div class="line"></div>
<div class="line">    def = _t_child(r-&gt;<a class="code" href="structReceptor.html#a81c4e6049350d0577334fdda48f4260a">structures</a>,latlong);</div>
<div class="line">    spec_is_str_equal(<span class="stringliteral">&quot;latlong&quot;</span>,(<span class="keywordtype">char</span> *)_t_surface(def));</div>
<div class="line"></div>
<div class="line">    path = labelGet(&amp;r-&gt;<a class="code" href="structReceptor.html#a2f7dc587ff971db209316cde561d0cd0">table</a>,<span class="stringliteral">&quot;latlong&quot;</span>);</div>
<div class="line">    spec_is_ptr_equal(<a class="code" href="group__tree.html#gad25dfd19f7a8ca955f32850fa867be0d">_t_get</a>(r-&gt;<a class="code" href="structReceptor.html#a7a280e923e97768c67f90303bcf8c152">root</a>,path),def);</div>
<div class="line"></div>
<div class="line">    spec_is_structure_equal(r,_r_get_structure_by_label(r,<span class="stringliteral">&quot;latlong&quot;</span>),latlong);</div>
<div class="line">    spec_is_long_equal(__r_get_symbol_size(r,lat,0),<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"></div>
<div class="line">    Symbol house_loc = _r_def_symbol(r,latlong,<span class="stringliteral">&quot;house location&quot;</span>);</div>
<div class="line">    spec_is_equal(__r_get_symbol_structure(r,house_loc),latlong);</div>
<div class="line">    spec_is_long_equal(__r_get_symbol_size(r,house_loc,0),<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*2);</div>
<div class="line"></div>
<div class="line">    Symbol name = _r_def_symbol(r,CSTRING,<span class="stringliteral">&quot;name&quot;</span>);</div>
<div class="line">    spec_is_long_equal(__r_get_symbol_size(r,name,<span class="stringliteral">&quot;zippy&quot;</span>),(<span class="keywordtype">long</span>)6);</div>
<div class="line"></div>
<div class="line">    Structure namedhouse = _r_def_structure(r,<span class="stringliteral">&quot;namedhouse&quot;</span>,2,house_loc,name);</div>
<div class="line"></div>
<div class="line">    Symbol home = _r_def_symbol(r,namedhouse,<span class="stringliteral">&quot;home&quot;</span>);</div>
<div class="line">    <span class="keywordtype">char</span> surface[] ={1,2,3,4,5,6,7,8,<span class="charliteral">&#39;b&#39;</span>,<span class="charliteral">&#39;o&#39;</span>,<span class="charliteral">&#39;b&#39;</span>,<span class="charliteral">&#39;b&#39;</span>,<span class="charliteral">&#39;y&#39;</span>,0};</div>
<div class="line">    spec_is_long_equal(__r_get_symbol_size(r,home,surface),<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*2+6);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> testReceptorDefMatch() {</div>
<div class="line">    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#gaad12918fb4144e557b2ee5e169648c7b">_r_new</a>();</div>
<div class="line">    Symbol lat = _r_def_symbol(r,FLOAT,<span class="stringliteral">&quot;latitude&quot;</span>);</div>
<div class="line">    Symbol lon = _r_def_symbol(r,FLOAT,<span class="stringliteral">&quot;longitude&quot;</span>);</div>
<div class="line">    Structure latlong = _r_def_structure(r,<span class="stringliteral">&quot;latlong&quot;</span>,2,lat,lon);</div>
<div class="line">    Symbol house_loc = _r_def_symbol(r,latlong,<span class="stringliteral">&quot;house location&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *t = _t_new_root(house_loc);</div>
<div class="line">    <span class="keywordtype">float</span> x = 99.0;</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *t_lat = _t_new(t,lat,&amp;x,<span class="keyword">sizeof</span>(x));</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *t_lon = _t_new(t,lon,&amp;x,<span class="keyword">sizeof</span>(x));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *stx = <a name="a26"></a><a class="code" href="group__receptor.html#gad7ed83880a8bb8be0de01ae73b44d13a">_r_build_def_semtrex</a>(r,house_loc,0);</div>
<div class="line">    <span class="keywordtype">char</span> buf[2000];</div>
<div class="line">    spec_is_str_equal(_dump_semtrex(stx,buf),<span class="stringliteral">&quot;/(3/1,2)&quot;</span>);</div>
<div class="line">    __t_dump(r,stx,0,buf);</div>
<div class="line">    spec_is_str_equal(buf,<span class="stringliteral">&quot; (SEMTREX_SYMBOL_LITERAL:house location (SEMTREX_SEQUENCE (SEMTREX_SYMBOL_LITERAL:latitude) (SEMTREX_SYMBOL_LITERAL:longitude)))&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// a correctly structured tree should match its definition</span></div>
<div class="line">    spec_is_true(<a name="a27"></a><a class="code" href="group__receptor.html#ga8978934f20256d927a9f035c2eeafd8d">_r_def_match</a>(r,house_loc,t));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// a correctly structured tree with different semantics shouldn&#39;t match its definition</span></div>
<div class="line">    t_lon-&gt;<a name="a28"></a>contents.<a name="a29"></a>symbol = lat;</div>
<div class="line">    spec_is_true(!<a class="code" href="group__receptor.html#ga8978934f20256d927a9f035c2eeafd8d">_r_def_match</a>(r,house_loc,t));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// an incorrectly structured tree (i.e. missing a child) shouldn&#39;t match its definition</span></div>
<div class="line">    <a name="a30"></a><a class="code" href="group__tree.html#ga302facc6d6e2d4937d560e081c828095">_t_detach_by_idx</a>(t,2);</div>
<div class="line">    spec_is_true(!<a class="code" href="group__receptor.html#ga8978934f20256d927a9f035c2eeafd8d">_r_def_match</a>(r,house_loc,t));</div>
<div class="line"></div>
<div class="line">    <a name="a31"></a><a class="code" href="group__tree.html#gac9311eb831d86ab8395f9c1c81f584d9">_t_free</a>(stx);</div>
<div class="line">    <a class="code" href="group__tree.html#gac9311eb831d86ab8395f9c1c81f584d9">_t_free</a>(t);</div>
<div class="line">    <a class="code" href="group__tree.html#gac9311eb831d86ab8395f9c1c81f584d9">_t_free</a>(t_lon);</div>
<div class="line">    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> testReceptorInstances() {</div>
<div class="line">    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#gaad12918fb4144e557b2ee5e169648c7b">_r_new</a>();</div>
<div class="line">    Symbol lat = _r_def_symbol(r,FLOAT,<span class="stringliteral">&quot;latitude&quot;</span>);</div>
<div class="line">    Symbol lon = _r_def_symbol(r,FLOAT,<span class="stringliteral">&quot;longitude&quot;</span>);</div>
<div class="line">    Structure latlong = _r_def_structure(r,<span class="stringliteral">&quot;latlong&quot;</span>,2,lat,lon);</div>
<div class="line">    Symbol house_loc = _r_def_symbol(r,latlong,<span class="stringliteral">&quot;house location&quot;</span>);</div>
<div class="line">    <span class="keywordtype">float</span> ll[] = {132.5,92.3};</div>
<div class="line">    <a name="_a32"></a><a class="code" href="structXaddr.html">Xaddr</a> x = <a name="a33"></a><a class="code" href="group__receptor.html#ga7518a44dda01af81556bb6657f18ead4">_r_new_instance</a>(r,house_loc,ll);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">float</span> *ill;</div>
<div class="line">    <a name="_a34"></a><a class="code" href="structInstance.html">Instance</a> i = <a name="a35"></a><a class="code" href="group__receptor.html#gae5861d52f36fafa1f5d5a4ba1268ce1b">_r_get_instance</a>(r,x);</div>
<div class="line">    ill = (<span class="keywordtype">float</span> *)i.<a name="a36"></a>surface;</div>
<div class="line"></div>
<div class="line">    spec_is_float_equal(ill[0],ll[0]);</div>
<div class="line">    spec_is_float_equal(ill[1],ll[1]);</div>
<div class="line">    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> testReceptorSerialize() {</div>
<div class="line">    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#gaad12918fb4144e557b2ee5e169648c7b">_r_new</a>();</div>
<div class="line">    Symbol lat = _r_def_symbol(r,FLOAT,<span class="stringliteral">&quot;latitude&quot;</span>);</div>
<div class="line">    Symbol lon = _r_def_symbol(r,FLOAT,<span class="stringliteral">&quot;longitude&quot;</span>);</div>
<div class="line">    Structure latlong = _r_def_structure(r,<span class="stringliteral">&quot;latlong&quot;</span>,2,lat,lon);</div>
<div class="line">    Symbol house_loc = _r_def_symbol(r,latlong,<span class="stringliteral">&quot;house location&quot;</span>);</div>
<div class="line">    <span class="keywordtype">float</span> ll[] = {132.5,92.3};</div>
<div class="line">    <a class="code" href="structXaddr.html">Xaddr</a> x = <a class="code" href="group__receptor.html#ga7518a44dda01af81556bb6657f18ead4">_r_new_instance</a>(r,house_loc,ll);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">void</span> *surface;</div>
<div class="line">    <span class="keywordtype">size_t</span> length;</div>
<div class="line">    <span class="keywordtype">char</span> buf[2000];</div>
<div class="line">    <span class="keywordtype">char</span> buf1[2000];</div>
<div class="line"></div>
<div class="line">    <a name="a37"></a><a class="code" href="group__receptor.html#ga3e737841784555574a0d90ad2eff4cc4">_r_serialize</a>(r,&amp;surface,&amp;length);</div>
<div class="line"></div>
<div class="line">    spec_is_long_equal(length,(<span class="keywordtype">long</span>)242);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structReceptor.html">Receptor</a> *r1 = _r_unserialize(surface,length);</div>
<div class="line"></div>
<div class="line">    __t_dump(r,r-&gt;<a class="code" href="structReceptor.html#a7a280e923e97768c67f90303bcf8c152">root</a>,0,buf);</div>
<div class="line">    __t_dump(r1,r1-&gt;<a class="code" href="structReceptor.html#a7a280e923e97768c67f90303bcf8c152">root</a>,0,buf1);</div>
<div class="line"></div>
<div class="line">    <span class="comment">//    puts(_td(r,r1-&gt;root));</span></div>
<div class="line">    spec_is_str_equal(buf1,buf);</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">int</span> *path = labelGet(&amp;r1-&gt;<a class="code" href="structReceptor.html#a2f7dc587ff971db209316cde561d0cd0">table</a>,<span class="stringliteral">&quot;latitude&quot;</span>);</div>
<div class="line">    <span class="keywordtype">int</span> p[] = {2,1,TREE_PATH_TERMINATOR};</div>
<div class="line">    spec_is_path_equal(path,p);</div>
<div class="line">    spec_is_equal(_r_get_symbol_by_label(r1,<span class="stringliteral">&quot;latitude&quot;</span>),lat);</div>
<div class="line">    spec_is_equal(_r_get_structure_by_label(r1,<span class="stringliteral">&quot;latlong&quot;</span>),latlong);</div>
<div class="line"></div>
<div class="line">    free(surface);</div>
<div class="line">    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r);</div>
<div class="line">    <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(r1);</div>
<div class="line"></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> testSemtrexDump() {</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *s = _makeTestSemtrex1();</div>
<div class="line">    <span class="keywordtype">char</span> buf[2000];</div>
<div class="line">    spec_is_str_equal(_dump_semtrex(s,buf),<span class="stringliteral">&quot;/(TEST_STR_SYMBOL/(1/(11/111)),2,3)&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__tree.html#gac9311eb831d86ab8395f9c1c81f584d9">_t_free</a>(s);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// /TEST_STR_SYMBOL/{.*,{.}},4  &lt;- a more complicated group semtrex</span></div>
<div class="line">    s = _t_newi(0,<a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a24fed94b1bdcacc4989e256136ad750c">SEMTREX_SYMBOL_LITERAL</a>,TEST_STR_SYMBOL);</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *ss = _t_newi(s,<a name="a38"></a><a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a2bcf9a9f55a6002b167918d9657788b7">SEMTREX_SEQUENCE</a>,0);</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *sg = _t_newi(ss,<a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a5b54d3166ed65522d1b0b557a91b5316">SEMTREX_GROUP</a>,TEST_GROUP_SYMBOL1);</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *ss2 = _t_newi(sg,<a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a2bcf9a9f55a6002b167918d9657788b7">SEMTREX_SEQUENCE</a>,0);</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *st = _t_newi(ss2,<a name="a39"></a><a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a388806ffbf23acd9f4d947dcb0de01b2">SEMTREX_ZERO_OR_MORE</a>,0);</div>
<div class="line">    _t_newi(st,<a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a9a67b424e6a6adfe23cd3432642109f5">SEMTREX_SYMBOL_ANY</a>,0);</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *sg2 = _t_newi(ss2,<a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a5b54d3166ed65522d1b0b557a91b5316">SEMTREX_GROUP</a>,TEST_GROUP_SYMBOL2);</div>
<div class="line">    _t_newi(sg2,<a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a9a67b424e6a6adfe23cd3432642109f5">SEMTREX_SYMBOL_ANY</a>,0);</div>
<div class="line">    <a class="code" href="structTnode.html">Tnode</a> *s3 = _t_newi(ss,<a class="code" href="symbol_8h.html#ab0f6206b340472c7ace01d1e9d4b87f3a24fed94b1bdcacc4989e256136ad750c">SEMTREX_SYMBOL_LITERAL</a>,4);</div>
<div class="line">    spec_is_str_equal(_dump_semtrex(s,buf),<span class="stringliteral">&quot;/(TEST_STR_SYMBOL/{.*,{.}},4)&quot;</span>);</div>
<div class="line">    <a class="code" href="group__tree.html#gac9311eb831d86ab8395f9c1c81f584d9">_t_free</a>(s);</div>
<div class="line"></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> testReceptor() {</div>
<div class="line">    testReceptorCreate();</div>
<div class="line">    testReceptorAddListener();</div>
<div class="line">    testReceptorSignal();</div>
<div class="line">    testReceptorAction();</div>
<div class="line">    testReceptorDef();</div>
<div class="line">    testReceptorDefMatch();</div>
<div class="line">    testReceptorInstances();</div>
<div class="line">    testReceptorSerialize();</div>
<div class="line">    testSemtrexDump();</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Aug 26 2014 13:30:49 for ceptr by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
