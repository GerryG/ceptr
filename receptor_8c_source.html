<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>ceptr: src/receptor.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ceptr
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('receptor_8c_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">receptor.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="receptor_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="receptor_8h.html">receptor.h</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="stream_8h.html">stream.h</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="semtrex_8h.html">semtrex.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="process_8h.html">process.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="accumulator_8h.html">accumulator.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="debug_8h.html">debug.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mtree_8h.html">mtree.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;stdarg.h&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;time.h&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<a class="code" href="structXaddr.html">Xaddr</a> G_null_xaddr  = {0,0};</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">/*****************  create and destroy receptors */</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">/* set up the c structures for a receptor from a semantic tree */</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<a class="code" href="structReceptor.html">Receptor</a> * __r_init(<a class="code" href="structT.html">T</a> *t,<a class="code" href="structSemTable.html">SemTable</a> *sem) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = malloc(<span class="keyword">sizeof</span>(<a class="code" href="structReceptor.html">Receptor</a>));</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    r-&gt;<a class="code" href="structReceptor.html#aec6f1eee133a993b59baf50e75620fb6">root</a> = t;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    r-&gt;<a class="code" href="structReceptor.html#ab5037726ba2360fe29cc238ab1d98e94">parent</a> = *(<span class="keywordtype">int</span> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(t,ReceptorInstanceParentContextIdx));</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    r-&gt;<a class="code" href="structReceptor.html#ae57114199054b577820844eaff7593dd">context</a> = *(<span class="keywordtype">int</span> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(t,ReceptorInstanceContextNumIdx));</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    r-&gt;<a class="code" href="structReceptor.html#afeea3c89b6853516cd4c4d8e9d885174">addr</a>.addr = r-&gt;<a class="code" href="structReceptor.html#ae57114199054b577820844eaff7593dd">context</a>;  <span class="comment">//@fixme!! for now these are the same, but this needs to get fixed</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a> = sem;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    r-&gt;<a class="code" href="structReceptor.html#a6150c6bff7a9724b4dd436a75fe4cc4b">instances</a> = NULL;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a> = <a class="code" href="process_8c.html#ab687631a788dd02e54df41041ed55f1c">_p_newq</a>(r);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    r-&gt;<a class="code" href="structReceptor.html#a877d31e0f4bd35d7c4a598c6e0416dd5">state</a> = Alive;  <span class="comment">//@todo, check if this is true on unserialize</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="structT.html">T</a> *state = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(t,ReceptorInstanceStateIdx);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    r-&gt;<a class="code" href="structReceptor.html#af8aee3ef6d1d93b80427faa57e6f1468">flux</a> = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(state,ReceptorFluxIdx);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    r-&gt;pending_signals = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(state,ReceptorPendingSignalsIdx);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    r-&gt;pending_responses = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(state,ReceptorPendingResponsesIdx);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;}</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<a class="code" href="structT.html">T</a> *_r_make_state() {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="structT.html">T</a> *t = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(RECEPTOR_STATE);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="structT.html">T</a> *f = <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(t,FLUX);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="structT.html">T</a> *a = <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(f,DEFAULT_ASPECT);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(a,EXPECTATIONS);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(a,SIGNALS);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(t,PENDING_SIGNALS);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(t,PENDING_RESPONSES);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    _t_newi(t,RECEPTOR_ELAPSED_TIME,0);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">return</span> t;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//helper to make empty definitions tree</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<a class="code" href="structT.html">T</a> *__r_make_definitions() {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="structT.html">T</a> *defs = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(DEFINITIONS);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(defs,STRUCTURES);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(defs,SYMBOLS);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(defs,PROCESSES);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(defs,RECEPTORS);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(defs,PROTOCOLS);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(defs,SCAPES);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">return</span> defs;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">   79</a></span>&#160;<a class="code" href="structReceptor.html">Receptor</a> *<a class="code" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a>(<a class="code" href="structSemTable.html">SemTable</a> *sem,<a class="code" href="structSemanticID.html">SemanticID</a> r) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="structT.html">T</a> *t = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(RECEPTOR_INSTANCE);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> (semeq(r,SYS_RECEPTOR)) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        _t_newi(t,CONTEXT_NUM,0);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        _t_newi(t,PARENT_CONTEXT_NUM,-1);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        _t_newi(t,CONTEXT_NUM,_d_get_receptor_context(sem,r));</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        _t_newi(t,PARENT_CONTEXT_NUM,r.context);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="structT.html">T</a> *state = _r_make_state();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a>(t,state);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">return</span> __r_init(t,sem);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="group__receptor.html#ga8bee7d388b8fde389b0667bf57684ba0">  104</a></span>&#160;<a class="code" href="structReceptor.html">Receptor</a> *<a class="code" href="group__receptor.html#ga8bee7d388b8fde389b0667bf57684ba0">_r_new_receptor_from_package</a>(<a class="code" href="structSemTable.html">SemTable</a> *sem,<a class="code" href="structSemanticID.html">Symbol</a> s,<a class="code" href="structT.html">T</a> *p,<a class="code" href="structT.html">T</a> *bindings) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="structT.html">T</a> *defs = <a class="code" href="group__tree.html#ga7535eb2963c6cf5fc78cb14287581f92">_t_clone</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(p,3));</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">//    T *aspects = _t_clone(_t_child(p,4));  @todo this should be inside the defs allready</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    raise_error(<span class="stringliteral">&quot;fix receptor address&quot;</span>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a>(sem,s);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">//@todo fix this because it relies on SemanticTypes value matching the index order in the definitions.</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">//    DO_KIDS(defs,__r_set_labels(r,_t_child(defs,i),i));</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;}</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">// helper to build and expectation tree</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<a class="code" href="structT.html">T</a> *__r_build_expectation(<a class="code" href="structSemanticID.html">Symbol</a> carrier,<a class="code" href="structT.html">T</a> *pattern,<a class="code" href="structT.html">T</a> *action,<a class="code" href="structT.html">T</a> *with,<a class="code" href="structT.html">T</a> *until) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="structT.html">T</a> *e = <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(0,EXPECTATION);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    _t_news(e,CARRIER,carrier);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a>(e,pattern);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a>(e,action);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">if</span> (!with) with = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(PARAMS);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a>(e,with);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">if</span> (!until) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        until = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(END_CONDITIONS);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(until,UNLIMITED);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a>(e,until);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">return</span> e;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="group__receptor.html#gac391ad8fbd0bb7ca9382e9ab0018edcf">  144</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__receptor.html#gac391ad8fbd0bb7ca9382e9ab0018edcf">_r_add_expectation</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structSemanticID.html">Aspect</a> aspect,<a class="code" href="structSemanticID.html">Symbol</a> carrier,<a class="code" href="structT.html">T</a> *pattern,<a class="code" href="structT.html">T</a> *action,<a class="code" href="structT.html">T</a> *with,<a class="code" href="structT.html">T</a> *until) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="structT.html">T</a> *e = __r_build_expectation(carrier,pattern,action,with,until);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    __r_add_expectation(r,aspect,e);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keywordtype">void</span> __r_add_expectation(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structSemanticID.html">Aspect</a> aspect,<a class="code" href="structT.html">T</a> *e) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="structT.html">T</a> *a = __r_get_expectations(r,aspect);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a>(a,e);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keywordtype">void</span> _r_remove_expectation(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structT.html">T</a> *expectation) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="structT.html">T</a> *a = <a class="code" href="group__tree.html#ga18ca0b633cdd6b8f2d3d0f2598c4a933">_t_parent</a>(expectation);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="group__tree.html#gad718449607421d4b572315be630cbf75">_t_detach_by_ptr</a>(a,expectation);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(expectation);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// @todo, if there are any processes blocked on this expectation they</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">// should actually get cleaned up somehow.  This would mean searching</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// through for them, or something...</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;}</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">  166</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a>(<a class="code" href="structReceptor.html">Receptor</a> *r) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(r-&gt;<a class="code" href="structReceptor.html#aec6f1eee133a993b59baf50e75620fb6">root</a>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    _a_free_instances(&amp;r-&gt;<a class="code" href="structReceptor.html#a6150c6bff7a9724b4dd436a75fe4cc4b">instances</a>);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">if</span> (r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>) <a class="code" href="process_8c.html#aea59e125f10441efe75f6047ee7b35e1">_p_freeq</a>(r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    free(r);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;}</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">/*****************  receptor symbols, structures and processes */</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="group__receptor.html#ga29fd5ebc5d1c142a7da96bd0dd36292c">  184</a></span>&#160;<a class="code" href="structSemanticID.html">Symbol</a> <a class="code" href="group__receptor.html#ga29fd5ebc5d1c142a7da96bd0dd36292c">_r_define_symbol</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structSemanticID.html">Structure</a> s,<span class="keywordtype">char</span> *label){</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="structSemanticID.html">Symbol</a> sym = <a class="code" href="group__def.html#ga3f075d8ef101d4a88a6668f01cf44080">_d_define_symbol</a>(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,s,label,r-&gt;<a class="code" href="structReceptor.html#ae57114199054b577820844eaff7593dd">context</a>);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">return</span> sym;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="group__receptor.html#gae291bec8771c13074164984b08db4874">  202</a></span>&#160;<a class="code" href="structSemanticID.html">Structure</a> <a class="code" href="group__receptor.html#gae291bec8771c13074164984b08db4874">_r_define_structure</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<span class="keywordtype">char</span> *label,<span class="keywordtype">int</span> num_params,...) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    va_list params;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    va_start(params,num_params);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="structT.html">T</a> *def = _d_make_vstruc_def(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,label,num_params,params);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    va_end(params);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="structSemanticID.html">Structure</a> s = <a class="code" href="group__def.html#gaa07e8bdb0806d0e55d0f892c791def0d">_d_define_structure</a>(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,label,def,r-&gt;<a class="code" href="structReceptor.html#ae57114199054b577820844eaff7593dd">context</a>);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">return</span> s;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="group__receptor.html#ga9a017ac5e8250b6143719abe815be93a">  224</a></span>&#160;<a class="code" href="structSemanticID.html">Structure</a> <a class="code" href="group__receptor.html#ga9a017ac5e8250b6143719abe815be93a">__r_define_structure</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<span class="keywordtype">char</span> *label,<a class="code" href="structT.html">T</a> *structure_def) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="structSemanticID.html">Structure</a> s = <a class="code" href="group__def.html#gaa07e8bdb0806d0e55d0f892c791def0d">_d_define_structure</a>(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,label,structure_def,r-&gt;<a class="code" href="structReceptor.html#ae57114199054b577820844eaff7593dd">context</a>);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">return</span> s;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="group__receptor.html#ga9e248fdb6e6d814935ac88e67e10e769">  241</a></span>&#160;<a class="code" href="structSemanticID.html">Process</a> <a class="code" href="group__receptor.html#ga9e248fdb6e6d814935ac88e67e10e769">_r_define_process</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structT.html">T</a> *code,<span class="keywordtype">char</span> *name,<span class="keywordtype">char</span> *intention,<a class="code" href="structT.html">T</a> *signature) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <a class="code" href="structSemanticID.html">Process</a> p = <a class="code" href="group__def.html#gaee8a21fdd29944bf44bb03457511515d">_d_define_process</a>(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,code,name,intention,signature,r-&gt;<a class="code" href="structReceptor.html#ae57114199054b577820844eaff7593dd">context</a>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">return</span> p;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;}</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<a class="code" href="structSemanticID.html">Protocol</a> _r_define_protocol(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structT.html">T</a> *protocol_def) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="structSemanticID.html">Protocol</a> p = <a class="code" href="group__def.html#gad328204a09fa7f68a65080044a9b5109">_d_define_protocol</a>(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,protocol_def,r-&gt;<a class="code" href="structReceptor.html#ae57114199054b577820844eaff7593dd">context</a>);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">return</span> p;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;}</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="group__receptor.html#ga2b16e941a406a95aba1c8db047d00041">  254</a></span>&#160;<a class="code" href="structSemanticID.html">Symbol</a> <a class="code" href="group__receptor.html#ga2b16e941a406a95aba1c8db047d00041">_r_get_sem_by_label</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<span class="keywordtype">char</span> *label) {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">return</span> _sem_get_by_label(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,label,r-&gt;<a class="code" href="structReceptor.html#ae57114199054b577820844eaff7593dd">context</a>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;}</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="group__receptor.html#ga120e66982d483fbe004fd969cf1c353f">  262</a></span>&#160;<a class="code" href="structSemanticID.html">Structure</a> <a class="code" href="group__receptor.html#ga120e66982d483fbe004fd969cf1c353f">__r_get_symbol_structure</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structSemanticID.html">Symbol</a> s){</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">return</span> _sem_get_symbol_structure(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,s);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;}</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="receptor_8c.html#a6784a7133ab6bc8c6a105fead8843c86">  270</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="receptor_8c.html#a6784a7133ab6bc8c6a105fead8843c86">__r_get_structure_size</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structSemanticID.html">Structure</a> s,<span class="keywordtype">void</span> *surface) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__def.html#gaf51869e61eb84e17986d26da65205eaf">_d_get_structure_size</a>(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,s,surface);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;}</div>
<div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="group__receptor.html#gad886d976f8621ebb22d02c61f454265c">  277</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="group__receptor.html#gad886d976f8621ebb22d02c61f454265c">__r_get_symbol_size</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structSemanticID.html">Symbol</a> s,<span class="keywordtype">void</span> *surface) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__def.html#ga63d387c448c4ab2f9acbf7010e45664d">_d_get_symbol_size</a>(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,s,surface);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;}</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="group__receptor.html#ga63078117d8c6850455a4419fd9b6b784">  288</a></span>&#160;<a class="code" href="structT.html">T</a> * <a class="code" href="group__receptor.html#ga63078117d8c6850455a4419fd9b6b784">_r_build_def_semtrex</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structSemanticID.html">Symbol</a> s) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__def.html#ga15d66273ad66f17580a90a30c90b8f07">_d_build_def_semtrex</a>(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,s,0);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;}</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="group__receptor.html#gaa8c97a2acf18af02e4e582d15932640c">  306</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__receptor.html#gaa8c97a2acf18af02e4e582d15932640c">_r_def_match</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structSemanticID.html">Symbol</a> s,<a class="code" href="structT.html">T</a> *t) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="structT.html">T</a> *stx = <a class="code" href="group__receptor.html#ga63078117d8c6850455a4419fd9b6b784">_r_build_def_semtrex</a>(r,s);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordtype">int</span> result = <a class="code" href="group__semtrex.html#ga8e580d7393964e5df55e92aebf587e3f">_t_match</a>(stx,t);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(stx);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;}</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">/*****************  receptor instances and xaddrs */</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="group__receptor.html#gadd08a3c284251a2ec7e03b8f91eddc5c">  328</a></span>&#160;<a class="code" href="structXaddr.html">Xaddr</a> <a class="code" href="group__receptor.html#gadd08a3c284251a2ec7e03b8f91eddc5c">_r_new_instance</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structT.html">T</a> *t) {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">return</span> _a_new_instance(&amp;r-&gt;<a class="code" href="structReceptor.html#a6150c6bff7a9724b4dd436a75fe4cc4b">instances</a>,t);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;}</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno"><a class="line" href="group__receptor.html#gadc618904f81240b244e816234d1c906e">  342</a></span>&#160;<a class="code" href="structT.html">T</a> * <a class="code" href="group__receptor.html#gadc618904f81240b244e816234d1c906e">_r_get_instance</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structXaddr.html">Xaddr</a> x) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">return</span> _a_get_instance(&amp;r-&gt;<a class="code" href="structReceptor.html#a6150c6bff7a9724b4dd436a75fe4cc4b">instances</a>,x);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;}</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="group__receptor.html#ga28899931aa49371ed6eb6c69b123b5f6">  357</a></span>&#160;<a class="code" href="structT.html">T</a> * <a class="code" href="group__receptor.html#ga28899931aa49371ed6eb6c69b123b5f6">_r_set_instance</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structXaddr.html">Xaddr</a> x,<a class="code" href="structT.html">T</a> *t) {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">return</span> _a_set_instance(&amp;r-&gt;<a class="code" href="structReceptor.html#a6150c6bff7a9724b4dd436a75fe4cc4b">instances</a>,x,t);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div>
<div class="line"><a name="l00364"></a><span class="lineno"><a class="line" href="group__receptor.html#ga1570f1fca510bdaf19d044592ee035ce">  364</a></span>&#160;TreeHash <a class="code" href="group__receptor.html#ga1570f1fca510bdaf19d044592ee035ce">_r_hash</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structXaddr.html">Xaddr</a> t) {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__tree.html#gaceb68b489c4362a94aafa5b71c38d1ee">_t_hash</a>(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,<a class="code" href="group__receptor.html#gadc618904f81240b244e816234d1c906e">_r_get_instance</a>(r,t));</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">/******************  receptor serialization */</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="group__receptor.html#ga3e737841784555574a0d90ad2eff4cc4">  382</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__receptor.html#ga3e737841784555574a0d90ad2eff4cc4">_r_serialize</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<span class="keywordtype">void</span> **surfaceP,<span class="keywordtype">size_t</span> *lengthP) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">/* size_t buf_size = 10000; */</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">/* *surfaceP  = malloc(buf_size); */</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">/* *lengthP = __t_serialize(&amp;r-&gt;defs,r-&gt;root,surfaceP,sizeof(size_t),buf_size,0); */</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">/* *(size_t *)(*surfaceP) = *lengthP; */</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <a class="code" href="structH.html">H</a> h = <a class="code" href="mtree_8c.html#a0c5bd733621f48184a13a1202bd24fed">_m_new_from_t</a>(r-&gt;<a class="code" href="structReceptor.html#aec6f1eee133a993b59baf50e75620fb6">root</a>);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <a class="code" href="structS.html">S</a> *s = <a class="code" href="mtree_8c.html#a27481040e0d545565d203c0f37b30d79">_m_serialize</a>(h.m);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <a class="code" href="structS.html">S</a> *is = __a_serialize_instances(&amp;r-&gt;<a class="code" href="structReceptor.html#a6150c6bff7a9724b4dd436a75fe4cc4b">instances</a>);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    s = (<a class="code" href="structS.html">S</a> *)realloc(s,s-&gt;total_size+is-&gt;total_size);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    memcpy(((<span class="keywordtype">void</span> *)s)+s-&gt;total_size,is,is-&gt;total_size);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    *lengthP = s-&gt;total_size+is-&gt;total_size;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    *surfaceP = (<span class="keywordtype">void</span> *)s;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    free(is);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    _m_free(h);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;}</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno"><a class="line" href="group__receptor.html#ga63e9fb219f66164df22ffb5356b218b2">  409</a></span>&#160;<a class="code" href="structReceptor.html">Receptor</a> * <a class="code" href="group__receptor.html#ga63e9fb219f66164df22ffb5356b218b2">_r_unserialize</a>(<a class="code" href="structSemTable.html">SemTable</a> *sem,<span class="keywordtype">void</span> *surface) {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="structS.html">S</a> *s = (<a class="code" href="structS.html">S</a> *)surface;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="structH.html">H</a> h = <a class="code" href="mtree_8c.html#a641f65780358ce0f40479d6ccaba1735">_m_unserialize</a>(s);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <a class="code" href="structT.html">T</a> *t = <a class="code" href="mtree_8c.html#ab0e6e5f78e7ec6f3c9165feca0eae093">_t_new_from_m</a>(h);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    _m_free(h);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = __r_init(t,sem);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">/* size_t length = *(size_t *)surface; */</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">/* Receptor *r = _r_new(*(Symbol *)(surface+sizeof(size_t))); */</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">/* surface += sizeof(size_t); */</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">/* T *t =  _t_unserialize(&amp;r-&gt;defs,&amp;surface,&amp;length,0); */</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">/* _t_free(r-&gt;root); */</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">/* r-&gt;root = t; */</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">//    T *defs = _t_child(t,1);</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">//  DO_KIDS(defs,__r_set_labels(r,_t_child(defs,i),i));</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">// move to the instances</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    s = (<a class="code" href="structS.html">S</a> *) (surface + s-&gt;total_size);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    __a_unserialize_instances(sem,&amp;r-&gt;<a class="code" href="structReceptor.html#a6150c6bff7a9724b4dd436a75fe4cc4b">instances</a>,(<a class="code" href="structS.html">S</a> *)s);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;}</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">/******************  receptor signaling */</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">// build a receptor address.  This is scaffolding for later receptor</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">// addressing that will include both ceptrnet addresses and receptor paths</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">// as a possible options for addressing the receptor.</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<a class="code" href="structT.html">T</a> *__r_make_addr(<a class="code" href="structT.html">T</a> *parent,<a class="code" href="structSemanticID.html">Symbol</a> type,<a class="code" href="structReceptorAddress.html">ReceptorAddress</a> addr) {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="structT.html">T</a> *a = <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(parent,type);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    _t_newi(a,RECEPTOR_ADDR,addr.addr);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">return</span> a;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;}</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<a class="code" href="structReceptorAddress.html">ReceptorAddress</a> __r_get_addr(<a class="code" href="structT.html">T</a> *addr) {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">// for now they are all instance nums so we can just get the surface</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">// of the first child.</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="structT.html">T</a> *t = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(addr,1);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">return</span> *(<a class="code" href="structReceptorAddress.html">ReceptorAddress</a> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(t);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="group__receptor.html#ga893186e8d759e9aa1f14d932900e8046">  461</a></span>&#160;<a class="code" href="structT.html">T</a>* <a class="code" href="group__receptor.html#ga893186e8d759e9aa1f14d932900e8046">__r_make_signal</a>(<a class="code" href="structReceptorAddress.html">ReceptorAddress</a> from,<a class="code" href="structReceptorAddress.html">ReceptorAddress</a> to,<a class="code" href="structSemanticID.html">Aspect</a> aspect,<a class="code" href="structSemanticID.html">Symbol</a> carrier,<a class="code" href="structT.html">T</a> *signal_contents,<a class="code" href="structUUIDt.html">UUIDt</a> *in_response_to,<a class="code" href="structT.html">T</a>* until) {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="structT.html">T</a> *s = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(SIGNAL);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="structT.html">T</a> *e = <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(s,ENVELOPE);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">// @todo convert to paths at some point?</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    __r_make_addr(e,FROM_ADDRESS,from);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    __r_make_addr(e,TO_ADDRESS,to);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    _t_news(e,ASPECT_IDENT,aspect);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    _t_news(e,CARRIER,carrier);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <a class="code" href="structUUIDt.html">UUIDt</a> t = __uuid_gen();</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    _t_new(e,SIGNAL_UUID,&amp;t,<span class="keyword">sizeof</span>(<a class="code" href="structUUIDt.html">UUIDt</a>));</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="structT.html">T</a> *b = <a class="code" href="group__tree.html#ga79cff1b1b9d692acc297634be059c6a9">_t_newt</a>(s,BODY,signal_contents);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">if</span> (in_response_to &amp;&amp; until) raise_error(<span class="stringliteral">&quot;attempt to make signal with both response_uuid and until&quot;</span>);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">if</span> (in_response_to)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        _t_new(e,IN_RESPONSE_TO_UUID,in_response_to,<span class="keyword">sizeof</span>(<a class="code" href="structUUIDt.html">UUIDt</a>));</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (until)</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <a class="code" href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a>(e,until);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">return</span> s;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;}</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">// create WAKEUP_REFERENCE symbol used for unblocking a process</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<a class="code" href="structT.html">T</a>* __r_build_wakeup_info(<a class="code" href="structT.html">T</a> *code_point,<span class="keywordtype">int</span> process_id) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="structT.html">T</a> *wakeup = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(WAKEUP_REFERENCE);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    _t_newi(wakeup,PROCESS_IDENT,process_id);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordtype">int</span> *path = <a class="code" href="group__tree.html#gae4c9b743462f0a3808c9f02c3bf33da8">_t_get_path</a>(code_point);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    _t_new(wakeup,CODE_PATH,path,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*(<a class="code" href="group__tree.html#ga55270b512ed52ffe5a938a793fa5cd7f">_t_path_depth</a>(path)+1));</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    free(path);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">return</span> wakeup;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;}</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">// low level send, must be called with pending_signals resource locked!!</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<a class="code" href="structT.html">T</a>* __r_send(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structT.html">T</a> *signal) {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a>(r-&gt;pending_signals,signal);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">//@todo for now we return the UUID of the signal as the result.  Perhaps later we return an error condition if delivery to address is known to be impossible, or something like that.</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="structT.html">T</a> *envelope = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(signal,SignalEnvelopeIdx);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">return</span> _t_rclone(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(envelope,EnvelopeUUIDIdx));</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;}</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div>
<div class="line"><a name="l00507"></a><span class="lineno"><a class="line" href="group__receptor.html#gaa9abda6d1e05a6b498580619d216efe9">  507</a></span>&#160;<a class="code" href="structT.html">T</a>* <a class="code" href="group__receptor.html#gaa9abda6d1e05a6b498580619d216efe9">_r_send</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structT.html">T</a> *signal) {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    debug(D_SIGNALS,<span class="stringliteral">&quot;sending %s\n&quot;</span>,_t2s(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,signal));</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">//@todo lock resources</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <a class="code" href="structT.html">T</a> *result =__r_send(r,signal);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">//@todo unlock resources</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;}</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div>
<div class="line"><a name="l00526"></a><span class="lineno"><a class="line" href="group__receptor.html#ga560777ec3ceabeb53f89e3da8612a634">  526</a></span>&#160;<a class="code" href="structT.html">T</a>* <a class="code" href="group__receptor.html#ga560777ec3ceabeb53f89e3da8612a634">_r_request</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structT.html">T</a> *signal,<a class="code" href="structSemanticID.html">Symbol</a> response_carrier,<a class="code" href="structT.html">T</a> *code_point,<span class="keywordtype">int</span> process_id) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">//@todo lock resources</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <a class="code" href="structT.html">T</a> *result = __r_send(r,signal);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <a class="code" href="structT.html">T</a> *pr = <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(r-&gt;pending_responses,PENDING_RESPONSE);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <a class="code" href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a>(pr,<a class="code" href="group__tree.html#ga7535eb2963c6cf5fc78cb14287581f92">_t_clone</a>(result));</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    _t_news(pr,CARRIER,response_carrier);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <a class="code" href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a>(pr,__r_build_wakeup_info(code_point,process_id));</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordtype">int</span> p[] = {SignalEnvelopeIdx,EnvelopeExtraIdx,TREE_PATH_TERMINATOR};</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <a class="code" href="structT.html">T</a> *ec = <a class="code" href="group__tree.html#gaf019d190c9623de809d006e309a441af">_t_get</a>(signal,p);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">if</span> (!ec || !semeq(<a class="code" href="group__tree.html#ga946600fb570f0cc913450905f6189d49">_t_symbol</a>(ec),END_CONDITIONS)) raise_error(<span class="stringliteral">&quot;request missing END_CONDITIONS&quot;</span>);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <a class="code" href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a>(pr,<a class="code" href="group__tree.html#ga7535eb2963c6cf5fc78cb14287581f92">_t_clone</a>(ec));</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    debug(D_SIGNALS,<span class="stringliteral">&quot;sending request and adding pending response: %s\n&quot;</span>,_td(r,pr));</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">//@todo unlock resources</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;}</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">// check if the end condition has been met</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="keywordtype">void</span> evaluateEndCondition(<a class="code" href="structT.html">T</a> *ec,<span class="keywordtype">bool</span> *cleanup,<span class="keywordtype">bool</span> *allow) {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    *cleanup = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    *allow = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordtype">int</span> k = <a class="code" href="group__tree.html#ga4b1df42f7a8edbe3a6192d64ab027ecc">_t_children</a>(ec);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">while</span> (k) {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <a class="code" href="structT.html">T</a> *c = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(ec,k);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <a class="code" href="structSemanticID.html">Symbol</a> sym = <a class="code" href="group__tree.html#ga946600fb570f0cc913450905f6189d49">_t_symbol</a>(c);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordflow">if</span> (semeq(sym,COUNT)) {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            <span class="comment">//@todo mutex!!</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            <span class="keywordtype">int</span> *cP = (<span class="keywordtype">int</span> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(c);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            <span class="keywordflow">if</span> (*cP &lt;= 1) *cleanup = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            <span class="keywordflow">if</span> (*cP &gt;= 1) *allow = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            (*cP)--;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            debug(D_SIGNALS,<span class="stringliteral">&quot;decreasing count to: %d\n&quot;</span>,*cP);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <span class="keywordflow">break</span>;  <span class="comment">// this is final, even if there&#39;s a timeout</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (semeq(sym,TIMEOUT_AT)) {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            <a class="code" href="structT.html">T</a> *td = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(c,1);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            <a class="code" href="structT.html">T</a> *nw = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(c,2);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            <span class="keywordtype">int</span> year = *(<span class="keywordtype">int</span> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(td,1))-1900;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <span class="keywordtype">int</span> mon = *(<span class="keywordtype">int</span> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(td,2))-1;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            <span class="keywordtype">int</span> mday = *(<span class="keywordtype">int</span> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(td,3));</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <span class="keywordtype">int</span> hour = *(<span class="keywordtype">int</span> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(nw,1));</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            <span class="keywordtype">int</span> min = *(<span class="keywordtype">int</span> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(nw,2));</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="keywordtype">int</span> sec = *(<span class="keywordtype">int</span> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(nw,3));</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            <span class="comment">//debug(D_SIGNALS,&quot;T: y:%d,m:%d,d:%d,h:%d,m:%d,s:%d\n&quot;)</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            time_t now_t;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            time(&amp;now_t);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            <span class="keyword">struct </span>tm now;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            gmtime_r(&amp;now_t, &amp;now);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            <span class="keywordflow">if</span> ((year &gt; now.tm_year) ||</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                (mon &gt; now.tm_mon) ||</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                (mday &gt; now.tm_mday) ||</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                (hour &gt; now.tm_hour) ||</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                (min &gt; now.tm_min) ||</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                (sec &gt; now.tm_sec)) {</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                *allow = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            }</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            *cleanup = !*allow;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (semeq(sym,UNLIMITED)) {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            *allow = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            raise_error(<span class="stringliteral">&quot;unknown end condition %s&quot;</span>,t2s(c));</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        }</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        k--;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    }</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    debug(D_SIGNALS,<span class="stringliteral">&quot;after end condition %s cleanup=%s allow=%s\n&quot;</span>,t2s(ec),*cleanup?<span class="stringliteral">&quot;true&quot;</span>:<span class="stringliteral">&quot;false&quot;</span>,*allow?<span class="stringliteral">&quot;true&quot;</span>:<span class="stringliteral">&quot;false&quot;</span>);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;}</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00605"></a><span class="lineno"><a class="line" href="group__receptor.html#ga70aee08cc1b09a659993eae4dc779a8b">  605</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__receptor.html#ga70aee08cc1b09a659993eae4dc779a8b">__r_test_expectation</a>(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structT.html">T</a> *expectation,<a class="code" href="structT.html">T</a> *signal) {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <a class="code" href="structQ.html">Q</a> *q = r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <a class="code" href="structT.html">T</a> *signal_contents = (<a class="code" href="structT.html">T</a> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(signal,SignalBodyIdx));</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="comment">//test carriers first because they must match</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <a class="code" href="structT.html">T</a> *e_carrier = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(expectation,ExpectationCarrierIdx);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <a class="code" href="structT.html">T</a> *s_carrier = <a class="code" href="group__tree.html#gae87e70707c55cc361e7bbfa0939536f6">_t_getv</a>(signal,SignalEnvelopeIdx,EnvelopeCarrierIdx,TREE_PATH_TERMINATOR);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    debug(D_SIGNALS,<span class="stringliteral">&quot;checking signal carrier %s\n&quot;</span>,_td(q-&gt;<a class="code" href="structQ.html#a38d241dba8d07c681a5133821b887984">r</a>,s_carrier));</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    debug(D_SIGNALS,<span class="stringliteral">&quot;against expectation carrier %s\n&quot;</span>,_td(q-&gt;<a class="code" href="structQ.html#a38d241dba8d07c681a5133821b887984">r</a>,e_carrier));</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <a class="code" href="structSemanticID.html">Symbol</a> esym = *(<a class="code" href="structSemanticID.html">Symbol</a> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(e_carrier);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">if</span> (!semeq(esym,*(<a class="code" href="structSemanticID.html">Symbol</a> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(s_carrier)) &amp;&amp; !semeq(esym,NULL_SYMBOL)) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <a class="code" href="structT.html">T</a> *pattern,*m;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    pattern = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(expectation,ExpectationPatternIdx);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">// if we get a match, create a run tree from the action, using the match and signal as the parameters</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <a class="code" href="structT.html">T</a> *stx = _t_news(0,SEMTREX_GROUP,NULL_SYMBOL);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <a class="code" href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a>(stx,<a class="code" href="group__tree.html#ga7535eb2963c6cf5fc78cb14287581f92">_t_clone</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(pattern,1)));</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    debug(D_SIGNALS,<span class="stringliteral">&quot;matching %s\n&quot;</span>,_td(q-&gt;<a class="code" href="structQ.html#a38d241dba8d07c681a5133821b887984">r</a>,signal_contents));</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    debug(D_SIGNALS,<span class="stringliteral">&quot;against %s\n&quot;</span>,_td(q-&gt;<a class="code" href="structQ.html#a38d241dba8d07c681a5133821b887984">r</a>,stx));</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordtype">bool</span> allow;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordtype">bool</span> cleanup;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    evaluateEndCondition(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(expectation,ExpectationEndCondsIdx),&amp;cleanup,&amp;allow);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">if</span> (allow &amp;&amp; <a class="code" href="group__semtrex.html#ga27540c8e1822da3160a0cc4717df410f">_t_matchr</a>(stx,signal_contents,&amp;m)) {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        debug(D_SIGNALS,<span class="stringliteral">&quot;got a match on %s\n&quot;</span>,_td(q-&gt;<a class="code" href="structQ.html#a38d241dba8d07c681a5133821b887984">r</a>,stx));</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <a class="code" href="structT.html">T</a> *rt=0;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <a class="code" href="structT.html">T</a> *action = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(expectation,ExpectationActionIdx);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="keywordflow">if</span> (!action) {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            raise_error(<span class="stringliteral">&quot;null action in expectation!&quot;</span>);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="keywordflow">if</span> (semeq(<a class="code" href="group__tree.html#ga946600fb570f0cc913450905f6189d49">_t_symbol</a>(action),WAKEUP_REFERENCE)) {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <span class="comment">/* // for now we add the params to the contexts run tree */</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="comment">/* /// @todo later this should be integrated into some kind of scoping handling */</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <a class="code" href="structT.html">T</a> *params = _t_rclone(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(expectation,ExpectationParamsIdx));</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <a class="code" href="process_8c.html#a98556348d3f5fbc7334184249fbe9127">_p_interpolate_from_match</a>(params,m,signal_contents);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <span class="keywordtype">int</span> process_id = *(<span class="keywordtype">int</span> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(action,1));</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <span class="keywordtype">int</span> *code_path = (<span class="keywordtype">int</span> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(action,2));</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            <span class="comment">// @todo figure out how to refactor this with the similar</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            <span class="comment">// code in _r_deliver.</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            debug(D_LOCK,<span class="stringliteral">&quot;listen LOCK\n&quot;</span>);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            pthread_mutex_lock(&amp;q-&gt;mutex);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <a class="code" href="structQe.html">Qe</a> *e = __p_find_context(q-&gt;<a class="code" href="structQ.html#ab8eb183576f2b1753d80bfcfdd0cd22b">blocked</a>,process_id);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            <span class="keywordflow">if</span> (e) {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                <a class="code" href="structT.html">T</a> *result = <a class="code" href="group__tree.html#gaf019d190c9623de809d006e309a441af">_t_get</a>(e-&gt;context-&gt;<a class="code" href="structR.html#aab5d23021e9afe31b32544e515f18c1f">run_tree</a>,code_path);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                <span class="keywordflow">if</span> (!result) raise_error(<span class="stringliteral">&quot;failed to find code path when waking up expectation!&quot;</span>);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                <a class="code" href="structT.html">T</a> *p = <a class="code" href="group__tree.html#ga18ca0b633cdd6b8f2d3d0f2598c4a933">_t_parent</a>(result);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                <a class="code" href="group__tree.html#ga0dcacdfd022b2a04b8fb53eb25ee367e">_t_replace</a>(p,<a class="code" href="group__tree.html#gaa47f880fb18ec33c8f31c2aee78df797">_t_node_index</a>(result), params);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                e-&gt;context-&gt;<a class="code" href="structR.html#af6f5d86ba88f08e5ee64236f4c5c107a">node_pointer</a> = params;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                __p_unblock(q,e);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                debug(D_LISTEN+D_SIGNALS,<span class="stringliteral">&quot;unblocking action at %d,%s\n&quot;</span>,process_id,_td(q-&gt;<a class="code" href="structQ.html#a38d241dba8d07c681a5133821b887984">r</a>,p));</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            <span class="keywordflow">else</span> <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(params);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            pthread_mutex_unlock(&amp;q-&gt;mutex);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            debug(D_LOCK,<span class="stringliteral">&quot;listen UNLOCK\n&quot;</span>);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            cleanup = <span class="keyword">true</span>; <span class="comment">//always cleanup after a wakeup because the context is gone.</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        }</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            <a class="code" href="structSemanticID.html">Process</a> p = *(<a class="code" href="structSemanticID.html">Process</a>*) <a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(action);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            <a class="code" href="structT.html">T</a> *params = _t_rclone(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(expectation,ExpectationParamsIdx));  <span class="comment">// __p_make_run_tree assumes rT nodes</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            <a class="code" href="process_8c.html#a98556348d3f5fbc7334184249fbe9127">_p_interpolate_from_match</a>(params,m,signal_contents);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <a class="code" href="structT.html">T</a> *processes = _sem_get_defs(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,p);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            rt = __p_make_run_tree(processes,p,params);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(params);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            <a class="code" href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a>(signal,rt);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            <a class="code" href="process_8c.html#a3ea04d2b45efc2d35b350002d3073040">_p_addrt2q</a>(q,rt);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        }</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(m);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">if</span> (cleanup) {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        debug(D_SIGNALS,<span class="stringliteral">&quot;cleaning up %s\n&quot;</span>,_td(q-&gt;<a class="code" href="structQ.html#a38d241dba8d07c681a5133821b887984">r</a>,expectation));</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        _r_remove_expectation(q-&gt;<a class="code" href="structQ.html#a38d241dba8d07c681a5133821b887984">r</a>,expectation);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    }</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(stx);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;}</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">// what kind of sanatizing do we do of the actual response signal?</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<a class="code" href="structT.html">T</a>* __r_sanatize_response(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structT.html">T</a>* response) {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keywordflow">return</span> _t_rclone(response);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;}</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div>
<div class="line"><a name="l00712"></a><span class="lineno"><a class="line" href="group__receptor.html#ga7d40f33135ee51640d0d24b8c9e3e046">  712</a></span>&#160;Error <a class="code" href="group__receptor.html#ga7d40f33135ee51640d0d24b8c9e3e046">_r_deliver</a>(<a class="code" href="structReceptor.html">Receptor</a> *r, <a class="code" href="structT.html">T</a> *signal) {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <a class="code" href="structT.html">T</a> *l;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <a class="code" href="structT.html">T</a> *envelope = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(signal,SignalEnvelopeIdx);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="comment">// see if this is more than a plain send signal we are delivering</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="comment">// if there are END_CONDITIONS we know this is a request</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="comment">// if there is a an IN_RESPONSE_TO_UUID then we know it&#39;s a response</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <a class="code" href="structT.html">T</a> *extra=<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(envelope,EnvelopeExtraIdx);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordflow">if</span> (extra &amp;&amp; semeq(IN_RESPONSE_TO_UUID,<a class="code" href="group__tree.html#ga946600fb570f0cc913450905f6189d49">_t_symbol</a>(extra))) {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="comment">// responses don&#39;t trigger expectation matching, instead they</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="comment">// go through the pending_responses list to see where the signal goes</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <a class="code" href="structUUIDt.html">UUIDt</a> *u = (<a class="code" href="structUUIDt.html">UUIDt</a>*)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(extra);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        debug(D_SIGNALS,<span class="stringliteral">&quot;Delivering response: %s\n&quot;</span>,_td(r,signal));</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        DO_KIDS(r-&gt;pending_responses,</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                l = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(r-&gt;pending_responses,i);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                if (__uuid_equal(u,(<a class="code" href="structUUIDt.html">UUIDt</a> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(l,PendingResponseUUIDIdx)))) {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                    <span class="comment">// get the end conditions so we can see if we should actually respond</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                    <a class="code" href="structT.html">T</a> *ec = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(l,PendingResponseEndCondsIdx);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                    <span class="keywordtype">bool</span> allow;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                    <span class="keywordtype">bool</span> cleanup;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                    evaluateEndCondition(ec,&amp;cleanup,&amp;allow);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                    <span class="keywordflow">if</span> (allow) {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                        <a class="code" href="structSemanticID.html">Symbol</a> carrier = *(<a class="code" href="structSemanticID.html">Symbol</a> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(l,PendingResponseCarrierIdx));</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                        <a class="code" href="structT.html">T</a> *wakeup = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(l,PendingResponseWakeupIdx);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                        <span class="keywordtype">int</span> process_id = *(<span class="keywordtype">int</span> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(wakeup,WakeupReferenceProcessIdentIdx));</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                        <span class="keywordtype">int</span> *code_path = (<span class="keywordtype">int</span> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(wakeup,WakeupReferenceCodePathIdx));</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                        <a class="code" href="structT.html">T</a> *response = (<a class="code" href="structT.html">T</a> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(signal,SignalBodyIdx));</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                        <span class="comment">// now set up the signal so when it&#39;s freed below, the body doesn&#39;t get freed too</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                        signal-&gt;context.flags &amp;= ~TFLAG_SURFACE_IS_TREE;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                        <a class="code" href="structSemanticID.html">Symbol</a> signal_carrier = *(<a class="code" href="structSemanticID.html">Symbol</a> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(envelope,EnvelopeCarrierIdx));</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                        <span class="keywordflow">if</span> (!semeq(carrier,signal_carrier)) {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                            debug(D_SIGNALS,<span class="stringliteral">&quot;response failed carrier check, expecting %s, but got %s!\n&quot;</span>,_r_get_symbol_name(r,carrier),_r_get_symbol_name(r,signal_carrier));</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                            <span class="comment">//@todo what kind of logging of these kinds of events?</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                        }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                        response = __r_sanatize_response(r,response);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                        <span class="comment">// if the response isn&#39;t safe just break</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                        <span class="keywordflow">if</span> (!response) {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                            <span class="comment">//@todo figure out if this means we should throw away the pending response too</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                        }</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                        <a class="code" href="structQ.html">Q</a> *q = r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                        debug(D_LOCK,<span class="stringliteral">&quot;deliver LOCK\n&quot;</span>);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                        pthread_mutex_lock(&amp;q-&gt;mutex);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                        <a class="code" href="structQe.html">Qe</a> *e = __p_find_context(q-&gt;<a class="code" href="structQ.html#ab8eb183576f2b1753d80bfcfdd0cd22b">blocked</a>,process_id);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                        <span class="keywordflow">if</span> (e) {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                            <a class="code" href="structT.html">T</a> *result = <a class="code" href="group__tree.html#gaf019d190c9623de809d006e309a441af">_t_get</a>(e-&gt;context-&gt;<a class="code" href="structR.html#aab5d23021e9afe31b32544e515f18c1f">run_tree</a>,code_path);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                            <span class="comment">// if the code path was from a signal on the flux, it&#39;s root</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                            <span class="comment">// will be the receptor, so the first get will fail so try again</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                            <span class="keywordflow">if</span> (!result) result = <a class="code" href="group__tree.html#gaf019d190c9623de809d006e309a441af">_t_get</a>(r-&gt;<a class="code" href="structReceptor.html#aec6f1eee133a993b59baf50e75620fb6">root</a>,code_path);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                            <span class="comment">// @todo that really wasn&#39;t very pretty, and what happens if that</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                            <span class="comment">// fails?  how do we handle it!?</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                            <span class="keywordflow">if</span> (!result) raise_error(<span class="stringliteral">&quot;failed to find code path when delivering response!&quot;</span>);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                            debug(D_SIGNALS,<span class="stringliteral">&quot;unblocking for response %s\n&quot;</span>,_td(r,response));</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                            <a class="code" href="group__tree.html#ga0dcacdfd022b2a04b8fb53eb25ee367e">_t_replace</a>(<a class="code" href="group__tree.html#ga18ca0b633cdd6b8f2d3d0f2598c4a933">_t_parent</a>(result),<a class="code" href="group__tree.html#gaa47f880fb18ec33c8f31c2aee78df797">_t_node_index</a>(result), response);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                            e-&gt;context-&gt;<a class="code" href="structR.html#af6f5d86ba88f08e5ee64236f4c5c107a">node_pointer</a> = response;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                            __p_unblock(q,e);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                        }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                        pthread_mutex_unlock(&amp;q-&gt;mutex);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                        debug(D_LOCK,<span class="stringliteral">&quot;deliver UNLOCK\n&quot;</span>);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                    }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                    <span class="keywordflow">if</span> (cleanup) {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                        debug(D_SIGNALS,<span class="stringliteral">&quot;removing pending response: %s\n&quot;</span>,_td(r,l));</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                        <a class="code" href="group__tree.html#ga403644d86c835ceae71dc7af0356900f">_t_detach_by_idx</a>(r-&gt;pending_responses,i);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                        <span class="comment">//i--;</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                        <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(l);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                    }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                );</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(signal);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    }</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <span class="keywordflow">if</span> (extra &amp;&amp; semeq(END_CONDITIONS,<a class="code" href="group__tree.html#ga946600fb570f0cc913450905f6189d49">_t_symbol</a>(extra))) {</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            <span class="comment">// determine if we will honor the request conditions?</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            <span class="comment">// perhaps that all happens at the protocol level</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            <span class="comment">// @todo anything specific we need to store here??</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        }</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <a class="code" href="structSemanticID.html">Aspect</a> aspect = *(<a class="code" href="structSemanticID.html">Aspect</a> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(<a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(envelope,EnvelopeAspectIdx));</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <a class="code" href="structT.html">T</a> *as = __r_get_signals(r,aspect);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        debug(D_SIGNALS,<span class="stringliteral">&quot;Delivering: %s\n&quot;</span>,_td(r,signal));</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <a class="code" href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a>(as,signal);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="comment">// walk through all the expectations on the aspect and see if any expectations match this incoming signal</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <a class="code" href="structT.html">T</a> *es = __r_get_expectations(r,aspect);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        DO_KIDS(es,</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                l = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(es,i);</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                <a class="code" href="group__receptor.html#ga70aee08cc1b09a659993eae4dc779a8b">__r_test_expectation</a>(r,l,signal);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                );</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordflow">return</span> noDeliveryErr;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;}</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">/******************  internal utilities */</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<a class="code" href="structT.html">T</a> *__r_get_aspect(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structSemanticID.html">Aspect</a> aspect) {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <a class="code" href="structT.html">T</a> *a;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    DO_KIDS(r-&gt;<a class="code" href="structReceptor.html#af8aee3ef6d1d93b80427faa57e6f1468">flux</a>,</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            a = <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(r-&gt;<a class="code" href="structReceptor.html#af8aee3ef6d1d93b80427faa57e6f1468">flux</a>,i);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            if (semeq(aspect,<a class="code" href="group__tree.html#ga946600fb570f0cc913450905f6189d49">_t_symbol</a>(a)))</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                <span class="keywordflow">return</span> a;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            );</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;}</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<a class="code" href="structT.html">T</a> *__r_get_expectations(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structSemanticID.html">Aspect</a> aspect) {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(__r_get_aspect(r,aspect),1);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;}</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<a class="code" href="structT.html">T</a> *__r_get_signals(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structSemanticID.html">Aspect</a> aspect) {</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a>(__r_get_aspect(r,aspect),2);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;}</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div>
<div class="line"><a name="l00840"></a><span class="lineno"><a class="line" href="group__receptor.html#gac438809f0d3f3add97efd49729c9027f">  840</a></span>&#160;<a class="code" href="structReceptor.html">Receptor</a> * <a class="code" href="group__receptor.html#gac438809f0d3f3add97efd49729c9027f">__r_get_receptor</a>(<a class="code" href="structT.html">T</a> *installed_receptor) {</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordflow">if</span> (! is_receptor(<a class="code" href="group__tree.html#ga946600fb570f0cc913450905f6189d49">_t_symbol</a>(installed_receptor)))</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        raise_error(<span class="stringliteral">&quot;expecting SEM_TYPE_RECEPTOR!&quot;</span>);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="structReceptor.html">Receptor</a> *)<a class="code" href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a>(installed_receptor);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;}</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">/*****************  Tree debugging utilities */</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="keywordtype">char</span> *_r_get_symbol_name(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structSemanticID.html">Symbol</a> s) {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keywordflow">return</span> _sem_get_name(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,s);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;}</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="keywordtype">char</span> *_r_get_structure_name(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structSemanticID.html">Structure</a> s) {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordflow">return</span> _sem_get_name(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,s);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;}</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="keywordtype">char</span> *_r_get_process_name(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structSemanticID.html">Process</a> p) {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keywordflow">return</span> _sem_get_name(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,p);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;}</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="keywordtype">char</span> __t_dump_buf[10000];</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="keywordtype">char</span> *_td(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structT.html">T</a> *t) {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    __td(r,t,__t_dump_buf);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;}</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="keywordtype">char</span> *__td(<a class="code" href="structReceptor.html">Receptor</a> *r,<a class="code" href="structT.html">T</a> *t,<span class="keywordtype">char</span> *buf) {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordflow">if</span> (!t) sprintf(buf,<span class="stringliteral">&quot;&lt;null-tree&gt;&quot;</span>);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        __t_dump(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,t,0,buf);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="keywordflow">return</span> buf;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;}</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">/*****************  Built-in core and edge receptors */</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<a class="code" href="structReceptor.html">Receptor</a> *_r_makeStreamReaderReceptor(<a class="code" href="structSemTable.html">SemTable</a> *sem,<a class="code" href="structSemanticID.html">Symbol</a> stream_symbol,<a class="code" href="structStream.html">Stream</a> *st,<a class="code" href="structReceptorAddress.html">ReceptorAddress</a> to) {</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a>(sem,STREAM_READER);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="comment">// code is something like:</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="comment">// (do (not stream eof) (send to (read_stream stream line)))</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <a class="code" href="structT.html">T</a> *p = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(ITERATE);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <a class="code" href="structT.html">T</a> *params = <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(p,PARAMS);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <a class="code" href="structT.html">T</a> *eof = <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(p,STREAM_ALIVE);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <a class="code" href="group__tree.html#ga519afafbfb5c4a13f01cc10e1f48cb28">_t_new_stream</a>(eof,stream_symbol,st);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="comment">//    _t_newi(p,TEST_INT_SYMBOL,2);  // two repetitions</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <a class="code" href="structT.html">T</a> *say = <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(p,SAY);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    __r_make_addr(say,TO_ADDRESS,to);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    _t_news(say,ASPECT_IDENT,DEFAULT_ASPECT);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    _t_news(say,CARRIER,LINE);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <a class="code" href="structT.html">T</a> *s = _t_new(say,STREAM_READ,0,0);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <a class="code" href="group__tree.html#ga519afafbfb5c4a13f01cc10e1f48cb28">_t_new_stream</a>(s,stream_symbol,st);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    _t_new(s,RESULT_SYMBOL,&amp;LINE,<span class="keyword">sizeof</span>(<a class="code" href="structSemanticID.html">Symbol</a>));</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <a class="code" href="structT.html">T</a> *run_tree = __p_build_run_tree(p,0);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(p);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <a class="code" href="process_8c.html#a3ea04d2b45efc2d35b350002d3073040">_p_addrt2q</a>(r-&gt;<a class="code" href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">q</a>,run_tree);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;}</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<a class="code" href="structReceptor.html">Receptor</a> *_r_makeStreamWriterReceptor(<a class="code" href="structSemTable.html">SemTable</a> *sem,<a class="code" href="structSemanticID.html">Symbol</a> stream_symbol,<a class="code" href="structStream.html">Stream</a> *st) {</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a>(sem,STREAM_WRITER);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <a class="code" href="structT.html">T</a> *expect = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(PATTERN);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordtype">char</span> *stx = <span class="stringliteral">&quot;/&lt;LINE:LINE&gt;&quot;</span>;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="comment">// @fixme for some reason parseSemtrex doesn&#39;t clean up after itself</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment">// valgrind reveals that some of the state in the FSA that match the</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="comment">// semtrex are left un freed.  So I&#39;m doing this one manually below.</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="comment">/* T *t = parseSemtrex(&amp;r-&gt;defs,stx); */</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="comment">/*  _t_add(expect,t); */</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="comment">//    T *t =_t_news(expect,SEMTREX_GROUP,NULL_SYMBOL);</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <a class="code" href="structT.html">T</a> *t =<a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(expect,SEMTREX_SYMBOL_ANY);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="comment">//    _t_news(x,SEMTREX_SYMBOL,LINE);</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="comment">/* char buf[1000]; */</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="comment">/* _dump_semtrex(r-&gt;sem,t,buf); */</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="comment">/* puts(buf); */</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <a class="code" href="structT.html">T</a> *x = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(STREAM_WRITE);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <a class="code" href="group__tree.html#ga519afafbfb5c4a13f01cc10e1f48cb28">_t_new_stream</a>(x,stream_symbol,st);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keywordtype">int</span> pt1[] = {2,1,TREE_PATH_TERMINATOR};</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    _t_new(x,PARAM_REF,pt1,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*4);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <a class="code" href="structT.html">T</a>* params = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(PARAMS);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    _t_news(params,INTERPOLATE_SYMBOL,NULL_SYMBOL);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <a class="code" href="structT.html">T</a> *signature = __p_make_signature(<span class="stringliteral">&quot;result&quot;</span>,SIGNATURE_SYMBOL,NULL_SYMBOL,</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                                      <span class="stringliteral">&quot;stream&quot;</span>,SIGNATURE_STRUCTURE,STREAM,</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                                      NULL);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <a class="code" href="structSemanticID.html">Process</a> proc = <a class="code" href="group__receptor.html#ga9e248fdb6e6d814935ac88e67e10e769">_r_define_process</a>(r,x,<span class="stringliteral">&quot;echo input to stream&quot;</span>,<span class="stringliteral">&quot;long desc...&quot;</span>,signature);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <a class="code" href="structT.html">T</a> *act = <a class="code" href="group__tree.html#ga48ffc2a6e4aa4856b76fb53b97db87f3">_t_newp</a>(0,ACTION,proc);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <a class="code" href="group__receptor.html#gac391ad8fbd0bb7ca9382e9ab0018edcf">_r_add_expectation</a>(r,DEFAULT_ASPECT,NULL_SYMBOL,expect,act,params,0);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;}</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="keywordtype">void</span> _r_defineClockReceptor(<a class="code" href="structSemTable.html">SemTable</a> *sem) {</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    Context clk_ctx =  _d_get_receptor_context(sem,CLOCK_RECEPTOR);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <a class="code" href="structT.html">T</a> *resp = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(RESPOND);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    _t_news(resp,CARRIER,TICK);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <a class="code" href="structXaddr.html">Xaddr</a> x = {TICK,1};</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <a class="code" href="structT.html">T</a> *g = <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(resp,GET);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    _t_new(g,GET_XADDR,&amp;x,<span class="keyword">sizeof</span>(<a class="code" href="structXaddr.html">Xaddr</a>));</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <a class="code" href="structT.html">T</a> *signature = __p_make_signature(<span class="stringliteral">&quot;result&quot;</span>,SIGNATURE_SYMBOL,NULL_SYMBOL,NULL);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <a class="code" href="structSemanticID.html">Process</a> proc = <a class="code" href="group__def.html#gaee8a21fdd29944bf44bb03457511515d">_d_define_process</a>(sem,resp,<span class="stringliteral">&quot;respond with current time&quot;</span>,<span class="stringliteral">&quot;long desc...&quot;</span>,signature,clk_ctx);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;}</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<a class="code" href="structReceptor.html">Receptor</a> *_r_makeClockReceptor(<a class="code" href="structSemTable.html">SemTable</a> *sem) {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = <a class="code" href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a>(sem,CLOCK_RECEPTOR);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="comment">// add the expectation in explicitly because we haven&#39;t yet defined the clock protocol</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <a class="code" href="structT.html">T</a> *expect = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(PATTERN);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <a class="code" href="structT.html">T</a> *s = <a class="code" href="group__semtrex.html#ga12e70dc3d5fde33655e8731ad3bdd935">_sl</a>(expect,CLOCK_TELL_TIME);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <a class="code" href="structT.html">T</a> *tick = __r_make_tick();  <span class="comment">// initial tick, will get updated by clock thread.</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <a class="code" href="structXaddr.html">Xaddr</a> x = <a class="code" href="group__receptor.html#gadd08a3c284251a2ec7e03b8f91eddc5c">_r_new_instance</a>(r,tick);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <a class="code" href="structSemanticID.html">Process</a> proc = _sem_get_by_label(sem,<span class="stringliteral">&quot;respond with current time&quot;</span>,r-&gt;<a class="code" href="structReceptor.html#ae57114199054b577820844eaff7593dd">context</a>);</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <a class="code" href="structT.html">T</a> *act = <a class="code" href="group__tree.html#ga48ffc2a6e4aa4856b76fb53b97db87f3">_t_newp</a>(0,ACTION,proc);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <a class="code" href="structT.html">T</a> *params = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(PARAMS);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <a class="code" href="group__receptor.html#gac391ad8fbd0bb7ca9382e9ab0018edcf">_r_add_expectation</a>(r,DEFAULT_ASPECT,CLOCK_TELL_TIME,expect,act,params,0);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keywordflow">return</span> r;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;}</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div>
<div class="line"><a name="l00988"></a><span class="lineno"><a class="line" href="group__receptor.html#ga4cb85b79ae4207e4595d003d11beb226">  988</a></span>&#160;<span class="keywordtype">void</span> *<a class="code" href="group__receptor.html#ga4cb85b79ae4207e4595d003d11beb226">___clock_thread</a>(<span class="keywordtype">void</span> *arg){</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <a class="code" href="structReceptor.html">Receptor</a> *r = (<a class="code" href="structReceptor.html">Receptor</a>*)arg;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    debug(D_CLOCK,<span class="stringliteral">&quot;clock started\n&quot;</span>);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="keywordtype">int</span> err =0;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <a class="code" href="structReceptorAddress.html">ReceptorAddress</a> <span class="keyword">self</span> = __r_get_self_address(r);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">while</span> (r-&gt;<a class="code" href="structReceptor.html#a877d31e0f4bd35d7c4a598c6e0416dd5">state</a> == Alive) {</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <a class="code" href="structT.html">T</a> *tick =__r_make_tick();</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        debug(D_CLOCK,<span class="stringliteral">&quot;%s\n&quot;</span>,_td(r,tick));</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <a class="code" href="structXaddr.html">Xaddr</a> x = {TICK,1};</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <a class="code" href="group__receptor.html#ga28899931aa49371ed6eb6c69b123b5f6">_r_set_instance</a>(r,x,tick);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="comment">//        T *signal = __r_make_signal(self,self,DEFAULT_ASPECT,TICK,tick,0,0);</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        <span class="comment">//        _r_deliver(r,signal);</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        sleep(1);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="comment">//       with nano-sleep so that we get every second?</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    debug(D_CLOCK,<span class="stringliteral">&quot;clock stopped\n&quot;</span>);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    pthread_exit(&amp;err); <span class="comment">//@todo determine if we should use pthread_exit or just return 0</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;}</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<a class="code" href="structT.html">T</a> * __r_make_timestamp(<a class="code" href="structSemanticID.html">Symbol</a> s,<span class="keywordtype">int</span> delta) {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keyword">struct </span>tm t;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    time_t clock;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    time(&amp;clock);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    clock += delta;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    gmtime_r(&amp;clock, &amp;t);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <a class="code" href="structT.html">T</a> *tick = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(s);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <a class="code" href="structT.html">T</a> *today = <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(tick,TODAY);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <a class="code" href="structT.html">T</a> *now = <a class="code" href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a>(tick,NOW);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    _t_newi(today,YEAR,t.tm_year+1900);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    _t_newi(today,MONTH,t.tm_mon+1);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    _t_newi(today,DAY,t.tm_mday);</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    _t_newi(now,HOUR,t.tm_hour);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    _t_newi(now,MINUTE,t.tm_min);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    _t_newi(now,SECOND,t.tm_sec);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="keywordflow">return</span> tick;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;}</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="keywordtype">void</span> __r_kill(<a class="code" href="structReceptor.html">Receptor</a> *r) {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    r-&gt;<a class="code" href="structReceptor.html#a877d31e0f4bd35d7c4a598c6e0416dd5">state</a> = Dead;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="comment">/* pthread_mutex_lock(&amp;shutdownMutex); */</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="comment">/* G_shutdown = val; */</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="comment">/* pthread_mutex_unlock(&amp;shutdownMutex); */</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;}</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<a class="code" href="structReceptorAddress.html">ReceptorAddress</a> __r_get_self_address(<a class="code" href="structReceptor.html">Receptor</a> *r) {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="keywordflow">return</span> r-&gt;<a class="code" href="structReceptor.html#afeea3c89b6853516cd4c4d8e9d885174">addr</a>;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;}</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="keywordtype">void</span> __r_dump_instances(<a class="code" href="structReceptor.html">Receptor</a> *r) {</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <a class="code" href="structinstances__elem.html">Instances</a> *i = &amp;r-&gt;<a class="code" href="structReceptor.html#a6150c6bff7a9724b4dd436a75fe4cc4b">instances</a>;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <a class="code" href="structT.html">T</a> *t = <a class="code" href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a>(PARAMS);  <span class="comment">// bogus symbol, just using to build the tree</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <a class="code" href="structinstances__elem.html">instances_elem</a> *cur,*tmp;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    HASH_ITER(hh, *i, cur, tmp) {</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <a class="code" href="structT.html">T</a> *sym = _t_news(t,STRUCTURE_SYMBOL,cur-&gt;<a class="code" href="structinstances__elem.html#aeeb84ef2b0bb4b596d161bc84f17937d">s</a>);  <span class="comment">// just using this symbol to store the symbol type</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        <a class="code" href="structinstance__elem.html">Instance</a> *iP = &amp;cur-&gt;<a class="code" href="structinstances__elem.html#a734b66c913756eb945351222cb601a87">instances</a>;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <a class="code" href="structinstance__elem.html">instance_elem</a> *curi,*tmpi;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        HASH_ITER(hh, *iP, curi, tmpi) {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            <a class="code" href="structT.html">T</a> *c = <a class="code" href="group__tree.html#ga7535eb2963c6cf5fc78cb14287581f92">_t_clone</a>(curi-&gt;<a class="code" href="structinstance__elem.html#a7a42321cb232ac42535157a9e654127f">instance</a>);</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;            <a class="code" href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a>(sym,c);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        }</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    }</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    printf(<span class="stringliteral">&quot;INSTANCES:%s\n&quot;</span>,_t2s(r-&gt;<a class="code" href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">sem</a>,t));</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <a class="code" href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a>(t);</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;}</div>
<div class="ttc" id="structinstance__elem_html"><div class="ttname"><a href="structinstance__elem.html">instance_elem</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00158">ceptr_types.h:158</a></div></div>
<div class="ttc" id="group__tree_html_ga25dd0f385044ffbcc7c215ea80fa00b4"><div class="ttname"><a href="group__tree.html#ga25dd0f385044ffbcc7c215ea80fa00b4">_t_new_root</a></div><div class="ttdeci">T * _t_new_root(Symbol symbol)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00137">tree.c:137</a></div></div>
<div class="ttc" id="structQ_html_a38d241dba8d07c681a5133821b887984"><div class="ttname"><a href="structQ.html#a38d241dba8d07c681a5133821b887984">Q::r</a></div><div class="ttdeci">Receptor * r</div><div class="ttdoc">back-pointer to receptor in which this Q is running (for defs and more) </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00216">ceptr_types.h:216</a></div></div>
<div class="ttc" id="structT_html"><div class="ttname"><a href="structT.html">T</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00114">ceptr_types.h:114</a></div></div>
<div class="ttc" id="structReceptor_html_a877d31e0f4bd35d7c4a598c6e0416dd5"><div class="ttname"><a href="structReceptor.html#a877d31e0f4bd35d7c4a598c6e0416dd5">Receptor::state</a></div><div class="ttdeci">int state</div><div class="ttdoc">state information about the receptor that the vmhost manages </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00259">ceptr_types.h:259</a></div></div>
<div class="ttc" id="group__receptor_html_ga120e66982d483fbe004fd969cf1c353f"><div class="ttname"><a href="group__receptor.html#ga120e66982d483fbe004fd969cf1c353f">__r_get_symbol_structure</a></div><div class="ttdeci">Structure __r_get_symbol_structure(Receptor *r, Symbol s)</div><div class="ttdoc">find a symbol&#39;s structure </div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00262">receptor.c:262</a></div></div>
<div class="ttc" id="group__receptor_html_ga3e737841784555574a0d90ad2eff4cc4"><div class="ttname"><a href="group__receptor.html#ga3e737841784555574a0d90ad2eff4cc4">_r_serialize</a></div><div class="ttdeci">void _r_serialize(Receptor *r, void **surfaceP, size_t *lengthP)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00382">receptor.c:382</a></div></div>
<div class="ttc" id="structStream_html"><div class="ttname"><a href="structStream.html">Stream</a></div><div class="ttdef"><b>Definition:</b> <a href="stream_8h_source.html#l00028">stream.h:28</a></div></div>
<div class="ttc" id="mtree_8c_html_a641f65780358ce0f40479d6ccaba1735"><div class="ttname"><a href="mtree_8c.html#a641f65780358ce0f40479d6ccaba1735">_m_unserialize</a></div><div class="ttdeci">H _m_unserialize(S *s)</div><div class="ttdef"><b>Definition:</b> <a href="mtree_8c_source.html#l00743">mtree.c:743</a></div></div>
<div class="ttc" id="structQ_html"><div class="ttname"><a href="structQ.html">Q</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00215">ceptr_types.h:215</a></div></div>
<div class="ttc" id="group__tree_html_gaf019d190c9623de809d006e309a441af"><div class="ttname"><a href="group__tree.html#gaf019d190c9623de809d006e309a441af">_t_get</a></div><div class="ttdeci">T * _t_get(T *t, int *p)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00941">tree.c:941</a></div></div>
<div class="ttc" id="structReceptor_html_ab5037726ba2360fe29cc238ab1d98e94"><div class="ttname"><a href="structReceptor.html#ab5037726ba2360fe29cc238ab1d98e94">Receptor::parent</a></div><div class="ttdeci">Context parent</div><div class="ttdoc">the context this receptor definition lives in </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00248">ceptr_types.h:248</a></div></div>
<div class="ttc" id="debug_8h_html"><div class="ttname"><a href="debug_8h.html">debug.h</a></div></div>
<div class="ttc" id="group__tree_html_ga403644d86c835ceae71dc7af0356900f"><div class="ttname"><a href="group__tree.html#ga403644d86c835ceae71dc7af0356900f">_t_detach_by_idx</a></div><div class="ttdeci">T * _t_detach_by_idx(T *t, int i)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00255">tree.c:255</a></div></div>
<div class="ttc" id="process_8c_html_aea59e125f10441efe75f6047ee7b35e1"><div class="ttname"><a href="process_8c.html#aea59e125f10441efe75f6047ee7b35e1">_p_freeq</a></div><div class="ttdeci">void _p_freeq(Q *q)</div><div class="ttdef"><b>Definition:</b> <a href="process_8c_source.html#l01142">process.c:1142</a></div></div>
<div class="ttc" id="group__tree_html_ga55270b512ed52ffe5a938a793fa5cd7f"><div class="ttname"><a href="group__tree.html#ga55270b512ed52ffe5a938a793fa5cd7f">_t_path_depth</a></div><div class="ttdeci">int _t_path_depth(int *p)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00866">tree.c:866</a></div></div>
<div class="ttc" id="group__tree_html_gaa47f880fb18ec33c8f31c2aee78df797"><div class="ttname"><a href="group__tree.html#gaa47f880fb18ec33c8f31c2aee78df797">_t_node_index</a></div><div class="ttdeci">int _t_node_index(T *t)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00803">tree.c:803</a></div></div>
<div class="ttc" id="group__receptor_html_ga70aee08cc1b09a659993eae4dc779a8b"><div class="ttname"><a href="group__receptor.html#ga70aee08cc1b09a659993eae4dc779a8b">__r_test_expectation</a></div><div class="ttdeci">void __r_test_expectation(Receptor *r, T *expectation, T *signal)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00605">receptor.c:605</a></div></div>
<div class="ttc" id="mtree_8c_html_a27481040e0d545565d203c0f37b30d79"><div class="ttname"><a href="mtree_8c.html#a27481040e0d545565d203c0f37b30d79">_m_serialize</a></div><div class="ttdeci">S * _m_serialize(M *m)</div><div class="ttdef"><b>Definition:</b> <a href="mtree_8c_source.html#l00645">mtree.c:645</a></div></div>
<div class="ttc" id="semtrex_8h_html"><div class="ttname"><a href="semtrex_8h.html">semtrex.h</a></div><div class="ttdoc">Semantic tree regular expression header file. </div></div>
<div class="ttc" id="structinstances__elem_html_a734b66c913756eb945351222cb601a87"><div class="ttname"><a href="structinstances__elem.html#a734b66c913756eb945351222cb601a87">instances_elem::instances</a></div><div class="ttdeci">Instance instances</div><div class="ttdoc">instances store </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00170">ceptr_types.h:170</a></div></div>
<div class="ttc" id="structinstance__elem_html_a7a42321cb232ac42535157a9e654127f"><div class="ttname"><a href="structinstance__elem.html#a7a42321cb232ac42535157a9e654127f">instance_elem::instance</a></div><div class="ttdeci">T * instance</div><div class="ttdoc">the stored instance </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00160">ceptr_types.h:160</a></div></div>
<div class="ttc" id="group__tree_html_gaceb68b489c4362a94aafa5b71c38d1ee"><div class="ttname"><a href="group__tree.html#gaceb68b489c4362a94aafa5b71c38d1ee">_t_hash</a></div><div class="ttdeci">TreeHash _t_hash(SemTable *sem, T *t)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l01037">tree.c:1037</a></div></div>
<div class="ttc" id="group__tree_html_gae4c9b743462f0a3808c9f02c3bf33da8"><div class="ttname"><a href="group__tree.html#gae4c9b743462f0a3808c9f02c3bf33da8">_t_get_path</a></div><div class="ttdeci">int * _t_get_path(T *t)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00885">tree.c:885</a></div></div>
<div class="ttc" id="structS_html"><div class="ttname"><a href="structS.html">S</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00068">ceptr_types.h:68</a></div></div>
<div class="ttc" id="group__tree_html_ga7535eb2963c6cf5fc78cb14287581f92"><div class="ttname"><a href="group__tree.html#ga7535eb2963c6cf5fc78cb14287581f92">_t_clone</a></div><div class="ttdeci">T * _t_clone(T *t)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00558">tree.c:558</a></div></div>
<div class="ttc" id="group__receptor_html_ga6f650808029d4c598ebe6515d9900ef8"><div class="ttname"><a href="group__receptor.html#ga6f650808029d4c598ebe6515d9900ef8">_r_free</a></div><div class="ttdeci">void _r_free(Receptor *r)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00166">receptor.c:166</a></div></div>
<div class="ttc" id="group__tree_html_ga3e2009f5a82889263d560d2c1479606a"><div class="ttname"><a href="group__tree.html#ga3e2009f5a82889263d560d2c1479606a">_t_newr</a></div><div class="ttdeci">T * _t_newr(T *parent, Symbol symbol)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00148">tree.c:148</a></div></div>
<div class="ttc" id="group__tree_html_ga946600fb570f0cc913450905f6189d49"><div class="ttname"><a href="group__tree.html#ga946600fb570f0cc913450905f6189d49">_t_symbol</a></div><div class="ttdeci">Symbol _t_symbol(T *t)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00747">tree.c:747</a></div></div>
<div class="ttc" id="group__tree_html_ga07dd808fabd8a722b417f2f5e5ca132b"><div class="ttname"><a href="group__tree.html#ga07dd808fabd8a722b417f2f5e5ca132b">_t_child</a></div><div class="ttdeci">T * _t_child(T *t, int i)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00770">tree.c:770</a></div></div>
<div class="ttc" id="group__receptor_html_gac438809f0d3f3add97efd49729c9027f"><div class="ttname"><a href="group__receptor.html#gac438809f0d3f3add97efd49729c9027f">__r_get_receptor</a></div><div class="ttdeci">Receptor * __r_get_receptor(T *installed_receptor)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00840">receptor.c:840</a></div></div>
<div class="ttc" id="group__tree_html_ga48ffc2a6e4aa4856b76fb53b97db87f3"><div class="ttname"><a href="group__tree.html#ga48ffc2a6e4aa4856b76fb53b97db87f3">_t_newp</a></div><div class="ttdeci">T * _t_newp(T *parent, Symbol symbol, Process surface)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00228">tree.c:228</a></div></div>
<div class="ttc" id="group__receptor_html_ga1570f1fca510bdaf19d044592ee035ce"><div class="ttname"><a href="group__receptor.html#ga1570f1fca510bdaf19d044592ee035ce">_r_hash</a></div><div class="ttdeci">TreeHash _r_hash(Receptor *r, Xaddr t)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00364">receptor.c:364</a></div></div>
<div class="ttc" id="group__receptor_html_ga8bee7d388b8fde389b0667bf57684ba0"><div class="ttname"><a href="group__receptor.html#ga8bee7d388b8fde389b0667bf57684ba0">_r_new_receptor_from_package</a></div><div class="ttdeci">Receptor * _r_new_receptor_from_package(SemTable *sem, Symbol s, T *p, T *bindings)</div><div class="ttdoc">Creates a new receptor from a receptor package. </div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00104">receptor.c:104</a></div></div>
<div class="ttc" id="stream_8h_html"><div class="ttname"><a href="stream_8h.html">stream.h</a></div><div class="ttdoc">streams abstraction header file </div></div>
<div class="ttc" id="group__def_html_ga15d66273ad66f17580a90a30c90b8f07"><div class="ttname"><a href="group__def.html#ga15d66273ad66f17580a90a30c90b8f07">_d_build_def_semtrex</a></div><div class="ttdeci">T * _d_build_def_semtrex(SemTable *sem, Symbol s, T *parent)</div><div class="ttdef"><b>Definition:</b> <a href="def_8c_source.html#l00347">def.c:347</a></div></div>
<div class="ttc" id="structReceptor_html_ae57114199054b577820844eaff7593dd"><div class="ttname"><a href="structReceptor.html#ae57114199054b577820844eaff7593dd">Receptor::context</a></div><div class="ttdeci">Context context</div><div class="ttdoc">the context this receptor definition creates </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00249">ceptr_types.h:249</a></div></div>
<div class="ttc" id="group__def_html_gaa07e8bdb0806d0e55d0f892c791def0d"><div class="ttname"><a href="group__def.html#gaa07e8bdb0806d0e55d0f892c791def0d">_d_define_structure</a></div><div class="ttdeci">Structure _d_define_structure(SemTable *sem, char *label, T *structure_def, Context c)</div><div class="ttdef"><b>Definition:</b> <a href="def_8c_source.html#l00143">def.c:143</a></div></div>
<div class="ttc" id="structReceptor_html_afeea3c89b6853516cd4c4d8e9d885174"><div class="ttname"><a href="structReceptor.html#afeea3c89b6853516cd4c4d8e9d885174">Receptor::addr</a></div><div class="ttdeci">ReceptorAddress addr</div><div class="ttdoc">the address by which to get messages to this receptor instance </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00250">ceptr_types.h:250</a></div></div>
<div class="ttc" id="structReceptor_html_a6150c6bff7a9724b4dd436a75fe4cc4b"><div class="ttname"><a href="structReceptor.html#a6150c6bff7a9724b4dd436a75fe4cc4b">Receptor::instances</a></div><div class="ttdeci">Instances instances</div><div class="ttdoc">the instances store </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00257">ceptr_types.h:257</a></div></div>
<div class="ttc" id="receptor_8h_html"><div class="ttname"><a href="receptor_8h.html">receptor.h</a></div><div class="ttdoc">receptor implementation header file </div></div>
<div class="ttc" id="group__receptor_html_gae291bec8771c13074164984b08db4874"><div class="ttname"><a href="group__receptor.html#gae291bec8771c13074164984b08db4874">_r_define_structure</a></div><div class="ttdeci">Structure _r_define_structure(Receptor *r, char *label, int num_params,...)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00202">receptor.c:202</a></div></div>
<div class="ttc" id="group__def_html_ga63d387c448c4ab2f9acbf7010e45664d"><div class="ttname"><a href="group__def.html#ga63d387c448c4ab2f9acbf7010e45664d">_d_get_symbol_size</a></div><div class="ttdeci">size_t _d_get_symbol_size(SemTable *sem, Symbol s, void *surface)</div><div class="ttdef"><b>Definition:</b> <a href="def_8c_source.html#l00212">def.c:212</a></div></div>
<div class="ttc" id="structReceptor_html_ab1e1dd776afee48ee71297a3e39756f8"><div class="ttname"><a href="structReceptor.html#ab1e1dd776afee48ee71297a3e39756f8">Receptor::q</a></div><div class="ttdeci">Q * q</div><div class="ttdoc">process queue </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00258">ceptr_types.h:258</a></div></div>
<div class="ttc" id="group__semtrex_html_ga8e580d7393964e5df55e92aebf587e3f"><div class="ttname"><a href="group__semtrex.html#ga8e580d7393964e5df55e92aebf587e3f">_t_match</a></div><div class="ttdeci">int _t_match(T *semtrex, T *t)</div><div class="ttdef"><b>Definition:</b> <a href="semtrex_8c_source.html#l00699">semtrex.c:699</a></div></div>
<div class="ttc" id="group__tree_html_ga519afafbfb5c4a13f01cc10e1f48cb28"><div class="ttname"><a href="group__tree.html#ga519afafbfb5c4a13f01cc10e1f48cb28">_t_new_stream</a></div><div class="ttdeci">T * _t_new_stream(T *parent, Symbol symbol, Stream *s)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00216">tree.c:216</a></div></div>
<div class="ttc" id="structReceptorAddress_html"><div class="ttname"><a href="structReceptorAddress.html">ReceptorAddress</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00207">ceptr_types.h:207</a></div></div>
<div class="ttc" id="group__tree_html_gac9278e540a0d63526b60cc0591283a62"><div class="ttname"><a href="group__tree.html#gac9278e540a0d63526b60cc0591283a62">_t_surface</a></div><div class="ttdeci">void * _t_surface(T *t)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00734">tree.c:734</a></div></div>
<div class="ttc" id="group__receptor_html_ga9a017ac5e8250b6143719abe815be93a"><div class="ttname"><a href="group__receptor.html#ga9a017ac5e8250b6143719abe815be93a">__r_define_structure</a></div><div class="ttdeci">Structure __r_define_structure(Receptor *r, char *label, T *structure_def)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00224">receptor.c:224</a></div></div>
<div class="ttc" id="structReceptor_html_af8aee3ef6d1d93b80427faa57e6f1468"><div class="ttname"><a href="structReceptor.html#af8aee3ef6d1d93b80427faa57e6f1468">Receptor::flux</a></div><div class="ttdeci">T * flux</div><div class="ttdoc">pointer for quick access to the flux </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00252">ceptr_types.h:252</a></div></div>
<div class="ttc" id="receptor_8c_html_a6784a7133ab6bc8c6a105fead8843c86"><div class="ttname"><a href="receptor_8c.html#a6784a7133ab6bc8c6a105fead8843c86">__r_get_structure_size</a></div><div class="ttdeci">size_t __r_get_structure_size(Receptor *r, Structure s, void *surface)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00270">receptor.c:270</a></div></div>
<div class="ttc" id="group__receptor_html_ga9f66f2aaba88463a6e1f238a367a33f9"><div class="ttname"><a href="group__receptor.html#ga9f66f2aaba88463a6e1f238a367a33f9">_r_new</a></div><div class="ttdeci">Receptor * _r_new(SemTable *sem, SemanticID r)</div><div class="ttdoc">Creates a new receptor. </div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00079">receptor.c:79</a></div></div>
<div class="ttc" id="group__receptor_html_ga9e248fdb6e6d814935ac88e67e10e769"><div class="ttname"><a href="group__receptor.html#ga9e248fdb6e6d814935ac88e67e10e769">_r_define_process</a></div><div class="ttdeci">Process _r_define_process(Receptor *r, T *code, char *name, char *intention, T *signature)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00241">receptor.c:241</a></div></div>
<div class="ttc" id="group__def_html_gaf51869e61eb84e17986d26da65205eaf"><div class="ttname"><a href="group__def.html#gaf51869e61eb84e17986d26da65205eaf">_d_get_structure_size</a></div><div class="ttdeci">size_t _d_get_structure_size(SemTable *sem, Structure s, void *surface)</div><div class="ttdef"><b>Definition:</b> <a href="def_8c_source.html#l00247">def.c:247</a></div></div>
<div class="ttc" id="group__receptor_html_ga63e9fb219f66164df22ffb5356b218b2"><div class="ttname"><a href="group__receptor.html#ga63e9fb219f66164df22ffb5356b218b2">_r_unserialize</a></div><div class="ttdeci">Receptor * _r_unserialize(SemTable *sem, void *surface)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00409">receptor.c:409</a></div></div>
<div class="ttc" id="group__tree_html_ga79cff1b1b9d692acc297634be059c6a9"><div class="ttname"><a href="group__tree.html#ga79cff1b1b9d692acc297634be059c6a9">_t_newt</a></div><div class="ttdeci">T * _t_newt(T *parent, Symbol symbol, T *surface)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00110">tree.c:110</a></div></div>
<div class="ttc" id="group__receptor_html_gaa9abda6d1e05a6b498580619d216efe9"><div class="ttname"><a href="group__receptor.html#gaa9abda6d1e05a6b498580619d216efe9">_r_send</a></div><div class="ttdeci">T * _r_send(Receptor *r, T *signal)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00507">receptor.c:507</a></div></div>
<div class="ttc" id="structUUIDt_html"><div class="ttname"><a href="structUUIDt.html">UUIDt</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00262">ceptr_types.h:262</a></div></div>
<div class="ttc" id="group__receptor_html_ga2b16e941a406a95aba1c8db047d00041"><div class="ttname"><a href="group__receptor.html#ga2b16e941a406a95aba1c8db047d00041">_r_get_sem_by_label</a></div><div class="ttdeci">Symbol _r_get_sem_by_label(Receptor *r, char *label)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00254">receptor.c:254</a></div></div>
<div class="ttc" id="group__tree_html_ga18ca0b633cdd6b8f2d3d0f2598c4a933"><div class="ttname"><a href="group__tree.html#ga18ca0b633cdd6b8f2d3d0f2598c4a933">_t_parent</a></div><div class="ttdeci">T * _t_parent(T *t)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00781">tree.c:781</a></div></div>
<div class="ttc" id="structSemTable_html"><div class="ttname"><a href="structSemTable.html">SemTable</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00232">ceptr_types.h:232</a></div></div>
<div class="ttc" id="process_8h_html"><div class="ttname"><a href="process_8h.html">process.h</a></div><div class="ttdoc">processing header files </div></div>
<div class="ttc" id="group__def_html_ga3f075d8ef101d4a88a6668f01cf44080"><div class="ttname"><a href="group__def.html#ga3f075d8ef101d4a88a6668f01cf44080">_d_define_symbol</a></div><div class="ttdeci">Symbol _d_define_symbol(SemTable *sem, Structure s, char *label, Context c)</div><div class="ttdef"><b>Definition:</b> <a href="def_8c_source.html#l00119">def.c:119</a></div></div>
<div class="ttc" id="mtree_8c_html_ab0e6e5f78e7ec6f3c9165feca0eae093"><div class="ttname"><a href="mtree_8c.html#ab0e6e5f78e7ec6f3c9165feca0eae093">_t_new_from_m</a></div><div class="ttdeci">T * _t_new_from_m(H h)</div><div class="ttdef"><b>Definition:</b> <a href="mtree_8c_source.html#l00250">mtree.c:250</a></div></div>
<div class="ttc" id="group__semtrex_html_ga27540c8e1822da3160a0cc4717df410f"><div class="ttname"><a href="group__semtrex.html#ga27540c8e1822da3160a0cc4717df410f">_t_matchr</a></div><div class="ttdeci">int _t_matchr(T *semtrex, T *t, T **rP)</div><div class="ttdef"><b>Definition:</b> <a href="semtrex_8c_source.html#l00688">semtrex.c:688</a></div></div>
<div class="ttc" id="structR_html_af6f5d86ba88f08e5ee64236f4c5c107a"><div class="ttname"><a href="structR.html#af6f5d86ba88f08e5ee64236f4c5c107a">R::node_pointer</a></div><div class="ttdeci">T * node_pointer</div><div class="ttdoc">pointer to the tree node to execute next </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00184">ceptr_types.h:184</a></div></div>
<div class="ttc" id="group__receptor_html_ga63078117d8c6850455a4419fd9b6b784"><div class="ttname"><a href="group__receptor.html#ga63078117d8c6850455a4419fd9b6b784">_r_build_def_semtrex</a></div><div class="ttdeci">T * _r_build_def_semtrex(Receptor *r, Symbol s)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00288">receptor.c:288</a></div></div>
<div class="ttc" id="structReceptor_html_aec6f1eee133a993b59baf50e75620fb6"><div class="ttname"><a href="structReceptor.html#aec6f1eee133a993b59baf50e75620fb6">Receptor::root</a></div><div class="ttdeci">T * root</div><div class="ttdoc">RECEPTOR_INSTANCE semantic tree. </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00247">ceptr_types.h:247</a></div></div>
<div class="ttc" id="structQ_html_ab8eb183576f2b1753d80bfcfdd0cd22b"><div class="ttname"><a href="structQ.html#ab8eb183576f2b1753d80bfcfdd0cd22b">Q::blocked</a></div><div class="ttdeci">Qe * blocked</div><div class="ttdoc">blocked processes </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00220">ceptr_types.h:220</a></div></div>
<div class="ttc" id="structReceptor_html_a4bb9ce729b6b85fb99326e9df7b23cbd"><div class="ttname"><a href="structReceptor.html#a4bb9ce729b6b85fb99326e9df7b23cbd">Receptor::sem</a></div><div class="ttdeci">SemTable * sem</div><div class="ttdoc">pointer back to the semantic table context where the receptor&#39;s running </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00251">ceptr_types.h:251</a></div></div>
<div class="ttc" id="mtree_8c_html_a0c5bd733621f48184a13a1202bd24fed"><div class="ttname"><a href="mtree_8c.html#a0c5bd733621f48184a13a1202bd24fed">_m_new_from_t</a></div><div class="ttdeci">H _m_new_from_t(T *t)</div><div class="ttdef"><b>Definition:</b> <a href="mtree_8c_source.html#l00206">mtree.c:206</a></div></div>
<div class="ttc" id="process_8c_html_a98556348d3f5fbc7334184249fbe9127"><div class="ttname"><a href="process_8c.html#a98556348d3f5fbc7334184249fbe9127">_p_interpolate_from_match</a></div><div class="ttdeci">void _p_interpolate_from_match(T *t, T *match_results, T *match_tree)</div><div class="ttdef"><b>Definition:</b> <a href="process_8c_source.html#l00065">process.c:65</a></div></div>
<div class="ttc" id="group__receptor_html_gad886d976f8621ebb22d02c61f454265c"><div class="ttname"><a href="group__receptor.html#gad886d976f8621ebb22d02c61f454265c">__r_get_symbol_size</a></div><div class="ttdeci">size_t __r_get_symbol_size(Receptor *r, Symbol s, void *surface)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00277">receptor.c:277</a></div></div>
<div class="ttc" id="group__receptor_html_gadc618904f81240b244e816234d1c906e"><div class="ttname"><a href="group__receptor.html#gadc618904f81240b244e816234d1c906e">_r_get_instance</a></div><div class="ttdeci">T * _r_get_instance(Receptor *r, Xaddr x)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00342">receptor.c:342</a></div></div>
<div class="ttc" id="process_8c_html_ab687631a788dd02e54df41041ed55f1c"><div class="ttname"><a href="process_8c.html#ab687631a788dd02e54df41041ed55f1c">_p_newq</a></div><div class="ttdeci">Q * _p_newq(Receptor *r)</div><div class="ttdef"><b>Definition:</b> <a href="process_8c_source.html#l01102">process.c:1102</a></div></div>
<div class="ttc" id="structReceptor_html"><div class="ttname"><a href="structReceptor.html">Receptor</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00246">ceptr_types.h:246</a></div></div>
<div class="ttc" id="structXaddr_html"><div class="ttname"><a href="structXaddr.html">Xaddr</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00274">ceptr_types.h:274</a></div></div>
<div class="ttc" id="structH_html"><div class="ttname"><a href="structH.html">H</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00083">ceptr_types.h:83</a></div></div>
<div class="ttc" id="structinstances__elem_html_aeeb84ef2b0bb4b596d161bc84f17937d"><div class="ttname"><a href="structinstances__elem.html#aeeb84ef2b0bb4b596d161bc84f17937d">instances_elem::s</a></div><div class="ttdeci">Symbol s</div><div class="ttdoc">key to store of this symbol type </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00169">ceptr_types.h:169</a></div></div>
<div class="ttc" id="group__receptor_html_ga4cb85b79ae4207e4595d003d11beb226"><div class="ttname"><a href="group__receptor.html#ga4cb85b79ae4207e4595d003d11beb226">___clock_thread</a></div><div class="ttdeci">void * ___clock_thread(void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00988">receptor.c:988</a></div></div>
<div class="ttc" id="group__receptor_html_ga893186e8d759e9aa1f14d932900e8046"><div class="ttname"><a href="group__receptor.html#ga893186e8d759e9aa1f14d932900e8046">__r_make_signal</a></div><div class="ttdeci">T * __r_make_signal(ReceptorAddress from, ReceptorAddress to, Aspect aspect, Symbol carrier, T *signal_contents, UUIDt *in_response_to, T *until)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00461">receptor.c:461</a></div></div>
<div class="ttc" id="group__semtrex_html_ga12e70dc3d5fde33655e8731ad3bdd935"><div class="ttname"><a href="group__semtrex.html#ga12e70dc3d5fde33655e8731ad3bdd935">_sl</a></div><div class="ttdeci">#define _sl(t, s)</div><div class="ttdoc">macro to add a single symbol literal to semtrex tree </div><div class="ttdef"><b>Definition:</b> <a href="semtrex_8h_source.html#l00116">semtrex.h:116</a></div></div>
<div class="ttc" id="mtree_8h_html"><div class="ttname"><a href="mtree_8h.html">mtree.h</a></div><div class="ttdoc">semantic tree matrix header file `` </div></div>
<div class="ttc" id="structinstances__elem_html"><div class="ttname"><a href="structinstances__elem.html">instances_elem</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00168">ceptr_types.h:168</a></div></div>
<div class="ttc" id="group__def_html_gad328204a09fa7f68a65080044a9b5109"><div class="ttname"><a href="group__def.html#gad328204a09fa7f68a65080044a9b5109">_d_define_protocol</a></div><div class="ttdeci">Protocol _d_define_protocol(SemTable *sem, T *def, Context c)</div><div class="ttdef"><b>Definition:</b> <a href="def_8c_source.html#l00329">def.c:329</a></div></div>
<div class="ttc" id="structR_html_aab5d23021e9afe31b32544e515f18c1f"><div class="ttname"><a href="structR.html#aab5d23021e9afe31b32544e515f18c1f">R::run_tree</a></div><div class="ttdeci">T * run_tree</div><div class="ttdoc">pointer to the root of the run_tree </div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00183">ceptr_types.h:183</a></div></div>
<div class="ttc" id="group__tree_html_ga3b7a6499fe49f8e6a54166d583b08d5c"><div class="ttname"><a href="group__tree.html#ga3b7a6499fe49f8e6a54166d583b08d5c">_t_add</a></div><div class="ttdeci">void _t_add(T *t, T *c)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00238">tree.c:238</a></div></div>
<div class="ttc" id="group__receptor_html_ga29fd5ebc5d1c142a7da96bd0dd36292c"><div class="ttname"><a href="group__receptor.html#ga29fd5ebc5d1c142a7da96bd0dd36292c">_r_define_symbol</a></div><div class="ttdeci">Symbol _r_define_symbol(Receptor *r, Structure s, char *label)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00184">receptor.c:184</a></div></div>
<div class="ttc" id="group__receptor_html_ga560777ec3ceabeb53f89e3da8612a634"><div class="ttname"><a href="group__receptor.html#ga560777ec3ceabeb53f89e3da8612a634">_r_request</a></div><div class="ttdeci">T * _r_request(Receptor *r, T *signal, Symbol response_carrier, T *code_point, int process_id)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00526">receptor.c:526</a></div></div>
<div class="ttc" id="group__receptor_html_ga7d40f33135ee51640d0d24b8c9e3e046"><div class="ttname"><a href="group__receptor.html#ga7d40f33135ee51640d0d24b8c9e3e046">_r_deliver</a></div><div class="ttdeci">Error _r_deliver(Receptor *r, T *signal)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00712">receptor.c:712</a></div></div>
<div class="ttc" id="group__tree_html_ga4b1df42f7a8edbe3a6192d64ab027ecc"><div class="ttname"><a href="group__tree.html#ga4b1df42f7a8edbe3a6192d64ab027ecc">_t_children</a></div><div class="ttdeci">int _t_children(T *t)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00724">tree.c:724</a></div></div>
<div class="ttc" id="accumulator_8h_html"><div class="ttname"><a href="accumulator_8h.html">accumulator.h</a></div><div class="ttdoc">header file for the accumulator </div></div>
<div class="ttc" id="group__tree_html_ga0dcacdfd022b2a04b8fb53eb25ee367e"><div class="ttname"><a href="group__tree.html#ga0dcacdfd022b2a04b8fb53eb25ee367e">_t_replace</a></div><div class="ttdeci">void _t_replace(T *t, int i, T *r)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00349">tree.c:349</a></div></div>
<div class="ttc" id="group__receptor_html_ga28899931aa49371ed6eb6c69b123b5f6"><div class="ttname"><a href="group__receptor.html#ga28899931aa49371ed6eb6c69b123b5f6">_r_set_instance</a></div><div class="ttdeci">T * _r_set_instance(Receptor *r, Xaddr x, T *t)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00357">receptor.c:357</a></div></div>
<div class="ttc" id="group__receptor_html_gac391ad8fbd0bb7ca9382e9ab0018edcf"><div class="ttname"><a href="group__receptor.html#gac391ad8fbd0bb7ca9382e9ab0018edcf">_r_add_expectation</a></div><div class="ttdeci">void _r_add_expectation(Receptor *r, Aspect aspect, Symbol carrier, T *pattern, T *action, T *with, T *until)</div><div class="ttdoc">Adds an expectation to a receptor&#39;s aspect. </div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00144">receptor.c:144</a></div></div>
<div class="ttc" id="group__tree_html_gad718449607421d4b572315be630cbf75"><div class="ttname"><a href="group__tree.html#gad718449607421d4b572315be630cbf75">_t_detach_by_ptr</a></div><div class="ttdeci">void _t_detach_by_ptr(T *t, T *c)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00268">tree.c:268</a></div></div>
<div class="ttc" id="process_8c_html_a3ea04d2b45efc2d35b350002d3073040"><div class="ttname"><a href="process_8c.html#a3ea04d2b45efc2d35b350002d3073040">_p_addrt2q</a></div><div class="ttdeci">Qe * _p_addrt2q(Q *q, T *run_tree)</div><div class="ttdef"><b>Definition:</b> <a href="process_8c_source.html#l01156">process.c:1156</a></div></div>
<div class="ttc" id="group__tree_html_ga31e55cdc031e5f12523b998e89080db6"><div class="ttname"><a href="group__tree.html#ga31e55cdc031e5f12523b998e89080db6">_t_free</a></div><div class="ttdeci">void _t_free(T *t)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00495">tree.c:495</a></div></div>
<div class="ttc" id="structSemanticID_html"><div class="ttname"><a href="structSemanticID.html">SemanticID</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00022">ceptr_types.h:22</a></div></div>
<div class="ttc" id="group__tree_html_gae87e70707c55cc361e7bbfa0939536f6"><div class="ttname"><a href="group__tree.html#gae87e70707c55cc361e7bbfa0939536f6">_t_getv</a></div><div class="ttdeci">T * _t_getv(T *t,...)</div><div class="ttdef"><b>Definition:</b> <a href="tree_8c_source.html#l00970">tree.c:970</a></div></div>
<div class="ttc" id="structQe_html"><div class="ttname"><a href="structQe.html">Qe</a></div><div class="ttdef"><b>Definition:</b> <a href="ceptr__types_8h_source.html#l00199">ceptr_types.h:199</a></div></div>
<div class="ttc" id="group__def_html_gaee8a21fdd29944bf44bb03457511515d"><div class="ttname"><a href="group__def.html#gaee8a21fdd29944bf44bb03457511515d">_d_define_process</a></div><div class="ttdeci">Process _d_define_process(SemTable *sem, T *code, char *name, char *intention, T *signature, Context c)</div><div class="ttdef"><b>Definition:</b> <a href="def_8c_source.html#l00315">def.c:315</a></div></div>
<div class="ttc" id="group__receptor_html_gaa8c97a2acf18af02e4e582d15932640c"><div class="ttname"><a href="group__receptor.html#gaa8c97a2acf18af02e4e582d15932640c">_r_def_match</a></div><div class="ttdeci">int _r_def_match(Receptor *r, Symbol s, T *t)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00306">receptor.c:306</a></div></div>
<div class="ttc" id="group__receptor_html_gadd08a3c284251a2ec7e03b8f91eddc5c"><div class="ttname"><a href="group__receptor.html#gadd08a3c284251a2ec7e03b8f91eddc5c">_r_new_instance</a></div><div class="ttdeci">Xaddr _r_new_instance(Receptor *r, T *t)</div><div class="ttdef"><b>Definition:</b> <a href="receptor_8c_source.html#l00328">receptor.c:328</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="receptor_8c.html">receptor.c</a></li>
    <li class="footer">Generated on Fri Dec 11 2015 21:36:29 for ceptr by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
